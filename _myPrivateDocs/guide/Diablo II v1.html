
<!-- saved from url=(0064)https://d2mods.info/resources/diablo_ii_code_editing%20v2.01.htm -->
<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:st1="urn:schemas-microsoft-com:office:smarttags" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">

<meta name="ProgId" content="Word.Document">
<meta name="Generator" content="Microsoft Word 11">
<meta name="Originator" content="Microsoft Word 11">
<link rel="File-List" href="https://d2mods.info/resources/diablo_ii_code_editing%20v2.01_files/filelist.xml">
<link rel="Edit-Time-Data" href="https://d2mods.info/resources/diablo_ii_code_editing%20v2.01_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Diablo II v1</title>
</head><body bgcolor="#000054" lang="EN-US" link="aqua" vlink="purple" style="tab-interval:
.5in"><o:smarttagtype namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="City">
<o:smarttagtype namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="country-region">
<o:smarttagtype namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="State">
<o:smarttagtype namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="place">
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Stacy Michael</o:Author>
  <o:LastAuthor>Al Woolf</o:LastAuthor>
  <o:Revision>6</o:Revision>
  <o:TotalTime>1983</o:TotalTime>
  <o:Created>2007-02-03T20:00:00Z</o:Created>
  <o:LastSaved>2007-02-03T20:49:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>15489</o:Words>
  <o:Characters>88292</o:Characters>
  <o:Company>N/A</o:Company>
  <o:Lines>735</o:Lines>
  <o:Paragraphs>207</o:Paragraphs>
  <o:CharactersWithSpaces>103574</o:CharactersWithSpaces>
  <o:Version>11.8107</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:DoNotRelyOnCSS/>
 </o:OfficeDocumentSettings>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:SelectEntireFieldWithStartOrEnd/>
   <w:UseWord2002TableStyleRules/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Exocet;
	panose-1:0 0 9 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:131 0 0 0 9 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:white;}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:white;
	mso-font-kerning:0pt;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:white;
	font-weight:normal;
	text-decoration:underline;
	text-underline:single;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:white;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:aqua;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
span.postbody1
	{mso-style-name:postbody1;
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	color:white;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:.9in .9in .9in .9in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:7409494;
	mso-list-type:hybrid;
	mso-list-template-ids:407427708 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:1552382284;
	mso-list-type:hybrid;
	mso-list-template-ids:848605380 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l1:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2
	{mso-list-id:1914847758;
	mso-list-type:hybrid;
	mso-list-template-ids:-1954386774 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l2:level1
	{mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
table.MsoTableGrid
	{mso-style-name:"Table Grid";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="6146">
  <o:colormru v:ext="edit" colors="#000054"/>
  <o:colormenu v:ext="edit" fillcolor="#000054"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->




<div class="Section1">

<p class="MsoTitle" style="margin-top:2.0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in"><b><font size="7" color="yellow" face="Exocet"><span style="font-size:36.0pt;font-family:Exocet;color:yellow">Diablo II <o:p></o:p></span></font></b></p>

<p class="MsoTitle" style="margin-top:12.0pt"><b><font size="6" color="white" face="Exocet"><span style="font-size:22.0pt;mso-bidi-font-size:12.0pt;font-family:
Exocet">Code Editing Tutorial<o:p></o:p></span></font></b></p>

<p class="MsoTitle" style="margin-top:12.0pt"><b><font size="6" color="white" face="Exocet"><span style="font-size:22.0pt;mso-bidi-font-size:12.0pt;font-family:
Exocet">For Windows<o:p></o:p></span></font></b></p>

<p class="MsoNormal" align="center" style="margin-top:30.0pt;text-align:center"><font size="3" color="white" face="Exocet"><span style="font-size:12.0pt;font-family:Exocet">v2.01<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-top:312.0pt"><font size="3" color="white" face="Arial"><span style="font-size:12.0pt;font-family:Arial">Original version by
Sir_General<o:p></o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Arial"><span style="font-size:
12.0pt;font-family:Arial">Updated for v1.10+ by Myhrginoc<o:p></o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Arial"><span style="font-size:
12.0pt;font-family:Arial"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Arial"><span style="font-size:
12.0pt;font-family:Arial"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><b><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-weight:bold"><o:p>&nbsp;</o:p></span></font></b></p>

<p class="MsoNormal"><b><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-weight:bold"><o:p>&nbsp;</o:p></span></font></b></p>

<h1><b><font size="5" color="yellow" face="Times New Roman"><span style="font-size:
16.0pt;color:yellow">Introduction<o:p></o:p></span></font></b></h1>

<p class="MsoNormal"><font size="3" color="black" face="Times New Roman"><span style="font-size:12.0pt;color:windowtext"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Welcome to the Diablo II code-editing tutorial.<span style="mso-spacerun:yes">&nbsp; </span>This tutorial will, hopefully, introduce you
to the basics of code-editing a DLL for any game, and specifically, for Diablo
II. The tutorial won’t go into the fine points about Diablo II function and
structure conventions, but there are many references at the <a href="http://phrozenkeep.it-point.com/forum/index.php?">Phrozen Keep</a> which
get into these topics. </span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">There are a number of different ways to modify a
program.<span style="mso-spacerun:yes">&nbsp; </span>This tutorial looks
specifically at hex editing and disassembling the DLLs of Diablo II.<span style="mso-spacerun:yes">&nbsp; </span>It starts with the assumption that you know
nothing about hex editing, hexadecimal, ASM, or the Diablo II DLLs.<span style="mso-spacerun:yes">&nbsp; </span>It will, therefore, cover all of those
topics, starting with hexadecimal.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We will use a few pieces of software to perform the
tasks but fear not because each item (except for Diablo II) is free of
charge.<span style="mso-spacerun:yes">&nbsp; </span>To complete everything in this
tutorial, obtain all of the following from the listed website:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<h2><u><font size="3" color="white" face="Times New Roman"><span style="font-size:
12.0pt">XVI32 Hex Editor</span></font></u></h2>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This is the freeware hex editor of choice.<span style="mso-spacerun:yes">&nbsp; </span>It has a fairly easy to use interface and the
price is right.<span style="mso-spacerun:yes">&nbsp; </span>You can get this at <a href="http://www.chmaas.handshake.de/delphi/freeware/xvi32/xvi32.htm">http://www.chmaas.handshake.de/delphi/freeware/xvi32/xvi32.htm</a>.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<h2><u><font size="3" color="white" face="Times New Roman"><span style="font-size:
12.0pt">OllyDbg</span></font></u></h2>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">OllyDbg is a freeware hex editor, dissassembler,
assembler, and debugging tool.<span style="mso-spacerun:yes">&nbsp; </span>It has a
number of very advanced features and a very user-friendly interface.<span style="mso-spacerun:yes">&nbsp; </span>All free of charge.<span style="mso-spacerun:yes">&nbsp; </span>This one can be obtained from <a href="http://www.ollydbg.de/">http://www.ollydbg.de/</a>.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<h2><u><font size="3" color="white" face="Times New Roman"><span style="font-size:
12.0pt">Windows Calculator</span></font></u></h2>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">While many programs have ways to convert between
decimal and hexadecimal, I haven’t found any that can do addition or
subtraction in hexadecimal except for the standard Windows Calculator.<span style="mso-spacerun:yes">&nbsp; </span>If you don’t have a shortcut for it, look in
your Windows directory or perhaps your Windows\System32 directory for CALC.EXE.</span></font></p>

<h1><b style="mso-bidi-font-weight:normal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;mso-bidi-font-weight:normal"><o:p>&nbsp;</o:p></span></font></b></h1>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<h1><b><font size="5" color="yellow" face="Times New Roman"><span style="font-size:
16.0pt;mso-bidi-font-size:12.0pt;color:yellow">Versions of Diablo II DLLs<o:p></o:p></span></font></b></h1>

<p class="MsoNormal"><font size="3" color="black" face="Times New Roman"><span style="font-size:12.0pt;color:windowtext"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The first thing you need to know is which version you
are working with.<span style="mso-spacerun:yes">&nbsp; </span>If you don’t already
know, the tables below will help you identify them.<span style="mso-spacerun:yes">&nbsp; </span>This information can be found by
right-clicking the DLL name in Windows Explorer and selecting Properties.<span style="mso-spacerun:yes">&nbsp; </span>For now, ignore the last column named Image
Base.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Each version is compiled anew (with the possible exception
of v1.09 to v1.09b).<span style="mso-spacerun:yes">&nbsp; </span>This means the code
will be different, in some cases radically different (as with v1.11 and
v1.11b), so what is shown here for a particular version may look different
and/or be in a different location in any other version.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" width="601" style="width:451.0pt;margin-left:30.6pt;border-collapse:collapse;mso-padding-alt:
 0in 5.4pt 0in 5.4pt">
 <tbody><tr height="17" style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><b style="mso-bidi-font-weight:normal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial;
  font-weight:bold;mso-bidi-font-weight:normal">D2Client.dll<o:p></o:p></span></font></b></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Size<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Modified Date<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Image Base<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:1;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.07<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,175,609 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Tuesday, June 19, 2001, 10:20:08
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FAD0000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:2;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.08<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,126,457 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Monday, June 18, 2001, 6:09:08 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FAD0000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:3;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.09<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,138,745 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, August 16, 2001, 3:00:18
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FAA0000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:4;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.09b<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,138,745 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, August 16, 2001, 3:00:18
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FAA0000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:5;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.09d<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,134,644 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, November 29, 2001,
  6:45:20 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FAA0000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:6;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.10 beta<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,073,204 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, July 03, 2003, 10:21:10
  AM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FAA0000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:7;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.10s beta<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,073,204 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Sunday, July 27, 2003, 9:29:34 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FAA0000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:8;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.10 final<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,085,505 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, October 02, 2003,
  2:46:22 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FAA0000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:9;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.11<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,093,632 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Tuesday, July 26, 2005, 3:16:18 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FAB0000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:10;mso-yfti-lastrow:yes;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.11b<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,093,632 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Tuesday, August 16, 2005, 5:02:32
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FAB0000<o:p></o:p></span></font></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" width="601" style="width:451.0pt;margin-left:30.6pt;border-collapse:collapse;mso-padding-alt:
 0in 5.4pt 0in 5.4pt">
 <tbody><tr height="17" style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><b style="mso-bidi-font-weight:normal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial;
  font-weight:bold;mso-bidi-font-weight:normal">D2Common.dll<o:p></o:p></span></font></b></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Size<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Modified Date<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Image Base<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:1;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.07<o:p></o:p></span></font></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">700,473 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Tuesday, June 19, 2001, 10:20:08
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FD60000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:2;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.08<o:p></o:p></span></font></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">688,185 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Monday, June 18, 2001, 6:03:14 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FD60000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:3;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.09<o:p></o:p></span></font></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">692,281 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, August 16, 2001, 2:52:30
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FD40000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:4;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.09b<o:p></o:p></span></font></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">692,281 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, August 16, 2001, 2:52:30
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FD40000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:5;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.09d<o:p></o:p></span></font></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">692,276 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, November 29, 2001,
  6:32:36 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FD40000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:6;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.10 beta<o:p></o:p></span></font></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">708,660 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, July 03, 2003, 10:16:48
  AM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FD40000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:7;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.10s beta<o:p></o:p></span></font></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">712,756 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Sunday, July 27, 2003, 9:25:14 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FD40000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:8;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.10 final<o:p></o:p></span></font></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">725,057 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, October 02, 2003,
  2:37:54 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FD40000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:9;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.11<o:p></o:p></span></font></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">679,936 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Tuesday, July 26, 2005, 3:10:32 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FD50000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:10;mso-yfti-lastrow:yes;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.11b<o:p></o:p></span></font></p>
  </td>
  <td width="119" nowrap="" height="17" valign="bottom" style="width:88.95pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">679,936 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="277" nowrap="" height="17" valign="bottom" style="width:208.05pt;
  padding:0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Tuesday, August 16, 2005, 4:58:16
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FD50000<o:p></o:p></span></font></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" width="601" style="width:451.0pt;margin-left:30.6pt;border-collapse:collapse;mso-padding-alt:
 0in 5.4pt 0in 5.4pt">
 <tbody><tr height="17" style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><b style="mso-bidi-font-weight:normal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial;
  font-weight:bold;mso-bidi-font-weight:normal">D2Game.dll<o:p></o:p></span></font></b></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Size<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Modified Date<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Image Base<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:1;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.07<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">999,479 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Tuesday, June 19, 2001, 10:20:08
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FC60000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:2;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.08<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,003,575 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Monday, June 18, 2001, 6:05:12 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FC60000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:3;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.09<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,028,151 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, August 16, 2001, 2:55:36
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FC30000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:4;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.09b<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,028,151 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, August 16, 2001, 2:55:36
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FC30000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:5;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.09d<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,028,146 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, November 29, 2001,
  6:37:06 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FC30000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:6;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.10 beta<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,159,218 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, July 03, 2003, 10:18:24
  AM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FC30000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:7;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.10s beta<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,163,314 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Sunday, July 27, 2003, 9:26:48 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FC30000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:8;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.10 final<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,159,231 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Thursday, October 02, 2003,
  2:41:10 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FC30000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:9;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.11<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,138,688 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Tuesday, July 26, 2005, 3:12:56 PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FC20000<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr height="17" style="mso-yfti-irow:10;mso-yfti-lastrow:yes;height:12.75pt">
  <td width="109" nowrap="" height="17" valign="bottom" style="width:82.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1.11b<o:p></o:p></span></font></p>
  </td>
  <td width="120" nowrap="" height="17" valign="bottom" style="width:1.25in;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">1,138,688 bytes<o:p></o:p></span></font></p>
  </td>
  <td width="276" nowrap="" height="17" valign="bottom" style="width:207.0pt;padding:
  0in 5.4pt 0in 5.4pt;height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">Tuesday, August 16, 2005, 5:00:00
  PM<o:p></o:p></span></font></p>
  </td>
  <td width="96" nowrap="" height="17" valign="bottom" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt;
  height:12.75pt">
  <p class="MsoNormal"><font size="2" color="white" face="Arial"><span style="font-size:10.0pt;font-family:Arial">6FC20000<o:p></o:p></span></font></p>
  </td>
 </tr>
</tbody></table>

<h1><b style="mso-bidi-font-weight:normal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;mso-bidi-font-weight:normal"><o:p>&nbsp;</o:p></span></font></b></h1>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<h1><b><font size="5" color="yellow" face="Times New Roman"><span style="font-size:
16.0pt;mso-bidi-font-size:12.0pt;color:yellow">Binary/Decimal/Hexadecimal<o:p></o:p></span></font></b></h1>

<p class="MsoNormal"><font size="3" color="black" face="Times New Roman"><span style="font-size:12.0pt;color:windowtext"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">In computers, everything is in binary.<span style="mso-spacerun:yes">&nbsp; </span>Even the words you are reading are a series
of 0s and 1s.<span style="mso-spacerun:yes">&nbsp; </span>However, this would be
very inconvenient for editing purposes because it takes a lot of space to
display all those 0s and 1s.<span style="mso-spacerun:yes">&nbsp; </span>This is why
the 0s and 1s are commonly grouped into sets of eight.<span style="mso-spacerun:yes">&nbsp; </span>You’ll never find anything that deals with a
single 0 or 1 (which is called a bit).<span style="mso-spacerun:yes">&nbsp;
</span>It will always been a group of 8 (a BYTE), a group of 16 (a WORD), a
group of 32 (a DWORD) or a group of 64 (a QWORD).<span style="mso-spacerun:yes">&nbsp; </span>We don’t use qwords directly in Diablo II so
we’ll ignore this last data size, although there is an important exception we
will visit later.<span style="mso-spacerun:yes">&nbsp; </span>We’ll look at the
differences between the others later.<span style="mso-spacerun:yes">&nbsp;
</span>For now, it’s important to learn how to read a byte.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Numbers are represented using the groups of bits we
mentioned about.<span style="mso-spacerun:yes">&nbsp; </span>They are represented in
this fashion:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 0000 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>000 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>00 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 0001 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>001 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>01 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 0010 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>002 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>02 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 0011 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>003 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>03 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 0100 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>004 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>04 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 0101 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>005 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>05 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 0110 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>006 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>06 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 0111 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>007 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>07 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 1000 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>008 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>08 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 1001 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>009 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>09 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 1010 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>010 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0A Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 1011 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>011 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0B Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 1100 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>012 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0C Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 1101 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>013 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0D Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 1110 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>014 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0E Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 1111 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>015 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0F Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0001 0000 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>016 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>10 Hexadecimal</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">And this continues until you reach:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">1111 1111 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>255 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>FF Hexadecimal</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Notice the following in each.<span style="mso-spacerun:yes">&nbsp; </span>Binary only uses 0s and 1s, like I said
before.<span style="mso-spacerun:yes">&nbsp; </span>Decimal is what you are familiar
with and know how to read.<span style="mso-spacerun:yes">&nbsp; </span>Hexadecimal
is like decimal until you reach 10, and then it starts using the letters A
through F.<span style="mso-spacerun:yes">&nbsp; </span>You won’t usually have to
convert between binary and decimal when you are code editing, but I’ll cover it
anyway because you never know.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">To convert from binary to decimal, you need to follow the
following series of steps (also known as an algorithm, if you haven’t
encountered that term before).<span style="mso-spacerun:yes">&nbsp; </span>You need
to write a total somewhere.<span style="mso-spacerun:yes">&nbsp; </span>The total
starts at 0.<span style="mso-spacerun:yes">&nbsp; </span>Look at the right most
number.<span style="mso-spacerun:yes">&nbsp; </span>If it is 0, go to the next
number.<span style="mso-spacerun:yes">&nbsp; </span>If it is 1, then you need to add
2<sup>N</sup> to the total.<span style="mso-spacerun:yes">&nbsp; </span>N will
depend on what part of the binary number you are on.<span style="mso-spacerun:yes">&nbsp; </span>For the right most number, N is 0.<span style="mso-spacerun:yes">&nbsp; </span>For the one next to it, N is 1.<span style="mso-spacerun:yes">&nbsp; </span>For the one next to that one, N is 2.<span style="mso-spacerun:yes">&nbsp; </span>After that, N becomes 3.<span style="mso-spacerun:yes">&nbsp; </span>Then N becomes 4.<span style="mso-spacerun:yes">&nbsp; </span>And so on until you’ve gone through all of
the numbers in the binary number.<span style="mso-spacerun:yes">&nbsp; </span>For
reference, here <span class="GramE">is</span> 2 raised to the most common powers.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">2<sup>0</sup> = 1</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">2<sup>1</sup> = 2</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">2<sup>2</sup> = 4</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">2<sup>3</sup> = 8</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">2<sup>4</sup> = 16</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">2<sup>5</sup> = 32</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">2<sup>6</sup> = 64</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">2<sup>7</sup> = 128</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now <span class="GramE">lets</span> do an example.<span style="mso-spacerun:yes">&nbsp; </span>Convert 0010 1001 to decimal.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We start by writing down our total.<span style="mso-spacerun:yes">&nbsp; </span>TOTAL = 0.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">And write down what N is.<span style="mso-spacerun:yes">&nbsp; </span>N = 0.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0010 100<b><u><span style="font-weight:bold">1<o:p></o:p></span></u></b></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Look at the right most number of the binary
number.<span style="mso-spacerun:yes">&nbsp; </span>It’s a 1, so we add 2<sup>N</sup>
to our total.<span style="mso-spacerun:yes">&nbsp; </span>Right now, N is 0, so we
add 2<sup>0</sup>, which is 1.<span style="mso-spacerun:yes">&nbsp; </span>So now
TOTAL = 1.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Move to the next number, and don’t forget that N
increases.<span style="mso-spacerun:yes">&nbsp; </span>N = 1.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0010 10<b><u><span style="font-weight:bold">0</span></u></b>1</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This is a 0, so we skip it.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Move to the next number and increase N.<span style="mso-spacerun:yes">&nbsp; </span>N = 2.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0010 1<b><u><span style="font-weight:bold">0</span></u></b>01</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This is another 0, so we skip it.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now N = 3.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0010 <b><u><span style="font-weight:bold">1</span></u></b>001</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now we have another 1, so we add 2<sup>3</sup> to the
total.<span style="mso-spacerun:yes">&nbsp; </span>2<sup>3</sup> = 8, so now the
TOTAL = 9.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">After this, N = 4.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">001<b><u><span style="font-weight:bold">0</span></u></b> 1001</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We have a 0, so we skip it.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now N = 5.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">00<b><u><span style="font-weight:bold">1</span></u></b>0 1001</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This is a 1, so we add 2<sup>5</sup> to the
total.<span style="mso-spacerun:yes">&nbsp; </span>2<sup>5</sup> = 32, so now the
TOTAL = 41.<span style="mso-spacerun:yes">&nbsp; </span>As you can see, the other
two numbers after this are 0, so we can stop here.<span style="mso-spacerun:yes">&nbsp; </span>The result:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0010 1001 Binary<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>41 Decimal</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">If you didn’t catch any of that, there’s an easier
method to converting.<span style="mso-spacerun:yes">&nbsp; </span>It’s called the
Windows Calculator.<span style="mso-spacerun:yes">&nbsp; </span>If you aren’t a
regular user, the first time you open it you will probably see the smaller
format shown on the left below.<span style="mso-spacerun:yes">&nbsp; </span>We will
change it to the more useful Scientific Calculator as shown at right.<span style="mso-spacerun:yes">&nbsp; </span>Turn on Digit Grouping as well, it makes
identifying number parts easier.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style='width:195pt;
 height:195pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image001.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="260" height="260" src="./Diablo II v1_files/image002.jpg" v:shapes="_x0000_i1025"><!--[endif]--><span style="mso-spacerun:yes">&nbsp;&nbsp; </span><!--[if gte vml 1]><v:shape id="_x0000_i1026"
 type="#_x0000_t75" style='width:195.75pt;height:195pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image003.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="261" height="260" src="./Diablo II v1_files/image004.jpg" v:shapes="_x0000_i1026"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1027" type="#_x0000_t75"
 style='width:5in;height:237.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image005.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="480" height="317" src="./Diablo II v1_files/image006.jpg" v:shapes="_x0000_i1027"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now choose the <span class="GramE">Bin(</span>ary)
option and enter your binary value.<span style="mso-spacerun:yes">&nbsp; </span>Also
note, in later versions of Windows Calculator, you can display values in qword,
dword, word and byte sizes.<span style="mso-spacerun:yes">&nbsp; </span><span class="GramE">Because we are using 32-bit processing in a Pentium-series
processor, select dword as your data size.</span><span style="mso-spacerun:yes">&nbsp; </span>The next screen shows the controls to use.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1028" type="#_x0000_t75"
 style='width:5in;height:237.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image007.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="480" height="317" src="./Diablo II v1_files/image008.jpg" v:shapes="_x0000_i1028"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now switch back to <span class="GramE">Dec(</span>imal)
and the binary value will change as well:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1029" type="#_x0000_t75"
 style='width:5in;height:237.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image009.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="480" height="317" src="./Diablo II v1_files/image010.jpg" v:shapes="_x0000_i1029"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">In the event that you need to convert from binary to
hexadecimal, you can just choose the <span class="GramE">Hex(</span>adecimal)
option instead of the Dec(imal) option.<span style="mso-spacerun:yes">&nbsp;
</span>We will see how you have to do it by hand, converting from decimal to
hexadecimal and vice versa.<span style="mso-spacerun:yes">&nbsp; </span>Before you
can convert from decimal to hexadecimal, you need to know what all those
letters in hexadecimal mean.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Here’s the conversion:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in;page-break-after:avoid"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">00
Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">01 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>1 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">02 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>2 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">03 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>3 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">04 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>4 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">05 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>5 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">06 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>6 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">07 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>7 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">08 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>8 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">09 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>9 Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">10 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">11 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>B Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">12 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>C Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">13 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>D Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">14 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>E Hexadecimal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">15 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>F Hexadecimal</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now that you know what the letters mean, let’s look at
the general idea behind a conversion.<span style="mso-spacerun:yes">&nbsp;
</span>You take your decimal number and divide it by 16.<span style="mso-spacerun:yes">&nbsp; </span>Make sure you know what the remainder
is.<span style="mso-spacerun:yes">&nbsp; </span>Once you do this, you take the remainder
and write that down.<span style="mso-spacerun:yes">&nbsp; </span>Remember that if
the remember is between 10 and 15 that you use the letters A through F.<span style="mso-spacerun:yes">&nbsp; </span>Now you take what is left and divide that by
16.<span style="mso-spacerun:yes">&nbsp; </span>Get the remainder for that and write
that down.<span style="mso-spacerun:yes">&nbsp; </span>Continue to do this until you
have nothing left to divide.<span style="mso-spacerun:yes">&nbsp; </span>Let’s look
at an example.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Convert 217 to hexadecimal.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We start by dividing 217 by 16.<span style="mso-spacerun:yes">&nbsp; </span>This gives us 13 <span class="GramE">R(</span>emainder)
9.<span style="mso-spacerun:yes">&nbsp; </span>So we write the 9 down.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now divide 13 by 16.<span style="mso-spacerun:yes">&nbsp;
</span>This gives us 0 R 13.<span style="mso-spacerun:yes">&nbsp; </span>Now we
write down D.<span style="mso-spacerun:yes">&nbsp; </span>This gives us D9.<span style="mso-spacerun:yes">&nbsp; </span>Remember to use the letters from above.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Since we have 0 left, we’re finished.<span style="mso-spacerun:yes">&nbsp; </span>The result:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">217 Decimal<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>D9 Hexadecimal</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">If you didn’t catch that, you can use the
calculator.<span style="mso-spacerun:yes">&nbsp; </span>I won’t go through it
again.<span style="mso-spacerun:yes">&nbsp; </span>The only difference is that
instead of switching between <span class="GramE">Bin(</span>ary) and Dec(imal)
you switch between Hex(adecimal) and Dec(imal).</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">It’s also important to learn how to convert from
hexadecimal to decimal because you’ll be doing it a lot.<span style="mso-spacerun:yes">&nbsp; </span>This is a lot like converting from binary to
decimal.<span style="mso-spacerun:yes">&nbsp; </span>You start with the right most
number and multiply it by 16<sup>N</sup>.<span style="mso-spacerun:yes">&nbsp;
</span>You add this to your total.<span style="mso-spacerun:yes">&nbsp; </span>Then
you move on to the next number and multiply it.<span style="mso-spacerun:yes">&nbsp;
</span>Just like in binary, N starts at 0 and increase every number.<span style="mso-spacerun:yes">&nbsp; </span>So the first number is 0, the second is 1,
the third is 2, the fourth is 3, and so on.<span style="mso-spacerun:yes">&nbsp;
</span>Also, if you have one of the letters instead of a number, just use its
decimal equivalent.<span style="mso-spacerun:yes">&nbsp; </span>So if you come
across an A, you multiply 16<sup>N</sup> by 10.<span style="mso-spacerun:yes">&nbsp;
</span>Let’s look at an example.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Convert 3F to decimal.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We start with TOTAL = 0 and N = 0. </span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Our first number is F, or 15.<span style="mso-spacerun:yes">&nbsp; </span>Multiply this by 16<sup>0</sup>, which is
1.<span style="mso-spacerun:yes">&nbsp; </span>So now TOTAL = 15.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Increase N, so N = 1.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Our next number is 3, so we multiply 16<sup>1</sup>,
which <span class="GramE">is</span> 16, times 3.<span style="mso-spacerun:yes">&nbsp;
</span>That’s 48, so we add 48 to the TOTAL.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now TOTAL = 63.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">That’s the last number, so the result is:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">3F Hexadecimal<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>63 Decimal</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Once again, the calculator can be used instead of
doing it yourself.<span style="mso-spacerun:yes">&nbsp; </span>The upper six hex
numerals (red box) are enabled in hex mode.<span style="mso-spacerun:yes">&nbsp;
</span>Compare this screen with the binary screen above, where only the 0 and 1
number keys are enabled.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1030" type="#_x0000_t75"
 style='width:5in;height:237.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image011.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="480" height="317" src="./Diablo II v1_files/image012.jpg" v:shapes="_x0000_i1030"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<h1><b><font size="5" color="yellow" face="Times New Roman"><span style="font-size:
16.0pt;mso-bidi-font-size:12.0pt;color:yellow">Hex Editing with XVI32<o:p></o:p></span></font></b></h1>

<p class="MsoNormal"><font size="3" color="black" face="Times New Roman"><span style="font-size:12.0pt;color:windowtext"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Run XVI32 and look at the XVI32 interface.<span style="mso-spacerun:yes">&nbsp; </span></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1031" type="#_x0000_t75"
 style='width:450.75pt;height:306pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image013.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="601" height="408" src="./Diablo II v1_files/image014.jpg" v:shapes="_x0000_i1031"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">There are three main sections to the application
screen.<span style="mso-spacerun:yes">&nbsp; </span>The left section is the file
offset, the center section is the raw hexadecimal file content, and the right
section is an ASCII version of the file content.<span style="mso-spacerun:yes">&nbsp; </span>While these can be arranged in many ways, the
best arrangement (following compiler alignment convention) is 17 rows and 16
columns, so Page Up and Page Down move you 0x100 (256 bytes) at a time.<span style="mso-spacerun:yes">&nbsp; </span>So we will start with the options found in
the Tools menu as shown above.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1032" type="#_x0000_t75"
 style='width:289.5pt;height:196.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image015.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="386" height="262" src="./Diablo II v1_files/image016.jpg" v:shapes="_x0000_i1032"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We will begin by opening a copy of the file D2Game.dll
from your Diablo II directory.<span style="mso-spacerun:yes">&nbsp; </span>(It is a
bad idea to work on original files.)<span style="mso-spacerun:yes">&nbsp;
</span>This discussion assumes you have patched the game to the latest version,
v1.11b.<span style="mso-spacerun:yes">&nbsp; </span>The ASCII display of the file is
used to help identify strings within the file.<span style="mso-spacerun:yes">&nbsp;
</span>A string is basically just a word or a sentence or some other readable
thing.<span style="mso-spacerun:yes">&nbsp; </span>You’ll notice that the
highlighted section reads “This program cannot be run in DOS mode.”<span style="mso-spacerun:yes">&nbsp; </span>This is a string, which includes the trailing
00 byte, also known as a null terminator.<span style="mso-spacerun:yes">&nbsp;
</span>We never would’ve noticed it without the ASCII display, either.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1033" type="#_x0000_t75"
 style='width:450pt;height:320.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image017.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="600" height="427" src="./Diablo II v1_files/image018.jpg" v:shapes="_x0000_i1033"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">At the bottom of the screen is the status bar.<span style="mso-spacerun:yes">&nbsp; </span>The leftmost box shows the current address
(or more correctly, the current offset); it tells you where you are in the file.<span style="mso-spacerun:yes">&nbsp; </span>Depending on whether you have the center pane
active (as above) or the right panel active (see previous page), the offset
will be displayed as a hexadecimal or a decimal number.<span style="mso-spacerun:yes">&nbsp; </span>Almost every offset/address you see will be
in hexadecimal, so you may want to work primarily in the center pane.<span style="mso-spacerun:yes">&nbsp; </span>Beside that is the decimal value of the
current byte you have selected.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Next to the offset is the decimal version of the byte
selected.<span style="mso-spacerun:yes">&nbsp; </span>We have 54 selected, and its
decimal value is 84.<span style="mso-spacerun:yes">&nbsp; </span><span class="GramE">Pretty
handy, no?</span></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Finally, you have insert/overwrite mode.<span style="mso-spacerun:yes">&nbsp; </span>In insert mode, the data you put in is added
and all the rest of the data comes after it.<span style="mso-spacerun:yes">&nbsp;
</span>This increases the location of every byte after it by 1.<span style="mso-spacerun:yes">&nbsp; </span>You should <u>never</u> use insert mode.<span style="mso-spacerun:yes">&nbsp; </span>Make sure it says overwrite.<span style="mso-spacerun:yes">&nbsp; </span>In overwrite mode, the data is replaced, not
inserted.<span style="mso-spacerun:yes">&nbsp; </span>You can change modes by
pressing the “Insert” button on your keyboard or in the “Tools” menu.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now let’s navigate in the file.<span style="mso-spacerun:yes">&nbsp; </span>We will start with going to specific
locations.<span style="mso-spacerun:yes">&nbsp; </span>Begin with the Address menu
and select Goto:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1034" type="#_x0000_t75"
 style='width:225pt;height:158.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image019.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="300" height="211" src="./Diablo II v1_files/image020.jpg" v:shapes="_x0000_i1034"><!--[endif]--><span style="mso-spacerun:yes">&nbsp;&nbsp; </span><!--[if gte vml 1]><v:shape id="_x0000_i1035"
 type="#_x0000_t75" style='width:246.75pt;height:151.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image021.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="329" height="202" src="./Diablo II v1_files/image022.jpg" v:shapes="_x0000_i1035"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">In this dialog, you insert the address/offset you want
to goto and push OK.<span style="mso-spacerun:yes">&nbsp; </span>The editor will
automatically go there so you don’t have to search for it.<span style="mso-spacerun:yes">&nbsp; </span>On the other hand, you may know what you want
to change, but not know where it is.<span style="mso-spacerun:yes">&nbsp; </span>For
that we use the Search sequence below:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1036" type="#_x0000_t75"
 style='width:180.75pt;height:204pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image023.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="241" height="272" src="./Diablo II v1_files/image024.jpg" v:shapes="_x0000_i1036"><!--[endif]--><span style="mso-spacerun:yes">&nbsp; </span><!--[if gte vml 1]><v:shape id="_x0000_i1037"
 type="#_x0000_t75" style='width:285pt;height:198pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image025.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="380" height="264" src="./Diablo II v1_files/image026.jpg" v:shapes="_x0000_i1037"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now that we’ve seen the basics of the XVI32 Hex
Editor, let’s look at an example.<span style="mso-spacerun:yes">&nbsp; </span>We’re
going to change the experience awards given by the Ancients quest in Act
5.<span style="mso-spacerun:yes">&nbsp; </span>We know the award values are as shown
in the first two columns:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<table class="MsoTableGrid" border="0" cellspacing="0" cellpadding="0" style="margin-left:30.6pt;border-collapse:collapse;mso-yfti-tbllook:480;
 mso-padding-alt:0in 5.4pt 0in 5.4pt">
 <tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes">
  <td width="192" valign="top" style="width:2.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">Normal difficulty<o:p></o:p></span></font></p>
  </td>
  <td width="96" valign="top" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" align="right" style="text-align:right"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">1,400,000<o:p></o:p></span></font></p>
  </td>
  <td width="96" valign="top" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" align="right" style="text-align:right"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">0x00155CC0<o:p></o:p></span></font></p>
  </td>
  <td width="96" valign="top" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" align="right" style="text-align:right"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">0xC05C1500<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr style="mso-yfti-irow:1">
  <td width="192" valign="top" style="width:2.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">Nightmare difficulty<o:p></o:p></span></font></p>
  </td>
  <td width="96" valign="top" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" align="right" style="text-align:right"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">20,000,000<o:p></o:p></span></font></p>
  </td>
  <td width="96" valign="top" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" align="right" style="text-align:right"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">0x01312D00<o:p></o:p></span></font></p>
  </td>
  <td width="96" valign="top" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" align="right" style="text-align:right"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">0x002D3101<o:p></o:p></span></font></p>
  </td>
 </tr>
 <tr style="mso-yfti-irow:2;mso-yfti-lastrow:yes">
  <td width="192" valign="top" style="width:2.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">Hell difficulty<o:p></o:p></span></font></p>
  </td>
  <td width="96" valign="top" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" align="right" style="text-align:right"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">50,000,000<o:p></o:p></span></font></p>
  </td>
  <td width="96" valign="top" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" align="right" style="text-align:right"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">0x02625A00<o:p></o:p></span></font></p>
  </td>
  <td width="96" valign="top" style="width:1.0in;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" align="right" style="text-align:right"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">0x005A6202<o:p></o:p></span></font></p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">One peculiarity of Intel machines is, when constants
are included as part of code, the byte order is reversed.<span style="mso-spacerun:yes">&nbsp; </span>So even though a straightforward hex
conversion gets us the numbers in the third column, we need to reorder the
bytes and search on the numbers in the last column.<span style="mso-spacerun:yes">&nbsp; </span>The first value is shown in the sample Search
dialog above.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We find one occurrence of the first value at offset
0x52FC9.<span style="mso-spacerun:yes">&nbsp; </span>The full value is shown in red
here.<span style="mso-spacerun:yes">&nbsp; </span>Two lines are included, in which
you will find the Nightmare value at 0x52FDA and the Hell value at 52FD3.<span style="mso-spacerun:yes">&nbsp; </span>But for now we will just focus on the <st1:place w:st="on">Normal</st1:place> value.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1038" type="#_x0000_t75"
 style='width:284.25pt;height:87pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image027.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="379" height="116" src="./Diablo II v1_files/image028.jpg" v:shapes="_x0000_i1038"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s change the <st1:place w:st="on">Normal</st1:place>
award to 2,000,000.<span style="mso-spacerun:yes">&nbsp; </span>Converting the new
value to hex we get 0x001E8480, and reversing bytes we end up with
0x80841E00.<span style="mso-spacerun:yes">&nbsp; </span>Make sure you’re in overwrite
mode, this is very important.<span style="mso-spacerun:yes">&nbsp; </span>Now click
on the leftmost byte and type 80 84 1E 00.<span style="mso-spacerun:yes">&nbsp;
</span>You should see:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1039" type="#_x0000_t75"
 style='width:282.75pt;height:86.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image029.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="377" height="115" src="./Diablo II v1_files/image030.jpg" v:shapes="_x0000_i1039"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You have just edited the Diablo II code to make it so
the Ancients give you 2,000,000 experience when you kill them all in <st1:place w:st="on">Normal</st1:place> difficulty.<span style="mso-spacerun:yes">&nbsp;
</span>It is as simple as that.<span style="mso-spacerun:yes">&nbsp; </span>To keep
this change, save the file before leaving it.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Here is another example, in d2common.dll v1.11b.<span style="mso-spacerun:yes">&nbsp; </span>This time we will change the gamble cost
function so all items use the Gamble Cost field in weapons.txt, armor.txt or
misc.txt.<span style="mso-spacerun:yes">&nbsp; </span>Currently only rings and
amulets do this, but it is simple to change the conditional check into a forced
behavior.<span style="mso-spacerun:yes">&nbsp; </span>Load the dll and go to offset
0x72E74 (as shown in the Goto command example above); you should find the
sequence:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1040" type="#_x0000_t75"
 style='width:283.5pt;height:74.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image031.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="378" height="99" src="./Diablo II v1_files/image032.jpg" v:shapes="_x0000_i1040"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Make sure you are in overwrite mode and replace these
bytes with</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1041" type="#_x0000_t75"
 style='width:284.25pt;height:75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image033.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="379" height="100" src="./Diablo II v1_files/image034.jpg" v:shapes="_x0000_i1041"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now every item will use the Gamble Cost field instead
of calculating a gamble fee based on character level.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Supposing you are following a discussion, and somebody
says a value might be at a particular offset but the value itself is not
given?<span style="mso-spacerun:yes">&nbsp; </span>You can find out what the number
is by using one of the tools in XVI32, Decode Number.<span style="mso-spacerun:yes">&nbsp; </span>This is located as shown:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1042" type="#_x0000_t75"
 style='width:285pt;height:174pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image035.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="380" height="232" src="./Diablo II v1_files/image036.jpg" v:shapes="_x0000_i1042"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Select the first byte of a number, which is always the
offset of the value, and decode it.<span style="mso-spacerun:yes">&nbsp; </span>You
will see several values, the correct one being determined by context but
usually it is the longint value.<span style="mso-spacerun:yes">&nbsp; </span>You
will see both hex and decimal forms of the decoded value.<span style="mso-spacerun:yes">&nbsp; </span>The sample below confirms what we discussed
when we changed the Ancients award.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1043" type="#_x0000_t75"
 style='width:345pt;height:209.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image037.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="460" height="279" src="./Diablo II v1_files/image038.jpg" v:shapes="_x0000_i1043"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Right now you are probably wondering, “how the heck do
I know what should be changed?”<span style="mso-spacerun:yes">&nbsp; </span>Hex
editing is suitable for following canned recipes for small code edits, or
changing the data sections of a dll.<span style="mso-spacerun:yes">&nbsp; </span>You
will see that in many cases people will post both hex and assembly changes
together, so you can find quite a few changes to try without learning assembly
language.<span style="mso-spacerun:yes">&nbsp; </span>But for more extensive code
edits and research, you need to bite the bullet and learn assembly language,
which we will tackle in the next section.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<h1><b><font size="5" color="yellow" face="Times New Roman"><span style="font-size:
16.0pt;mso-bidi-font-size:12.0pt;color:yellow">Basic Assembly, Intel Style<o:p></o:p></span></font></b></h1>

<p class="MsoNormal"><b><font size="3" color="black" face="Times New Roman"><span style="font-size:12.0pt;color:windowtext;font-weight:bold"><o:p>&nbsp;</o:p></span></font></b></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Assembly language (sometimes called ASM for short) is
a very complicated thing, and there is no way this tutorial can cover it
all.<span style="mso-spacerun:yes">&nbsp; </span>I will, however, go into some of
the basic, but important, concepts you’ll need to know to get started.<span style="mso-spacerun:yes">&nbsp; </span>This includes registers, the stack, important
commands, and a few other things.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let me start by making a quick note that ALL ASSEMBLY
VALUES ARE IN HEXADECIMAL.<span style="mso-spacerun:yes">&nbsp; </span>So I hope you
were paying attention when you went through the hex sections above.<span style="mso-spacerun:yes">&nbsp; </span>That said, it’s on to registers.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">While there are a number of registers in assembly,
we’re just going to concentrate on the 32-bit registers for now.<span style="mso-spacerun:yes">&nbsp; </span>First, let’s look at what a register is: a
location within the processor itself that can hold a 32-bit number (including
leading 0’s as needed).<span style="mso-spacerun:yes">&nbsp; </span>That’s all it
does, but it works faster than anything else involving data storage.<span style="mso-spacerun:yes">&nbsp; </span>We use registers because a processor can only
deal with so many numbers at a time.<span style="mso-spacerun:yes">&nbsp; </span>You
can imagine how many numbers Diablo II has in memory.<span style="mso-spacerun:yes">&nbsp; </span>Well, registers are basically the numbers
that we are using at the moment.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Each register has a purpose, supposedly, but you’ll
find that some can be used for mostly anything while others should never be
touched by you unless you know exactly what you’re doing.<span style="mso-spacerun:yes">&nbsp; </span>Here are the registers you should know:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EAX – Accumulator – The register is useful for just
about anything you want.<span style="mso-spacerun:yes">&nbsp; </span>EAX is
sometimes used as the return value of functions.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EBX – Base – This is another register that can be used
for just about anything.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">ECX – Counter – You can use the counter register for
anything.<span style="mso-spacerun:yes">&nbsp; </span>Just know that it is
automatically used by the REP and LOOP instructions.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EDX – Data – Another all-purpose register.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">ESI – Source Index – This register can be used for
plenty of things, but it is commonly used with data structures and string
manipulation.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EDI – Destination Index – This is like ESI.<span style="mso-spacerun:yes">&nbsp; </span>It can be used for most anything, but is
usually used with data structures and string manipulation.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EBP – Base Pointer – This register has lots of
purposes, as well.<span style="mso-spacerun:yes">&nbsp; </span>It’s commonly used as
a pointer to the stack.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">ESP – Stack Pointer – This register is almost
explicitly used as the stack pointer.<span style="mso-spacerun:yes">&nbsp;
</span>Unless you know exactly what you’re doing, don’t touch this or you run
the risk of corrupting the stack.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EIP – Instruction Pointer – This register points to
the current instruction to execute.<span style="mso-spacerun:yes">&nbsp; </span>You
can’t mess with it directly, and you never should.<span style="mso-spacerun:yes">&nbsp; </span>This will be properly changed by the
processor with CALL, JMP, and RETN statements.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The registers you’ll be using most are the EAX, EBX,
ECX, and EDX registers.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now let’s take a look at the stack.<span style="mso-spacerun:yes">&nbsp; </span>Each program has a stack, and this is one of
the most important parts to the program.<span style="mso-spacerun:yes">&nbsp;
</span>Few things can come as close.<span style="mso-spacerun:yes">&nbsp; </span>A
stack is often referred to as a “last in, first out” system.<span style="mso-spacerun:yes">&nbsp; </span>What this means is that the last item put on
the stack is the first item to come off the stack.<span style="mso-spacerun:yes">&nbsp; </span>To prove this, look at the below example of
books:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1044" type="#_x0000_t75"
 style='width:375pt;height:375pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image039.gif" o:title="Image009"/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="500" height="500" src="./Diablo II v1_files/image039.gif" v:shapes="_x0000_i1044"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The important thing to learn here is that in a stack,
the first item on is the last item off.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Before we continue on, it’s a good idea to understand
just how important the stack is.<span style="mso-spacerun:yes">&nbsp; </span>Let’s
say that you were performing a task with the books above and you expected
everything to go just in the order that it does above.<span style="mso-spacerun:yes">&nbsp; </span>What would happen, however, if the red book
weren’t put on?<span style="mso-spacerun:yes">&nbsp; </span>When you went to pick up
the red book, you’d get the yellow.<span style="mso-spacerun:yes">&nbsp; </span>When
you went to pick up the yellow, you’d get the green.<span style="mso-spacerun:yes">&nbsp; </span>And when you went to pick up the green, you’d
get the blue.<span style="mso-spacerun:yes">&nbsp; </span>But what happens when you
get to picking up the blue?<span style="mso-spacerun:yes">&nbsp; </span>Well if this
is a program, chances are you crashed way back when you picked up the yellow
instead of the red.<span style="mso-spacerun:yes">&nbsp; </span>And if not then, one
of the other times.<span style="mso-spacerun:yes">&nbsp; </span>If you did manage to
make it through, well then you crash now.<span style="mso-spacerun:yes">&nbsp;
</span>In any case, you crash, which is bad.<span style="mso-spacerun:yes">&nbsp;
</span>So make sure you don’t mess up the stack by either forgetting to put
something on or taking something off you shouldn’t or even putting things on in
the wrong order.<span style="mso-spacerun:yes">&nbsp; </span>It doesn’t take a lot
to crash a program if you corrupt the stack.<span style="mso-spacerun:yes">&nbsp;
</span>This is also the reason why you shouldn’t mess with ESP (Stack Pointer)
unless you know what you’re doing.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">With that out of the way, we can begin to look at some
basically assembly instructions, starting with two that work with the stack,
PUSH and POP.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now that we’ve seen the registers and the stack, we
need to learn how the two work together.<span style="mso-spacerun:yes">&nbsp;
</span>If you haven’t noticed, we only have about 7 registers that we can use
as much as we want.<span style="mso-spacerun:yes">&nbsp; </span>So what happens we
need to temporarily used a register for something else and then get its value
back?<span style="mso-spacerun:yes">&nbsp; </span>Well, we use the stack.<span style="mso-spacerun:yes">&nbsp; </span>We put it on the stack and then take it off
again.<span style="mso-spacerun:yes">&nbsp; </span>To put something on the stack, we
use the PUSH instruction.<span style="mso-spacerun:yes">&nbsp; </span>When we do
this, we say we are pushing something onto the stack.<span style="mso-spacerun:yes">&nbsp; </span>The PUSH instruction looks like this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH EAX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH EBX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH ECX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The stack starts at the top of the memory block
allocated to it and grows down.<span style="mso-spacerun:yes">&nbsp; </span>So each
time you execute a PUSH you also subtract 4 from the current value of<span style="mso-spacerun:yes">&nbsp; </span>the ESP register, which always points to the
bottom of the downward-growing stack.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The following segment of assembly will put the values
in EAX, then EBX and finally ECX onto the stack.<span style="mso-spacerun:yes">&nbsp; </span>We can also push things beside the
registers.<span style="mso-spacerun:yes">&nbsp; </span>We can do numbers as well.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH 5</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH FF</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">That segment of assembly will put the value 5 and then
255 onto the stack.<span style="mso-spacerun:yes">&nbsp; </span>When you do a PUSH
instruction, whether it is on a register, a number, or something else, all you
are putting onto the stack is a number, and that number is always a DWORD.<span style="mso-spacerun:yes">&nbsp; </span>It will be padded with leading zeros if
necessary.<span style="mso-spacerun:yes">&nbsp; </span>And just because you used the
PUSH EAX instruction this doesn’t mean that when you take this off the stack
you have to take it off and put it in EAX again.<span style="mso-spacerun:yes">&nbsp; </span>It can be put in another register as well.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Once you’ve put things onto the stack, you have to
know how to take them off.<span style="mso-spacerun:yes">&nbsp; </span>You do this
with the POP instruction.<span style="mso-spacerun:yes">&nbsp; </span>This is
usually called popping something off the stack.<span style="mso-spacerun:yes">&nbsp;
</span>This works almost exactly like PUSH.<span style="mso-spacerun:yes">&nbsp;
</span>POPs are also always DWORDS.<span style="mso-spacerun:yes">&nbsp; </span>They
look like&nbsp;this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">POP EAX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">POP EBX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Pretty similar, no?<span style="mso-spacerun:yes">&nbsp;
</span>This segment will take the top value on the stack and put it in
EAX.<span style="mso-spacerun:yes">&nbsp; </span>Then it takes the next value and
puts that in EBX.<span style="mso-spacerun:yes">&nbsp; </span>Each POP also adds 4
to the contents of the ESP register, and the stack shrinks up towards its
top.<span style="mso-spacerun:yes">&nbsp; </span>Unlike PUSH, though, you CANNOT do
something like:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">POP 5</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This doesn’t work.<span style="mso-spacerun:yes">&nbsp;
</span>You can POP to a location in memory, although you won’t see this very
often (at least not in Diablo II from what I’ve seen).<span style="mso-spacerun:yes">&nbsp; </span>But by far the most useful is popping to a
register.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">It is important enough to reiterate, every PUSH and
POP modifies the stack and the ESP.<br clear="all" style="page-break-before:always">
So far we have dealt with registers and stacks.<span style="mso-spacerun:yes">&nbsp;
</span>Stacks are defined in memory, but we can use a lot more in memory than
what is allocated on a stack.<span style="mso-spacerun:yes">&nbsp; </span>In fact,
memory contains all the code, data, stack, dynamic structures and everything
else related to a program when it is running.<span style="mso-spacerun:yes">&nbsp;
</span>And every item in memory in a program has a location, which we call a
memory address, or just address for short.<span style="mso-spacerun:yes">&nbsp;
</span>In a 32-bit machine you can have addresses between 00000000 and
FFFFFFFF.<span style="mso-spacerun:yes">&nbsp; </span>Windows reserves many
addresses for its own functions, so for our purposes the top address is
6FFFFFFF.<span style="mso-spacerun:yes">&nbsp; </span>And 00000000 itself is given a
special purpose as a null pointer, so it cannot be used as a valid
address.<span style="mso-spacerun:yes">&nbsp; </span>But that still leaves us with
over 1.5GB to play with!<span style="mso-spacerun:yes">&nbsp; </span>We access any
location with a pointer reference, in the form</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">{<i style="mso-bidi-font-style:
normal"><span style="font-style:italic;mso-bidi-font-style:normal">data size</span></i>}
PTR DS:[<i><span style="font-style:italic">address</span></i>]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">What that code says is that we want to get a value of
a specific size (byte, word, dword as mentioned earlier) at the given location
in memory.<span style="mso-spacerun:yes">&nbsp; </span>The DS: refers to a special
register, called a segment register, which used to be very important in Intel
coding.<span style="mso-spacerun:yes">&nbsp; </span>But with 32-bit processors, huge
quantities of RAM and all recent versions of Windows, nobody does segment-based
programming anymore.<span style="mso-spacerun:yes">&nbsp; </span>In Diablo II, many
references include the DS register, so you need to recognize it when you see it
in Ollydbg.<span style="mso-spacerun:yes">&nbsp; </span>And some references use the
SS segment register, but again it is not important for our discussion.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">It is extremely important to keep a clear distinction
in mind between a memory address and the contents of memory at that
location.<span style="mso-spacerun:yes">&nbsp; </span>The sample table below has a
column for addresses and a column of hypothetical values.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1045" type="#_x0000_t75"
 style='width:117.75pt;height:2in'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image040.gif" o:title="Image010"/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="157" height="192" src="./Diablo II v1_files/image040.gif" v:shapes="_x0000_i1045"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Here is an example of how we reference memory.<span style="mso-spacerun:yes">&nbsp; </span>Let’s say that E2 is actually a dword, stored
in reverse byte order, and we want to use it.<span style="mso-spacerun:yes">&nbsp;
</span>Our pointer reference would be:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">DWORD PTR DS:[0029800C]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">In the same way, if we want to retrieve the value at
00298004 as a word, or at 0029801C as a byte, we would use these pointer
references:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">WORD PTR DS:[00298004]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">BYTE PTR DS:[0029801C]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Because we are working with 32-bit systems, there is
no equivalent qword pointer reference.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now let’s look at moving values around between
registers and memory.<span style="mso-spacerun:yes">&nbsp; </span>Let’s say we
wanted to move the value in EDX to EAX.<span style="mso-spacerun:yes">&nbsp;
</span>We could do the following:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH EDX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">POP EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This would put the value in EDX onto the stack and
then remove it and put it in EAX.<span style="mso-spacerun:yes">&nbsp; </span>But it
is relatively inefficient, and it modifies the stack when we don’t need
to.<span style="mso-spacerun:yes">&nbsp; </span>There is a better way to do this,
using the MOV instruction.<span style="mso-spacerun:yes">&nbsp; </span>MOV stands
for move (big surprise) and is used to move a value between registers, or between
a register and a location in memory.<span style="mso-spacerun:yes">&nbsp; </span>To
transfer a value from EDX to EAX with this instruction, we would write:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX, EDX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This reads as “move EDX into EAX”.<span style="mso-spacerun:yes">&nbsp; </span>In a MOV instruction there are always two
things separated by a comma.<span style="mso-spacerun:yes">&nbsp; </span>In this
case they are EAX and EDX.<span style="mso-spacerun:yes">&nbsp; </span>The first
thing is the destination, or the thing we want the value to be placed
into.<span style="mso-spacerun:yes">&nbsp; </span>The second thing is the source, or
the value we want placed in the first thing.<span style="mso-spacerun:yes">&nbsp;
</span>We can also use MOV to move numbers into a register:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX, 30</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This moves the value 48 into EAX (remember in
hexadecimal 30 = 3 * 16, not 3 * 10).<span style="mso-spacerun:yes">&nbsp; </span>We
can’t do the opposite, though, and say:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV 30, EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">That doesn’t work, because 30 is not a destination.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We can also use move into and out of locations in
memory.<span style="mso-spacerun:yes">&nbsp; </span>Here we use the pointer
references we mentioned earlier.<span style="mso-spacerun:yes">&nbsp;
</span>Returning to the memory table above, let’s move the dword 000000E2 to
EAX:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX, DWORD PTR DS:[
0029800C]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Conversely, we can move from a register to a memory
location:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV DWORD PTR DS:[ 00298030],
EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">But you cannot transfer information using a pointer
reference as a destination and as a source, so the intended instruction…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV DWORD PTR DS:[
00298030], DWORD PTR DS:[ 0029800C]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…must be broken into two steps, using an available
register as an intermediate stop:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX, DWORD PTR DS:[
0029800C]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV DWORD PTR DS:[
00298030], EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><span style="mso-spacerun:yes">&nbsp;</span><br clear="all" style="page-break-before:always">
What about smaller data sizes?<span style="mso-spacerun:yes">&nbsp; </span>We have
discussed 32-bit registers, but we know data can be bytes, words or dwords in
memory, not to mention strings and structures.<span style="mso-spacerun:yes">&nbsp;
</span>You cannot directly say</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX, BYTE PTR DS:[
0029801C]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You have to use one of the special MOV instructions,
or use a register reference that fits the data size.<span style="mso-spacerun:yes">&nbsp; </span>There are two instructions for moving smaller
data to a register.<span style="mso-spacerun:yes">&nbsp; </span>Which one you choose
depends on whether your application is signed or unsigned.<span style="mso-spacerun:yes">&nbsp; </span>The unsigned form is</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOVZX {register}, BYTE
PTR DS:[location]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOVZX {register}, WORD
PTR DS:[location]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The MOVZX copies the data into the lower bits of the register,
and pads the higher bits with 0.<span style="mso-spacerun:yes">&nbsp; </span>So if
we say, load EAX with the byte value 4D at 0029801C, the instruction would
yield</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EAX = 00 00 00 4D</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Similarly, loading EAX with the word value F338 at
00298004, the instruction would yield</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EAX = 00 00 F3 38</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The signed form is MOVSX, and behaves similarly.<span style="mso-spacerun:yes">&nbsp; </span>But instead of always padding higher bits
with 0, it does this only if the source number is positive, and it pads with 1
if the source number is negative.<span style="mso-spacerun:yes">&nbsp; </span>This
has to do with the fact that the most significant bit of any number is the sign
bit.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">If the byte number we used in the MOVZX discussion had
been a negative value, its representation would be B3.<span style="mso-spacerun:yes">&nbsp; </span>The word value is already a negative
number.<span style="mso-spacerun:yes">&nbsp; </span>So the results of MOVSX with
these two values would be</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EAX = FF FF FF B3</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EAX = FF FF F3 38</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">It looks like the MOVZX instruction takes the absolute
value of the data, but that is a wrong interpretation as 0000F338 is definitely
not equal to abs(FFFFF338).</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now let’s look at the other way to move smaller data into
and out of memory.<span style="mso-spacerun:yes">&nbsp; </span>MOVZX and MOVSX are
one-way transfers, they do not work to put a register value into memory.<span style="mso-spacerun:yes">&nbsp; </span>In order to handle this, the 32-bit registers
have subdivisions we can refer to directly.<span style="mso-spacerun:yes">&nbsp;
</span>If we say EAX has four bytes as below (MSB being the most significant
byte, LSB being the least significant byte)…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EAX = MSB 2SB 3SB LSB</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…then we can refer to the LSB value directly as
byte-size register <st1:state w:st="on"><st1:place w:st="on">AL</st1:place></st1:state>…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…and we can refer to the 3SB value directly as
byte-size register AH…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…and we can refer to the 3SB-LSB word value directly
as word-size register AX…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…but we cannot refer directly to the MSB or 2SB bytes,
or to the MSB-2SB or 2SB-3SB words.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EBX can be subdivided into BL, BH and BX; ECX into CL,
CH and CX; and EDX into DL, DH and DX.<span style="mso-spacerun:yes">&nbsp;
</span>The specific bytes referenced by these subdivisions are exactly as with
those of EAX.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The remaining general-purpose registers, ESI, EDI and
EBP, do not have byte-wide subdivisions.<span style="mso-spacerun:yes">&nbsp;
</span>You can refer to the 3SB-LSB word for the first three as SI, DI and BP
respectively.<span style="mso-spacerun:yes">&nbsp; </span>You can also refer to the
3SB-LSB word of ESP as SP, but this is more risky since we are now looking at
the pointer to stack addresses itself.<span style="mso-spacerun:yes">&nbsp;
</span>It is very important to manipulate this last register in dword
increments only!</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">That is a lot of discussion about register
organization.<span style="mso-spacerun:yes">&nbsp; </span>Let’s look at an
example.<span style="mso-spacerun:yes">&nbsp; </span>If we loaded EAX with the value
0x4F3D1B7A, we would see</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><st1:state w:st="on"><st1:place w:st="on"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">AL</span></font></st1:place></st1:state> = 7A</p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">AH = 1B</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">AX = 1B7A</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now let’s put this all together with moving data into
and out of memory.<span style="mso-spacerun:yes">&nbsp; </span>We return to the
example used in the MOVZX and MOVSX discussions, but now we load into
appropriately-sized register subdivisions…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV AL, BYTE PTR
DS:[0029801C]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV CX, WORD PTR
DS:[00298004]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…which puts 4D into <st1:place w:st="on"><st1:state w:st="on">AL</st1:state></st1:place> and F338 into CX respectively.<span style="mso-spacerun:yes">&nbsp; </span>If both registers were zero beforehand, you
would see</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">EAX = 00 00 00 4D</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">ECX = 00 00 F3 38</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">But in neither case were the other bytes actually
zeroed out by the MOV instruction, unlike what was done by the MOVZX
instruction.<span style="mso-spacerun:yes">&nbsp; </span>If those bytes were nonzero
before, they remain nonzero afterward.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You can also load memory from a register the same
way.<span style="mso-spacerun:yes">&nbsp; </span>Just write</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV BYTE PTR
DS:[0029801C], <st1:place w:st="on"><st1:state w:st="on">AL</st1:state></st1:place></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV WORD PTR
DS:[00298004], CX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We saw before that data can be moved between the stack
and either registers or memory, but doing so with PUSH and POP alters the stack
itself and shifts the stack pointer.<span style="mso-spacerun:yes">&nbsp; </span>We
might want to read data from the stack, or write to some location not at the
stack pointer.<span style="mso-spacerun:yes">&nbsp; </span>This is how local
variables in a procedure are implemented in assembly language, and how more than
one item can be passed from a procedure to the procedure that references
it.<span style="mso-spacerun:yes">&nbsp; </span>These take the form</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV {register}, DWORD PTR
DS:[ESP+{offset}]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV DWORD PTR
DS:[ESP+{offset}], {register}</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We will discuss this use of the MOV instruction in much
greater detail later on.<br clear="all" style="page-break-before:always">
Now we will see what can be done with these numbers, starting with mathematical
instructions.<span style="mso-spacerun:yes">&nbsp; </span>Let’s look first at the
ADD instruction.<span style="mso-spacerun:yes">&nbsp; </span>This is pretty self
exclamatory.<span style="mso-spacerun:yes">&nbsp; </span>This adds a value to the
given register.<span style="mso-spacerun:yes">&nbsp; </span>For example:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">ADD EAX, 1</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This adds 1 to EAX.<span style="mso-spacerun:yes">&nbsp;
</span>We can also say something like:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">ADD EAX, EDX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This adds the value of EDX to EAX.<span style="mso-spacerun:yes">&nbsp; </span>Not so difficult to understand, now is it.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You cannot say ADD 1, EAX any more than you can say
MOV 1, EAX.<span style="mso-spacerun:yes">&nbsp; </span>Destinations must always be
containers such as registers and memory locations; they cannot be constants.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">If there is an ADD instruction, then it follows that
there should be one for subtraction.<span style="mso-spacerun:yes">&nbsp;
</span>This is called the SUB instruction, and works just like the ADD
instruction:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">SUB EAX, 1</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">SUB EAX, EDX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Nothing surprising there.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Following along the with the ADD instructions is the
INC instruction.<span style="mso-spacerun:yes">&nbsp; </span>This increases the
value of the given register by one.<span style="mso-spacerun:yes">&nbsp; </span>This
is simply:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">INC EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The above statement is the same as saying:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">ADD EAX, 1</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Only it is smaller (one byte instead of three) and
executes faster.<span style="mso-spacerun:yes">&nbsp; </span>You’ll see this a lot,
so remember it.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">And if there’s an INC instruction, there is obviously
one to decrease the value of a register by one.<span style="mso-spacerun:yes">&nbsp;
</span>This one is called the DEC instruction.<span style="mso-spacerun:yes">&nbsp;
</span>It works just the same:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">DEC EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Which is like saying:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">SUB EAX, 1</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Not very difficult to understand.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">What about multiplication and division?<span style="mso-spacerun:yes">&nbsp; </span>Instructions exist to handle them, but there
are two variations of each and they have unusual behavior based on what we have
discussed so far.<span style="mso-spacerun:yes">&nbsp; </span>We will start with
multiplication: there are two instructions, MUL and IMUL.<span style="mso-spacerun:yes">&nbsp; </span>And we will use the Intel convention of
referring to register sizes (in bits) as r8, r16, r32 and memory location sizes
as m8, m16 ands m32.<span style="mso-spacerun:yes">&nbsp; </span>This convention
also includes r/m8, r/m16 and r/m32 to mean either register or memory location
of stated size.<span style="mso-spacerun:yes">&nbsp; </span>Numeric constants are
referred to as immediate numbers: imm8, imm16 and imm32.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MUL is an unsigned operation that always uses the EAX
register as one of the two sources and also uses the EAX and EDX registers to
receive the result.<span style="mso-spacerun:yes">&nbsp; </span>When preparing for a
multiplication, it is best to be sure these registers do not contain
information that should not be lost, or (in the cases for smaller data sizes)
contains data in unaffected portions that might skew the results.<span style="mso-spacerun:yes">&nbsp; </span>Depending on data size, we see these effects:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<ol style="margin-top:0in" start="1" type="1">
 <li class="MsoNormal" style="mso-list:l0 level1 lfo1;tab-stops:list .5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">For
     byte-size numbers, MUL [r/m8] means <st1:state w:st="on">AL</st1:state> *
     [r/m8] </span></font><font face="Wingdings"><span style="font-family:Wingdings;
     mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;
     mso-char-type:symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">à</span></span></font>
     DL:<st1:state w:st="on">AL</st1:state>, where the high byte of the answer
     goes to DL and the low byte of the answer goes to <st1:place w:st="on"><st1:state w:st="on">AL</st1:state></st1:place>.<span style="mso-spacerun:yes">&nbsp;
     </span>The rest of EDX and EAX are unchanged.</li>
</ol>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<ol style="margin-top:0in" start="2" type="1">
 <li class="MsoNormal" style="mso-list:l0 level1 lfo1;tab-stops:list .5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">For
     word-size numbers, MUL [r/m16] means AX * [r/m16] </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:
     &quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:
     symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:symbol;
     mso-symbol-font-family:Wingdings">à</span></span></font> DX:AX, where the
     high word of the answer goes to DX and the low word of the answer goes to
     AX.<span style="mso-spacerun:yes">&nbsp; </span>The rest of EDX and EAX are
     unchanged.</li>
</ol>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<ol style="margin-top:0in" start="3" type="1">
 <li class="MsoNormal" style="mso-list:l0 level1 lfo1;tab-stops:list .5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">For
     dword-size numbers, MUL [r/m32] means EAX * [r/m32] </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:
     &quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:
     symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:symbol;
     mso-symbol-font-family:Wingdings">à</span></span></font> EDX:EAX, where
     the high dword of the answer goes to EDX and the low dword of the answer
     goes to EAX.</li>
</ol>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">IMUL is a signed multiplication that can be used in
three ways.<span style="mso-spacerun:yes">&nbsp; </span>The first form is very
similar to the previous instruction, using <st1:place w:st="on"><st1:state w:st="on">AL</st1:state></st1:place>, AX or EAX as one of the two sources and
the results always end up in EDX:EAX.<span style="mso-spacerun:yes">&nbsp;
</span>The other two forms allow you to use another register than EAX as one
source and the destination, but if the result exceeds the data width then the
excess bits are lost.<span style="mso-spacerun:yes">&nbsp; </span>Also note that the
register or memory location used as a second source can also be an immediate
constant, either one byte or matching the width of the destination.<span style="mso-spacerun:yes">&nbsp; </span>So there are actually three sub-form 2 and
two sub-form 3 versions.<span style="mso-spacerun:yes">&nbsp; </span>In new code it
might be hard to see a distinction, but when looking at existing code it makes
a difference in the number of bytes used for the immediate value.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Form 2 for word-size numbers, MUL [r16],[r/m16] means
[r16] * [r/m16] </span></font><font face="Wingdings"><span style="font-family:
Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;
mso-char-type:symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:
symbol;mso-symbol-font-family:Wingdings">à</span></span></font> [r16]</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Form 2 for dword-size numbers, MUL [r32],[r/m32] means
[r32] * [r/m32] </span></font><font face="Wingdings"><span style="font-family:
Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;
mso-char-type:symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:
symbol;mso-symbol-font-family:Wingdings">à</span></span></font> [r32]</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Form 2 for word-size numbers, MUL [r16],[ imm8] means
[r16] * [imm8] </span></font><font face="Wingdings"><span style="font-family:
Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;
mso-char-type:symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:
symbol;mso-symbol-font-family:Wingdings">à</span></span></font> [r16]</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Form 2 for dword-size numbers, MUL [r32],[ imm8] means
[r32] * [imm8] </span></font><font face="Wingdings"><span style="font-family:
Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;
mso-char-type:symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:
symbol;mso-symbol-font-family:Wingdings">à</span></span></font> [r32]</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Form 2 for word-size numbers, MUL [r16],[ imm16] means
[r16] * [imm16] </span></font><font face="Wingdings"><span style="font-family:
Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;
mso-char-type:symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:
symbol;mso-symbol-font-family:Wingdings">à</span></span></font> [r16]</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Form 2 for dword-size numbers, MUL [r32],[ imm32]
means [r32] * [imm32] </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;
mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:symbol;mso-symbol-font-family:
Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">à</span></span></font>
[r32]</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Form 3 for word-size numbers, MUL [r16],[r/m16],[imm8]
means [r/m16] * [imm8] </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;
mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:symbol;mso-symbol-font-family:
Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">à</span></span></font>
[r/16]</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Form 3 for dword-size numbers, MUL [r32],[r/m32]
,[imm8] means [r/m32] * [imm8] </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;
mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:symbol;mso-symbol-font-family:
Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">à</span></span></font>
[r/32]</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Form 3 for word-size numbers, MUL
[r16],[r/m16],[imm16] means [r/m16] * [imm16] </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;
mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:symbol;mso-symbol-font-family:
Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">à</span></span></font>
[r/16]</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Form 3 for dword-size numbers, MUL [r32],[r/m32]
,[imm32] means [r/m32] * [imm32] </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;
mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:symbol;mso-symbol-font-family:
Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">à</span></span></font>
[r/32]</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Whew!<span style="mso-spacerun:yes">&nbsp; </span>That is a
lot of work for multiplication, no?<span style="mso-spacerun:yes">&nbsp; </span>We
better look at some examples.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let EDX = 0 and EAX = 0 before anything happens.<span style="mso-spacerun:yes">&nbsp; </span>If we execute the sequence…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV ECX,6</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,12</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MUL CL</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…then we will multiply 0x06 * 0x12 and get
0x006C.<span style="mso-spacerun:yes">&nbsp; </span>In DL we would have 0x00 and in <st1:state w:st="on"><st1:place w:st="on">AL</st1:place></st1:state> we would have
0x6C.<span style="mso-spacerun:yes">&nbsp; </span>But if we have…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV ECX,6</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,12</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MUL CX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…then we will multiply 0x0006 * 0x0012 and get
0x0000006C.<span style="mso-spacerun:yes">&nbsp; </span>In DX we would have 0x0000
and in AX we would have 0x006C.<span style="mso-spacerun:yes">&nbsp; </span>But if
we have…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV ECX,6</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,12</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MUL ECX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…then we will multiply 0x00000006 * 0x00000012 and get
0x000000000000006C.<span style="mso-spacerun:yes">&nbsp; </span>In EDX we would have
0x00000000 and in EAX we would have 0x0000006C.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now we look at examples of IMUL.<span style="mso-spacerun:yes">&nbsp; </span>The first form looks like the preceding
examples, so we won’t repeat them here.<span style="mso-spacerun:yes">&nbsp;
</span>But the other forms might look like…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV ECX,6</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,12</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">IMUL CX,AX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…where we would multiply 0x0006 * 0x0012 and get
0x006C in CX.<span style="mso-spacerun:yes">&nbsp; </span>But if we have…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV ECX,6</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,12</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">IMUL ECX,EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…then we would multiply 0x00000006 * 0x00000012 and
get 0x0000006C in ECX.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Note that in either case, we could have left ECX
undefined and said IMUL CX,AX,6 or IMUL&nbsp;ECX,EAX,6 and achieved the same
net result.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">As with multiplication, there are two forms, the
unsigned DIV and the signed IDIV instructions.<span style="mso-spacerun:yes">&nbsp;
</span>Unlike with multiplication, the DIV instruction will always use EAX (and
EDX) at some point, and the two instructions have the same behavior for any
data size.<span style="mso-spacerun:yes">&nbsp; </span>And if the divisor is zero,
or the quotient is larger than the destination register, the processor will
cough up a Divide Error and crash your game.<span style="mso-spacerun:yes">&nbsp;
</span>Depending on data size, we see the following effects:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<ol style="margin-top:0in" start="1" type="1">
 <li class="MsoNormal" style="mso-list:l1 level1 lfo2;tab-stops:list .5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">For
     byte-size numbers, DIV or IDIV [r/m8] the dividend is in AX, the divisor
     is [r/m8] and AX / [r/m8] </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;
     mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:symbol;mso-symbol-font-family:
     Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">à</span></span></font>
     AH:<st1:state w:st="on">AL</st1:state>, where the quotient goes to <st1:place w:st="on"><st1:state w:st="on">AL</st1:state></st1:place> and the
     remainder goes to AH.<span style="mso-spacerun:yes">&nbsp; </span>The rest of
     EAX is unchanged and EDX is not involved.</li>
</ol>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<ol style="margin-top:0in" start="2" type="1">
 <li class="MsoNormal" style="mso-list:l1 level1 lfo2;tab-stops:list .5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">For
     word-size numbers, DIV or IDIV [r/m16] the dividend is in DX:AX (high word
     in DX and low word in AX), the divisor is [r/m16] and DX:AX / [r/m16] </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:
     &quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:
     symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:symbol;
     mso-symbol-font-family:Wingdings">à</span></span></font> AX:DX, where the
     quotient goes to AX and the remainder goes to DX.<span style="mso-spacerun:yes">&nbsp; </span>The rest of EAX and EDX is unchanged.</li>
</ol>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<ol style="margin-top:0in" start="3" type="1">
 <li class="MsoNormal" style="mso-list:l1 level1 lfo2;tab-stops:list .5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">For
     dword-size numbers, DIV or IDIV [r/m32] the dividend is in EDX:EAX (high
     word in EDX and low word in EAX), the divisor is [r/m32] and EDX:EAX /
     [r/m32] </span></font><font face="Wingdings"><span style="font-family:Wingdings;
     mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;
     mso-char-type:symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">à</span></span></font>
     EAX:EDX, where the quotient goes to EAX and the remainder goes to EDX.</li>
</ol>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">When using the word and dword forms of DIV or IDIV, it
is important to do a bit of housekeeping up front, so the instruction itself
knows EDX and EAX are ready.<span style="mso-spacerun:yes">&nbsp; </span>Most of the
time these registers are used independently, so there is nothing which relates
EDX as the upper half of a number and EAX as the lower half of the same
number.<span style="mso-spacerun:yes">&nbsp; </span>This is where CWD and CDQ come
to play.<span style="mso-spacerun:yes">&nbsp; </span>The CWD instruction (“convert
word to dword”) takes the sign of AX and fills all bits in DX with the same
value.<span style="mso-spacerun:yes">&nbsp; </span>The CDQ instruction (“convert
dword to qword”) takes the sign bit of EAX and fills all bits in EDX with the
same value.<span style="mso-spacerun:yes">&nbsp; </span>CWD is used very rarely in
Diablo II, if at all, but CDQ is commonly seen right before a DIV or IDIV
instruction.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s see how this works.<span style="mso-spacerun:yes">&nbsp; </span>Using either division instruction, let EAX =
0 and EDX = 0 before we start.<span style="mso-spacerun:yes">&nbsp; </span>Now we
execute…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,0x6E</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV ECX,6</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">DIV CL</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…which gets us 0x6C/0x06 or 0x12 with remainder
0x02.<span style="mso-spacerun:yes">&nbsp; </span>So <st1:state w:st="on"><st1:place w:st="on">AL</st1:place></st1:state> = 0x12 and AH = 0x02.<span style="mso-spacerun:yes">&nbsp; </span>But if we execute…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,0x6E</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV ECX,6</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CWD</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">DIV CX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…then we will see 0x006C/0x0006 with remainder
0x0002.<span style="mso-spacerun:yes">&nbsp; </span>So AX = 0x0012 and DX =
0x0002.<span style="mso-spacerun:yes">&nbsp; </span>And finally, if we execute…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,0x6E</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV ECX,6</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CDQ</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">DIV ECX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…then we will see 0x0000006C/0x00000006 with remainder
0x00000002.<span style="mso-spacerun:yes">&nbsp; </span>So EAX = 0x00000012 and EDX
= 0x00000002.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><span style="mso-spacerun:yes">&nbsp;</span></span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">These are most of the important math functions, so
let’s look at the some logic functions.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The first we’ll look at is the AND instruction.<span style="mso-spacerun:yes">&nbsp; </span>ANDing is a boolean operation that is
extremely common in computers.<span style="mso-spacerun:yes">&nbsp; </span>It is one
of the most basic and most important operations that can be performed.<span style="mso-spacerun:yes">&nbsp; </span>Here’s what an AND instruction looks like:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">AND EAX, EDX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">AND EAX, FF</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">AND BYTE PTR DS:
[{location}], 3C</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">AND BX, WORD PTR
DS:[{location}]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">As you can see, it works with registers, memory
locations or values, but you still need to know how it functions.<span style="mso-spacerun:yes">&nbsp; </span>This is one of those important times when you
need to know how to convert to binary because AND functions on a binary
level.<span style="mso-spacerun:yes">&nbsp; </span>AND goes through and compares
every bit in a number with the corresponding bit from another number.<span style="mso-spacerun:yes">&nbsp; </span>If either or both of these bits or 0, the AND
results in a 0 bit.<span style="mso-spacerun:yes">&nbsp; </span>If both are 1, the
AND results in a 1 bit.<span style="mso-spacerun:yes">&nbsp; </span></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s see how AND works, using 243 and 149.<span style="mso-spacerun:yes">&nbsp; </span>For simplicity, we will look at byte-size
numbers rather than full dword numbers.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">In binary, these numbers are: 1111 0011 and 1001
0101.<span style="mso-spacerun:yes">&nbsp; </span>Now we go through and compare each
bit.<span style="mso-spacerun:yes">&nbsp; </span>If either is 0, the resulting bit
is 0, but if both are 1, the resulting bit is&nbsp;1.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><b><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier;font-weight:
bold">1</span></font></b><font size="2" face="Courier"><span style="font-size:10.0pt;
font-family:Courier">11<b><span style="font-weight:bold">1</span></b> 001<b><span style="font-weight:bold">1</span></b><span style="mso-spacerun:yes">&nbsp;
</span>(243)<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><b><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier;font-weight:
bold">1</span></font></b><font size="2" face="Courier"><span style="font-size:10.0pt;
font-family:Courier">00<b><span style="font-weight:bold">1</span></b> 010<b><span style="font-weight:bold">1</span></b><span style="mso-spacerun:yes">&nbsp;
</span>(149)<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">----------------<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><b><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier;font-weight:
bold">1</span></font></b><font size="2" face="Courier"><span style="font-size:10.0pt;
font-family:Courier">00<b><span style="font-weight:bold">1</span></b> 000<b><span style="font-weight:bold">1</span></b><span style="mso-spacerun:yes">&nbsp;
</span>(145) </span></font><font size="2" face="Wingdings"><span style="font-size:
10.0pt;font-family:Wingdings;mso-ascii-font-family:Courier;mso-hansi-font-family:
Courier;mso-char-type:symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">ß</span></span></font><font size="2" face="Courier"><span style="font-size:10.0pt;font-family:Courier">Result<o:p></o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">With the assembly instruction AND, the result is
placed in the first value.<span style="mso-spacerun:yes">&nbsp; </span>So with our
above examples, the result is placed in EAX both times.<span style="mso-spacerun:yes">&nbsp; </span>This being the case, you CAN’T do something
like:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">AND 7F, EAX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">AND 7F, FF</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">It won’t work.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Following the AND instruction is the OR instruction,
which looks a lot like the <st1:country-region w:st="on"><st1:place w:st="on">AND.</st1:place></st1:country-region><span style="mso-spacerun:yes">&nbsp; </span>You can use the OR instruction just like AND:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">OR EAX, EDX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">OR EAX, FF</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">OR BYTE PTR DS:
[{location}], 3C</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">OR BX, WORD PTR
DS:[{location}]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The result of an OR, however, is far different from an
<st1:country-region w:st="on"><st1:place w:st="on">AND.</st1:place></st1:country-region><span style="mso-spacerun:yes">&nbsp; </span>In an OR, we go through and compare each bit
of a number, but if either is 1, the resulting bit is 1.<span style="mso-spacerun:yes">&nbsp; </span>If both are 0, the resulting bit is 0.<span style="mso-spacerun:yes">&nbsp; </span>Returning to our two sample numbers, 243 and
149, we already know the binary values are 1111 0011 and 1001 0101.<span style="mso-spacerun:yes">&nbsp; </span>Let’s perform the OR.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">1111 <b><span style="font-weight:bold">0</span></b>011<span style="mso-spacerun:yes">&nbsp;
</span>(243)<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">1001 <b><span style="font-weight:bold">0</span></b>101<span style="mso-spacerun:yes">&nbsp;
</span>(149)<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">----------------<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">1111 <b><span style="font-weight:bold">0</span></b>111<span style="mso-spacerun:yes">&nbsp;
</span>(247) </span></font><font size="2" face="Wingdings"><span style="font-size:
10.0pt;font-family:Wingdings;mso-ascii-font-family:Courier;mso-hansi-font-family:
Courier;mso-char-type:symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">ß</span></span></font><font size="2" face="Courier"><span style="font-size:10.0pt;font-family:Courier">Result<o:p></o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You can see that the result is far different from the <st1:country-region w:st="on"><st1:place w:st="on">AND.</st1:place></st1:country-region><span style="mso-spacerun:yes">&nbsp; </span>The result is placed in the first value of
the assembly instruction, so the result would be placed in EAX in both of our
above instructions.<span style="mso-spacerun:yes">&nbsp; </span>Once again, you
can’t do:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">OR 7F, EAX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">OR 7F, FF</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Just like with AND, this doesn’t work.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">XOR EAX, EDX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">XOR EAX, FF</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">XOR BYTE PTR DS:
[{location}], 3C</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">XOR BX, WORD PTR
DS:[{location}]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">An instruction closely related to OR is XOR, the
exclusive OR.<span style="mso-spacerun:yes">&nbsp; </span>Whereas an OR operation
will return a 1 if either or both inputs are 1, the XOR operation will return 0
if both inputs are either 0 or 1, and it will return a 1 if both inputs are
different from each other.<span style="mso-spacerun:yes">&nbsp; </span>Using the
same test numbers, let’s perform an XOR:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">1111 <b><span style="font-weight:bold">0</span></b>011<span style="mso-spacerun:yes">&nbsp;
</span>(243)<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">1001 <b><span style="font-weight:bold">0</span></b>101<span style="mso-spacerun:yes">&nbsp;
</span>(149)<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">----------------<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><b><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier;font-weight:
bold">0</span></font></b><font size="2" face="Courier"><span style="font-size:10.0pt;
font-family:Courier">11<b><span style="font-weight:bold">0</span></b> <b><span style="font-weight:bold">0</span></b>11<b><span style="font-weight:bold">0</span></b><span style="mso-spacerun:yes">&nbsp; </span>(102) </span></font><font size="2" face="Wingdings"><span style="font-size:10.0pt;font-family:Wingdings;mso-ascii-font-family:
Courier;mso-hansi-font-family:Courier;mso-char-type:symbol;mso-symbol-font-family:
Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">ß</span></span></font><font size="2" face="Courier"><span style="font-size:10.0pt;font-family:Courier">Result<o:p></o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Since the XOR operation will return 0 if both inputs
are the same, it is common to see an instruction like</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">XOR EAX,EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…in the code.<span style="mso-spacerun:yes">&nbsp;
</span>This is a very fast way to zero out a register, even faster than MOV
EAX,0.<span style="mso-spacerun:yes">&nbsp; </span>So optimizing compilers will use
this form all over the map.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Once again, you can’t do:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">XOR 7F, EAX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">XOR 7F, FF</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The next logic instruction of interest is the NOT
instruction.<span style="mso-spacerun:yes">&nbsp; </span>This one is simply:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">NOT EAX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">NOT DWORD PTR
DS:[{location}]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">It only works with one and only one register or memory
location at a time.<span style="mso-spacerun:yes">&nbsp; </span>Like AND and OR,
this goes through and works on the binary level.<span style="mso-spacerun:yes">&nbsp; </span>This time, it makes each bit the opposite of
what it was.<span style="mso-spacerun:yes">&nbsp; </span>If it was a 1, it becomes a
0.<span style="mso-spacerun:yes">&nbsp; </span>If it was a 0, it becomes a 1.<span style="mso-spacerun:yes">&nbsp; </span>Here’s an example:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">NOT 243</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">1111 0011<span style="mso-spacerun:yes">&nbsp; </span>(243)<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">----------------<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">0000 1100<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>(12) </span></font><font size="2" face="Wingdings"><span style="font-size:10.0pt;font-family:Wingdings;mso-ascii-font-family:
Courier;mso-hansi-font-family:Courier;mso-char-type:symbol;mso-symbol-font-family:
Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">ß</span></span></font><font size="2" face="Courier"><span style="font-size:10.0pt;font-family:Courier">Result<o:p></o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The result is placed in the register or memory
location used in the operation.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Some other logic operations we want to look at are the
shift operations.<span style="mso-spacerun:yes">&nbsp; </span>The first is the SHL instruction,
which is shift left instruction.<span style="mso-spacerun:yes">&nbsp; </span>This
shifts the bits of the given number left a given amount.<span style="mso-spacerun:yes">&nbsp; </span>It is the equivalent of a multiplication by a
power of two, unless the number is so large (or the shift so many bits) that
higher bits are shifted completely out of the number.<span style="mso-spacerun:yes">&nbsp; </span>It looks like this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">SHL EAX, EDX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">SHL EAX, 4</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">SHL DWORD PTR DS:
[{location}], 13</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">As you can see, this one works with registers and
numbers.<span style="mso-spacerun:yes">&nbsp; </span>The first value must be a
register because, like AND and OR, it is where the result is stored.<span style="mso-spacerun:yes">&nbsp; </span>Here’s an example of how the shift works.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Shifting 243 Left 4</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We remember the binary of 243: 1111 0011.<span style="mso-spacerun:yes">&nbsp; </span>Now we add four 0s at the beginning.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">1111 0011</span></font><font color="#339966"><span style="color:#339966"> </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;
mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:symbol;mso-symbol-font-family:
Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">à</span></span></font>
<i><span style="font-style:italic">1111</span></i> 0011<font color="#339966"><span style="color:#339966"> </span></font><b><span style="font-weight:bold">0000<o:p></o:p></span></b></p>

<p class="MsoNormal"><b><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-weight:bold"><o:p>&nbsp;</o:p></span></font></b></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Then, we drop the left 4 bits (we are only working
with byte-wide values now), which leaves us with 0011 0000.<span style="mso-spacerun:yes">&nbsp; </span>Our value is 48 in decimal or 30 in
hexadecimal.<span style="mso-spacerun:yes">&nbsp; </span>If we had been shifting by
3, we would add three 0s at the beginning and drop the 3 left bits.<span style="mso-spacerun:yes">&nbsp; </span>Like this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><i><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-style:italic">111</span></font></i>1
0011 <b><span style="font-weight:bold">000</span></b></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">1001 1000</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">That’s not so hard, is it?</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Since there is a SHL instruction, there is obviously
going to be a SHR instruction, which shifts bits to the right.<span style="mso-spacerun:yes">&nbsp; </span>This is roughly equivalent to an unsigned
division by a power of 2.<span style="mso-spacerun:yes">&nbsp; </span>It looks like:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">SHR EAX, EDX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">SHR EAX, 4</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">SHR DWORD PTR DS:
[{location}], 13</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">It works just like the SHL instruction, only we add 0s
at the beginning and drop the right most bits.<span style="mso-spacerun:yes">&nbsp;
</span>For example:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Shifting 243 Right 4</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">1111 0011</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><b><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-weight:bold">0000</span></font></b>
1111 <i><span style="font-style:italic">0011</span></i></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0000 1111</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Shifting 243 Right 3</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">1111 0011</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><b><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-weight:bold">000</span></font></b>
1111 0<i><span style="font-style:italic">011</span></i></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0001 1110</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">A very similar pair of shifting instructions is the
SAL/SAR pair.<span style="mso-spacerun:yes">&nbsp; </span>In actuality there is no
difference between SAL and SHL, so you will not often find the SAL instruction
in a listing.<span style="mso-spacerun:yes">&nbsp; </span>There is a difference
between SAR and SHR, however.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>Whereas
SHR is an unsigned shift to the right, SAR preserves the value of the sign
bit.<span style="mso-spacerun:yes">&nbsp; </span>It is more or less a signed
division by a power of 2.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The final logic instruction is the NEG
instruction.<span style="mso-spacerun:yes">&nbsp; </span>This is actually useful as
both a logic and a math instruction.<span style="mso-spacerun:yes">&nbsp; </span>It
stands for negate, and is the equivalent of the “change sign” key on your
calculator.<span style="mso-spacerun:yes">&nbsp; </span>The NEG instruction works on
a register or memory location only:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">NEG EAX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">NEG DWORD PTR
DS:[{location}]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This makes the value in EAX negative.<span style="mso-spacerun:yes">&nbsp; </span>NEG is very similar to NOT, with NEG yielding
a value one higher than NOT.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Negative numbers are very screwy on computers, so
don’t be surprised with the numbers you get.<span style="mso-spacerun:yes">&nbsp;
</span>To see for yourself, start Windows Calculator and go into binary or
hexadecimal mode.<span style="mso-spacerun:yes">&nbsp; </span>Then subtract 2 from 1
and see what result you get.<span style="mso-spacerun:yes">&nbsp; </span>Look at all
the different data sizes when you do.<span style="mso-spacerun:yes">&nbsp;
</span>Rest assured, this is considered to be –1 as far as computers are
concerned.<span style="mso-spacerun:yes">&nbsp; </span>This is because for a number
of a given data size, the most significant bit is used to carry the sign of the
number.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">All arithmetic and logical instructions can have
effects on a special register called the Extended Flags Register (EFL).<span style="mso-spacerun:yes">&nbsp; </span>This register is displayed in OllyDbg in the
Registers section but it is actually a list of single bit values known as
flags.<span style="mso-spacerun:yes">&nbsp; </span>(We will talk more about Ollydbg
soon enough.)<span style="mso-spacerun:yes">&nbsp; </span>The eight most common
flags are shown above EFL in the Ollydbg sample on the next page.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1046" type="#_x0000_t75"
 style='width:203.25pt;height:68.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image041.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="271" height="91" src="./Diablo II v1_files/image042.jpg" v:shapes="_x0000_i1046"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">These eight flags are known as Carry, Parity,
Auxiliary Carry, Zero, Sign, Trap, Direction and Overflow.<span style="mso-spacerun:yes">&nbsp; </span>The most important flag we will use is the
Zero flag.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>The Sign flag is set by the
value of the most significant bit in a number as described earlier, and can be
used to determine if the number is positive or negative.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now we’ll look at program flow instructions, starting
with the CMP instruction.<span style="mso-spacerun:yes">&nbsp; </span>CMP stands for
compare, and is used to compare values and make decisions based on that.<span style="mso-spacerun:yes">&nbsp; </span>You’ll never see a CMP instruction that isn’t
followed closely (within a few lines of code) by some kind of jump.<span style="mso-spacerun:yes">&nbsp; </span>A CMP followed by a jump is an equivalent of
the IF..THEN statement in higher-level programming languages.<span style="mso-spacerun:yes">&nbsp; </span>The CMP instruction looks like this (among many
possible forms):</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CMP EAX, EDX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CMP EAX, 30</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CMP DWORD PTR
DS:[{location}], ECX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CMP BL, BYTE<span style="mso-spacerun:yes">&nbsp; </span>PTR DS:[{location}]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The CMP instruction is a hypothetical subtraction,
that is, the second value is subtracted from the first but neither value is
actually changed.<span style="mso-spacerun:yes">&nbsp; </span>But the operation will
set or clear the appropriate flag (s) as if the subtraction had occurred.<span style="mso-spacerun:yes">&nbsp; </span>In the above example, the CMP instruction
compares EAX to EDX, or EAX with the value 30, or the register values with
values in memory.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Very similar to the CMP instruction is the TEST
instruction.<span style="mso-spacerun:yes">&nbsp; </span>The TEST instruction is a
hypothetical logical AND, and as with CMP neither value is changed but the
appropriate flag(s) will be set or cleared.<span style="mso-spacerun:yes">&nbsp;
</span>Unlike the CMP instruction, it does not matter which number is first and
which number is second.<span style="mso-spacerun:yes">&nbsp; </span>The TEST
instruction looks like this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">TEST EAX, EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">It’s no typo that we have EAX shown twice.<span style="mso-spacerun:yes">&nbsp; </span>The TEST instruction is usually used in this
way, to see if a register value is zero or non-zero.<span style="mso-spacerun:yes">&nbsp; </span>You can use the TEST instruction in other
ways:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">TEST EAX, EDX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">TEST EAX, 30</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">TEST WORD PTR
DS:[{location}], CX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">TEST BL, BYTE<span style="mso-spacerun:yes">&nbsp; </span>PTR DS:[{location}]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The main reason for using these two instructions is
they set flags as a result of conditions, but you don’t alter the conditions
themselves in looking at them.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Most program flow handling has two parts, the decision
and the branch.<span style="mso-spacerun:yes">&nbsp; </span>If the CMP and TEST
instructions are the program decisions, how do we execute program
branches?<span style="mso-spacerun:yes">&nbsp; </span>In assembly, there are
unconditional and conditional jumps.<span style="mso-spacerun:yes">&nbsp; </span>We
will start with the unconditional jump, which is the JMP instruction.<span style="mso-spacerun:yes">&nbsp; </span>A JMP instruction is ALWAYS executed.<span style="mso-spacerun:yes">&nbsp; </span>The jump is always taken.<span style="mso-spacerun:yes">&nbsp; </span>It looks like this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JMP <i><span style="font-style:italic">ADDRESS</span></i></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><i><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-style:italic">ADDRESS</span></font></i> is the
location of code to jump to.<span style="mso-spacerun:yes">&nbsp; </span>This value
can be stored in memory, in a register, or given explicitly.<span style="mso-spacerun:yes">&nbsp; </span>There are several forms of JMP accordingly:</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JMP EAX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JMP 6FAC1FA0</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JMP [6FAC1FA0]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The first form jumps to the location specified by
EAX.<span style="mso-spacerun:yes">&nbsp; </span>The second form jumps to the
explicit address 6FAC1FA0.<span style="mso-spacerun:yes">&nbsp; </span>The third
form retrieves the destination address which is stored at 6FAC1FA0, rather than
to 6FAC1FA0 itself.<span style="mso-spacerun:yes">&nbsp; </span>And remember, any of
these jumps is always executed.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">There are times when we don’t always want to
jump.<span style="mso-spacerun:yes">&nbsp; </span>We may only want to jump when two
numbers are the same or when one is greater than the other.<span style="mso-spacerun:yes">&nbsp; </span>For this we have conditional jumps.<span style="mso-spacerun:yes">&nbsp; </span>Many conditions are derived from the values
of the various flags.<span style="mso-spacerun:yes">&nbsp; </span>Below is a list of
important conditional jumps we will frequently see.<span style="mso-spacerun:yes">&nbsp; </span>Many jumps have alternate names, as
programmers prefer to have names that reflect the context of the program
branch.<span style="mso-spacerun:yes">&nbsp; </span>Thus JE and JZ are the same
thing, JNE and JNZ are also the same thing.<span style="mso-spacerun:yes">&nbsp;
</span>Context of one decision may be whether two numbers are equal, but
context of another decision may be whether a result is zero.<span style="mso-spacerun:yes">&nbsp; </span>Other alternates are indicated in brackets,
but I will not address them further.<span style="mso-spacerun:yes">&nbsp;
</span>Note: OllyDbg does not retain alternate forms, so you would see JE when
the context is clearly intended to be JZ.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JE – Jump If Equal</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JNE – Jump If Not Equal
(form not retained by OllyDbg)</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JZ – Jump If Zero (form
not retained by OllyDbg)</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JNZ – Jump If Not Zero</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JG [JNLE] – Jump If
Greater Than (signed numbers)</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JGE [JNL] – Jump If
Greater Than Or Equal To (signed numbers)</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JL [JNGE] – Jump If Less
Than (signed numbers)</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JLE [JNG] – Jump If Less Than
Or Equal To (signed numbers)</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JA [JNBE] – Jump If Above
(unsigned numbers)</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JNB [JAE] – Jump If Not
Below (unsigned numbers)</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JB [JNAE] – Jump If Below
(unsigned numbers)</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JBE [JNA] – Jump If Below
Or Equal To (unsigned numbers)</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JS – Jump If Signed</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JNS – Jump If Not Signed</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">As you can see, we can make our jump based on a
variety of numerical things.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Each of these conditional jumps works just like the
JMP instruction:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JE <i><span style="font-style:italic">ADDRESS<o:p></o:p></span></i></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JNZ <i><span style="font-style:italic">ADDRESS<o:p></o:p></span></i></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JG <i><span style="font-style:italic">ADDRESS<o:p></o:p></span></i></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JGE <i><span style="font-style:italic">ADDRESS<o:p></o:p></span></i></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JL <i><span style="font-style:italic">ADDRESS<o:p></o:p></span></i></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JLE <i><span style="font-style:italic">ADDRESS<o:p></o:p></span></i></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JA <i><span style="font-style:italic">ADDRESS<o:p></o:p></span></i></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JBE <i><span style="font-style:italic">ADDRESS<o:p></o:p></span></i></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">And just like the JMP instruction, the address can be
given in any number of ways: from memory, directly, or through a register.<span style="mso-spacerun:yes">&nbsp; </span>They’ll all work.<span style="mso-spacerun:yes">&nbsp; </span>So now that you know what these conditional
jumps do, you need to know how to use them.<span style="mso-spacerun:yes">&nbsp;
</span>Conditional jumps are always preceded by a CMP or TEST statement.<span style="mso-spacerun:yes">&nbsp; </span>It is from this CMP or TEST statement that
the processor decides if a jump should or should not be taken.<span style="mso-spacerun:yes">&nbsp; </span>Thus program flow branches one way by
executing the jump, and the other way by not executing the jump<span style="mso-spacerun:yes">&nbsp; </span>Here is an example:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX, 14</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CMP EAX, 12</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JGE <i><span style="font-style:italic">ADDRESS</span></i></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We know what the MOV instruction does, it moves the
value 14 into EAX.<span style="mso-spacerun:yes">&nbsp; </span>Now we call the CMP
statement.<span style="mso-spacerun:yes">&nbsp; </span>We’re comparing with the
value 12.<span style="mso-spacerun:yes">&nbsp; </span>Let’s look at the jump below
it.<span style="mso-spacerun:yes">&nbsp; </span>This is a JGE jump, so we jump if
the CMP instruction was <i><span style="font-style:italic">greater than or
equal to</span></i>.<span style="mso-spacerun:yes">&nbsp; </span>Is 14 greater than
or equal to 12?<span style="mso-spacerun:yes">&nbsp; </span>It’s greater than, so we
take the jump.<span style="mso-spacerun:yes">&nbsp; </span>Here is another example:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX, 14</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EDX, 32</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CMP EAX, EDX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JGE <i><span style="font-style:italic">ADDRESS</span></i></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This time, we’re moving 14 into EAX and 32 into
EDX.<span style="mso-spacerun:yes">&nbsp; </span>Once more, we do a CMP instruction,
this time between EAX and EDX.<span style="mso-spacerun:yes">&nbsp; </span>Our jump
is a JGE instruction again, so we need to decide if 14 is greater than or equal
to 32.<span style="mso-spacerun:yes">&nbsp; </span>This time, it’s not, so we don’t
take the jump.<span style="mso-spacerun:yes">&nbsp; </span>If we switched the code
to:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX, 14</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EDX, 32</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CMP EAX, EDX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JL <i><span style="font-style:italic">ADDRESS</span></i></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…we would take the jump.<span style="mso-spacerun:yes">&nbsp; </span>Why?<span style="mso-spacerun:yes">&nbsp;
</span>Because we are now checking to see if 14 is less than 32.<span style="mso-spacerun:yes">&nbsp; </span>Since it is, we jump.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">A close analogy for CMP or TEST followed by a jump is
the IF..GOTO statement in BASIC.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now let’s look at the CALL instruction.<span style="mso-spacerun:yes">&nbsp; </span>CALL is a lot like JMP, except instead of
branching to other code, you are executing an inner procedure (a.k.a.
subroutine).<span style="mso-spacerun:yes">&nbsp; </span>Every CALL is always
unconditional, so you do not need CMP or TEST statements.<span style="mso-spacerun:yes">&nbsp; </span>A call looks like this…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CALL <i><span style="font-style:italic">ADDRESS</span></i></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">…and works similar to JMP.<span style="mso-spacerun:yes">&nbsp; </span>The address can be stored in just about
anything, and the CALL is always made.<span style="mso-spacerun:yes">&nbsp;
</span>The difference is that a CALL statement will save the address of the next
instruction on the stack, and use that saved address to return to that next
instruction when the inner procedure has completed its task.<span style="mso-spacerun:yes">&nbsp; </span>So if we had:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CALL <i><span style="font-style:italic">ADDRESS</span></i></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">ADD EAX, 4</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EDX, EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">all the instructions would execute.<span style="mso-spacerun:yes">&nbsp; </span>First, we would jump to the code at the CALL
instruction’s address.<span style="mso-spacerun:yes">&nbsp; </span>Once we finished
with it, though, we would jump back to the ADD EAX, 4 instruction and do
that.<span style="mso-spacerun:yes">&nbsp; </span>Then we’d do the MOV EDX, EAX
instruction.<span style="mso-spacerun:yes">&nbsp; </span>If this were a jump, we
would go to the address, but we wouldn’t come back to execute the rest of the
code.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">In order for a CALL statement to know when to return
to the address right after where it started, it needs a RETN, or return,
instruction.<span style="mso-spacerun:yes">&nbsp; </span>The RETN must always be in
the program flow of the section of code executed by A CALL, or you will crash
and burn hard.<span style="mso-spacerun:yes">&nbsp; </span>RETN has two forms:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">RETN</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">RETN {number}</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Both will take the code back to right after the CALL
statement was made.<span style="mso-spacerun:yes">&nbsp; </span>The difference is
what happens on the stack when the return occurs.<span style="mso-spacerun:yes">&nbsp; </span>A RETN by itself says, this inner procedure
doesn’t have any parameters.<span style="mso-spacerun:yes">&nbsp; </span>A RETN with
a number (always a multiple of 4) says, this inner procedure does have
parameters, and the number of parameters is the number after the RETN divided
by 4.<span style="mso-spacerun:yes">&nbsp; </span>That is because a CALL works a lot
like a PUSH, and a RETN works a lot like a POP, and these instructions handle
DWORD values exclusively.<span style="mso-spacerun:yes">&nbsp; </span>We call this
cleaning up the stack, as parameters are pushed onto the stack ahead of a call.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Parameters work like this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH [Arg2]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH [Arg1]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">CALL Inner_function_address</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">TEST EAX,EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><i style="mso-bidi-font-style:normal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-style:italic;mso-bidi-font-style:normal">Inner_function:<o:p></o:p></span></font></i></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,DWORD PTR [ESP+4]<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; Arg1</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV ECX,DWORD PTR [ESP+8]<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; Arg2</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">{do something and return
a value in EAX}</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">RETN 8</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s analyze what is happening here.<span style="mso-spacerun:yes">&nbsp; </span>Parameters are PUSHed onto the stack in
reverse order.<span style="mso-spacerun:yes">&nbsp; </span>So if the stack pointer
[ESP] is pointing to address 0012F000 when we begin, after the call is executed
we will have this stack:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0012EFF4:<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{return address}<span style="mso-tab-count:
1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></font><font face="Wingdings"><span style="font-family:
Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;mso-hansi-font-family:&quot;Times New Roman&quot;;
mso-char-type:symbol;mso-symbol-font-family:Wingdings"><span style="mso-char-type:
symbol;mso-symbol-font-family:Wingdings">ß</span></span></font> ESP points here
now</p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0012EFF8:<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Arg1</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">0012EFFC:<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Arg2</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now after the inner function is complete, the RETN
looks at 0012EFF8 and gets the address of the instruction immediately following
the CALL, which in this case is TEST&nbsp;EAX,EAX.<span style="mso-spacerun:yes">&nbsp; </span>But we need ESP to point to 0012F000, and a
RETN by itself only moves the stack pointer by 4.<span style="mso-spacerun:yes">&nbsp; </span>So the value 8 after the RETN says, move the
stack pointer up an additional 8 bytes, and we have returned to where we began
at last.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Here is an Ollydbg example of a parameter-based CALL
in Diablo II from d2game.dll:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1047" type="#_x0000_t75"
 style='width:350.25pt;height:67.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image043.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="467" height="90" src="./Diablo II v1_files/image044.jpg" v:shapes="_x0000_i1047"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">In this example, there are two PUSHes ahead of the
CALL.<span style="mso-spacerun:yes">&nbsp; </span>They do not need to follow each
other immediately, the stack takes care of their association with the
CALL.<span style="mso-spacerun:yes">&nbsp; </span>If there are a lot of steps in
between, you may have to work at keeping track of what belongs with what.<span style="mso-spacerun:yes">&nbsp; </span>It is especially confusing if there is a CALL
in front of the call that actually receives the parameters you are
following!<span style="mso-spacerun:yes">&nbsp; </span>We will discuss CALLs in
Diablo II in much more detail later on.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The next instruction we’re going to look at is the NOP
instruction.<span style="mso-spacerun:yes">&nbsp; </span>This stands for no
operation, and does exactly that; nothing.<span style="mso-spacerun:yes">&nbsp;
</span>The instruction looks like this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">NOP</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Amazing, huh?<span style="mso-spacerun:yes">&nbsp;
</span>NOP statements can be very useful when we need extra code space to fit
our own modifications in.<span style="mso-spacerun:yes">&nbsp; </span>They’re also
very useful when we need to remove/nullify a section of code.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">When pointing to memory, we do not have to explicitly
state the location.<span style="mso-spacerun:yes">&nbsp; </span>Our pointer
references can be simple formulas themselves:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">DWORD PTR DS:[EAX]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">DWORD PTR DS:[EAX + 6C]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">DWORD PTR DS:[EAX + 4*
EDX]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">DWORD PTR DS:[EAX + EDX -
40]</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">A common use of the last form is to reference data
from a table.<span style="mso-spacerun:yes">&nbsp; </span>One register might contain
the base address of the entire table, another register might contain the record
size times an index number (called the record offset), and the constant would
be the number of bytes to a particular field.<span style="mso-spacerun:yes">&nbsp;
</span>We will see a lot of this form, and discuss it in detail later.<br clear="all" style="page-break-before:always">
The last instruction I will mention is the LEA instruction.<span style="mso-spacerun:yes">&nbsp; </span>This one can confuse even experienced coders,
so be aware of its peculiarities when you look at Diablo II code.<span style="mso-spacerun:yes">&nbsp; </span>LEA stands for Load Effective Address, and it
is a way of calculating memory locations directly, using formula-based pointer
references as shown above.<span style="mso-spacerun:yes">&nbsp; </span>But due to a
peculiarity of Intel processors, it can also be used for making very fast
specific multiplications.<span style="mso-spacerun:yes">&nbsp; </span>So when you
see instructions like</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">LEA EAX,DWORD PTR
DS:[EAX+EAX*4]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">LEA EAX,DWORD PTR
DS:[EAX+ECX*8+4]</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">you could very likely be looking at the equivalent of
“EAX = EAX * 5” or “EAX = ECX * 8 + 4”.<span style="mso-spacerun:yes">&nbsp;
</span>The standard form is [register1 + register2 * number1 + number2] where
register1 may not exist at all, register2 can be the same as register1, number1
is 2, 4 or 8 (or there is no multiplier shown for register2 and it is
implicitly 1) and number2 can be any value or not present.<span style="mso-spacerun:yes">&nbsp; </span>The reason these show up so often in the code
is because you cannot get a faster answer when you want to multiply by 3, 5 or
9, than to use this instruction.<span style="mso-spacerun:yes">&nbsp; </span>And the
second form shown is very fast for locating data in tables with very small
record sizes (1, 2, 4 or 8 bytes), where number2 is the field offset.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">While this hasn’t been a full, in-depth explanation on
assembly, it should be enough to get you started.<span style="mso-spacerun:yes">&nbsp; </span>You may find that some of the discussion
about instructions is simplified if you study assembly language further, but
that is because it takes too much detail and time to go into exactly how
everything works.<span style="mso-spacerun:yes">&nbsp; </span>What you have read
here is enough to begin navigating through Diablo II code.<span style="mso-spacerun:yes">&nbsp; </span>If you are interested in learning more assembly,
search the Web for tutorials and examples.<span style="mso-spacerun:yes">&nbsp;
</span>There are many flavors of assembly language, one for each processor
family in fact, so be sure to specify Intel, Pentium or P4 in your search.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">One resource worth mentioning specifically is the
Intel IA-32 Architectures Software Developer's Manuals (isn’t that a
mouthful?).<span style="mso-spacerun:yes">&nbsp; </span>Thes manuals will tell you
more than you ever wanted to know about the processors, the complete assembly
language instruction set, and how it all works together.<span style="mso-spacerun:yes">&nbsp; </span>What they will NOT do is teach you how to
make a program out of them.<span style="mso-spacerun:yes">&nbsp; </span>I mention
the Pentium4 manuals here, but the basic instructions haven’t changed since the
first 32-bit processor made its debut. </span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<h2><u><font size="3" color="white" face="Times New Roman"><span style="font-size:
12.0pt">Intel’s Assembly Guides</span></font></u><span style="text-decoration:
none;text-underline:none"> (get Volumes 2A and 2B)</span></h2>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><a href="http://developer.intel.com/products/processor/manuals/index.htm">http://developer.intel.com/products/processor/manuals/index.htm</a></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">If you want to know more about how the Intel processor
behaves internally, Volumes 1 and 3 can be worth reading.<span style="mso-spacerun:yes">&nbsp; </span>But they don’t explain any assembly
instructions.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<h1><b><font size="5" color="yellow" face="Times New Roman"><span style="font-size:
16.0pt;mso-bidi-font-size:12.0pt;color:yellow">The OllyDbg
Assembler/Dissassembler<o:p></o:p></span></font></b></h1>

<p class="MsoNormal"><font size="3" color="black" face="Times New Roman"><span style="font-size:12.0pt;color:windowtext"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now that we know some basic assembly, lets take a look
at the assembly code inside one of the Diablo II DLLs.<span style="mso-spacerun:yes">&nbsp; </span>To do this, we’re going to use OllyDbg.<span style="mso-spacerun:yes">&nbsp; </span>This program has a number of features, and
the Assembler/Dissassembler is just one of them.<span style="mso-spacerun:yes">&nbsp; </span>Because of this, I’ll be showing you the
OllyDbg interface a bit at a time rather than all at once like with XVI32.<span style="mso-spacerun:yes">&nbsp; </span>So let’s start OllyDbg and see what we have:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1048" type="#_x0000_t75"
 style='width:431.25pt;height:279.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image045.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="575" height="373" src="./Diablo II v1_files/image046.jpg" v:shapes="_x0000_i1048"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You should see something similar to this.<span style="mso-spacerun:yes">&nbsp; </span>Depending on what options you may have set,
OllyDbg might begin with a number of blank windows in the gray area, we will
ignore them for now.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s take care of one detail that will make reading
code much easier for us: window appearance.<span style="mso-spacerun:yes">&nbsp;
</span>Ollydbg “out of the box” shows black text on a yellow background.<span style="mso-spacerun:yes">&nbsp; </span>But we want to readily distinguish parts of
an instruction, or one type of instruction from another, so we will select one
of the prepackaged color schemes.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Start by clicking on Options and choosing Appearance:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1049" type="#_x0000_t75"
 style='width:300pt;height:104.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image047.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="400" height="139" src="./Diablo II v1_files/image048.jpg" v:shapes="_x0000_i1049"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now pick the Defaults tab.<span style="mso-spacerun:yes">&nbsp; </span>Go to Default syntax highlighting and choose
Christmas tree from the dropdown list.<span style="mso-spacerun:yes">&nbsp;
</span>Further customization is possible with the Code Highlighting tab, but we
won’t discuss it in this tutorial.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1050" type="#_x0000_t75"
 style='width:358.5pt;height:294pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image049.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="478" height="392" src="./Diablo II v1_files/image050.jpg" v:shapes="_x0000_i1050"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Code samples included in this tutorial come from a
slightly modified Christmas Tree appearance.<span style="mso-spacerun:yes">&nbsp;
</span>Whether or not your screen colors look a bit different than the ones
here, the content is what matters.<span style="mso-spacerun:yes">&nbsp; </span>So
let’s go on to said content, and for that we need to see some code.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">To access the Assembler/Dissassembler, you want to go
to “View” then go towards the bottom and select “File”.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1051" type="#_x0000_t75"
 style='width:6in;height:279.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image051.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="373" src="./Diablo II v1_files/image052.jpg" v:shapes="_x0000_i1051"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This will bring up a familiar dialog box, which you
can use to open a file.<span style="mso-spacerun:yes">&nbsp; </span>Let’s open up
D2Common.dll (v1.11b) and get a look at that.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1052" type="#_x0000_t75"
 style='width:6in;height:283.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image053.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="378" src="./Diablo II v1_files/image054.jpg" v:shapes="_x0000_i1052"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This certainly doesn’t look like assembly.<span style="mso-spacerun:yes">&nbsp; </span>In fact, it looks a lot like what we saw in
XVI32.<span style="mso-spacerun:yes">&nbsp; </span>This is completely true.<span style="mso-spacerun:yes">&nbsp; </span>OllyDbg is also a hex editor (I told you it
could do a lot of things).<span style="mso-spacerun:yes">&nbsp; </span>There are a
number of ways to view a file, and hex is one of them.<span style="mso-spacerun:yes">&nbsp; </span>Assembly code is another.<span style="mso-spacerun:yes">&nbsp; </span>So let’s learn how to change views.<span style="mso-spacerun:yes">&nbsp; </span>Right click, and you’ll get following menu:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1053" type="#_x0000_t75"
 style='width:6in;height:283.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image055.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="378" src="./Diablo II v1_files/image056.jpg" v:shapes="_x0000_i1053"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">I won’t go through the entire menu, but these are the
important ones.<span style="mso-spacerun:yes">&nbsp; </span>“Search for” will allow
you to search for a binary string, an assembly command, an address, or some
other things.<span style="mso-spacerun:yes">&nbsp; </span>It depends on what view
mode you are in.<span style="mso-spacerun:yes">&nbsp; </span>“Save file” will allow
you to save the file.<span style="mso-spacerun:yes">&nbsp; </span>“Go to offset” is
just like the “Goto…” option in XVI32.<span style="mso-spacerun:yes">&nbsp;
</span>It will bring up a window where you enter the offset to go to and it
takes you there.<span style="mso-spacerun:yes">&nbsp; </span>Below those are the
view modes.<span style="mso-spacerun:yes">&nbsp; </span>“Hex” will allow you to
choose from a few different hex editor displays, including the one we’re in.<span style="mso-spacerun:yes">&nbsp; </span>“Text” will allow you to display only
strings, which is the data to the right. <span style="mso-spacerun:yes">&nbsp;</span>You’ll notice the “This program cannot be run
in DOS mode.” string again.<span style="mso-spacerun:yes">&nbsp; </span>“Short”
doesn’t really matter, and you’ll probably never use it.<span style="mso-spacerun:yes">&nbsp; </span>“Long” has the very useful “Address” display
mode, which I’ll explain later.<span style="mso-spacerun:yes">&nbsp; </span>Next is
“Float”, which we can ignore just like “Short”.<span style="mso-spacerun:yes">&nbsp;
</span>Then we get to “Disassemble”, which is what we really want to do.<span style="mso-spacerun:yes">&nbsp; </span>After that is “Special”, which contains the
option to view PE header information.<span style="mso-spacerun:yes">&nbsp; </span>So
let’s choose “Disassemble” and see what we get.<span style="mso-spacerun:yes">&nbsp;
</span>We will call this method of disassembly “file disassembly mode.”<span style="mso-spacerun:yes">&nbsp; </span>The meaning will become clearer later.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1054" type="#_x0000_t75"
 style='width:6in;height:283.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image057.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="378" src="./Diablo II v1_files/image058.jpg" v:shapes="_x0000_i1054"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You might recognize the DEC instruction, the POP
instruction, the ADD instructions, and even a MOV and a NOP instruction in
there.<span style="mso-spacerun:yes">&nbsp; </span>However, there’s that strange
“????” and all of the ADD instructions are a little odd looking.<span style="mso-spacerun:yes">&nbsp; </span>This is because what we’re viewing isn’t
actually meant for assembly.<span style="mso-spacerun:yes">&nbsp; </span>There are
lots of things a DLL file, and assembly code is just one of them.<span style="mso-spacerun:yes">&nbsp; </span>What we’re seeing is called a PE header, and
if you want to get a better look at it you should go to “Special” view and
choose the “PE Header” option.<span style="mso-spacerun:yes">&nbsp; </span>We don’t
really care about that, though.<span style="mso-spacerun:yes">&nbsp; </span>Let’s
head to some code.<span style="mso-spacerun:yes">&nbsp; </span>Go to offset
72E67.<span style="mso-spacerun:yes">&nbsp; </span>You should see this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1055" type="#_x0000_t75"
 style='width:6in;height:199.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image059.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="266" src="./Diablo II v1_files/image060.jpg" v:shapes="_x0000_i1055"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now this looks more like assembly.<span style="mso-spacerun:yes">&nbsp; </span>You should be able to recognize almost all of
the instructions.<span style="mso-spacerun:yes">&nbsp; </span>This particular
sequence of code is that part that determines the gamble cost for an item, that
we referred to in the discussion about hex editors.<span style="mso-spacerun:yes">&nbsp; </span>The highlighted line is comparing the value
of register EAX to a constant, but in this particular application the constant
is a reverse ASCII representation of the three-letter code for rings (always
padded with a space).<span style="mso-spacerun:yes">&nbsp; </span>Why reverse?<span style="mso-spacerun:yes">&nbsp; </span>Remember from our discussion of hex editing
with XVI32 that Intel designed their processors to read words and dwords in
“little-endian” format, where the least significant byte is at the left and the
most significant byte is at the right.<span style="mso-spacerun:yes">&nbsp;
</span>So the equivalent string is “ nir” instead of “rin “.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Look down at line 72E74, this is the actual code we
changed when we were exploring with XVI32.<span style="mso-spacerun:yes">&nbsp;
</span>In the second column we see the same six bytes we looked for with the
hex editor.<span style="mso-spacerun:yes">&nbsp; </span>In the third column we see
the equivalent assembly language instruction, JE&nbsp;00072FF0.<span style="mso-spacerun:yes">&nbsp; </span>We recognize this is a Jump if Equal.<span style="mso-spacerun:yes">&nbsp; </span>So this code says, if I have a ring then I
jump to the target offset 00072FF0.<span style="mso-spacerun:yes">&nbsp; </span>(In
file disassembly mode all targets are file offsets.)<span style="mso-spacerun:yes">&nbsp; </span>Look past this jump and you will see a
similar test for amulets. </span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now we want to make all items use the Gamble Cost
field just like rings and amulets.<span style="mso-spacerun:yes">&nbsp; </span>We
want to make the conditional jump into an unconditional jump.<span style="mso-spacerun:yes">&nbsp; </span>So we need to assemble the new
instruction.<span style="mso-spacerun:yes">&nbsp; </span>Our new code should look
like this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JMP 00072FF0</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">To change this, make sure you have the
JE&nbsp;00072FF0 line highlighted in gray.<span style="mso-spacerun:yes">&nbsp;
</span>Then right click and choose “Assemble” from the popup menu.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1056" type="#_x0000_t75"
 style='width:431.25pt;height:279.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image061.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="575" height="373" src="./Diablo II v1_files/image062.jpg" v:shapes="_x0000_i1056"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This brings up OllyDbg’s assembler screen, where you
can enter in the command you want to do.<span style="mso-spacerun:yes">&nbsp;
</span>You’ll notice it starts with the command we have highlighted.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1057" type="#_x0000_t75"
 style='width:315.75pt;height:119.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image063.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="421" height="159" src="./Diablo II v1_files/image064.jpg" v:shapes="_x0000_i1057"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Just edit the JE to JMP and hit the “Assemble” button,
and the code will change.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1058" type="#_x0000_t75"
 style='width:315.75pt;height:120pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image065.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="421" height="160" src="./Diablo II v1_files/image066.jpg" v:shapes="_x0000_i1058"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">As you can see, the assembler screen stays open, but
our code has indeed changed.<span style="mso-spacerun:yes">&nbsp; </span>When you’re
finished with the assembler screen, just hit “Cancel” and it will close.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1059" type="#_x0000_t75"
 style='width:317.25pt;height:118.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image067.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="423" height="158" src="./Diablo II v1_files/image068.jpg" v:shapes="_x0000_i1059"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">What about that NOP line which is currently
highlighted?<span style="mso-spacerun:yes">&nbsp; </span>Where did that come
from?<span style="mso-spacerun:yes">&nbsp; </span>OllyDbg is smart about assembling
instructions and clears any excess bytes with one or more NOP
instructions.<span style="mso-spacerun:yes">&nbsp; </span>The conditional jump we
replaced uses six bytes, but the unconditional jump uses only five bytes.<span style="mso-spacerun:yes">&nbsp; </span>(This is why the hex edit exercise had the
‘90’ byte at the end, it is the extra byte.)</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You can get into trouble if you aren’t careful.<span style="mso-spacerun:yes">&nbsp; </span>OllyDbg does not ask if you want to overwrite
bytes in the next instruction.<span style="mso-spacerun:yes">&nbsp; </span>So if you
had been changing an unconditional jump to a conditional jump, you would have
stolen the first byte from the next instruction (which we didn’t want to
change), and OllyDbg would have cheerfully changed the rest of the bytes to
NOPs.<span style="mso-spacerun:yes">&nbsp; </span>But do not fear, there is an Undo
Selection command on the right-click menu!<span style="mso-spacerun:yes">&nbsp;
</span>Select the instructions you need to undo and use the command to reset to
the last saved coding.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">If you want to save this change, right click to get the
popup menu and choose Save File.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1060" type="#_x0000_t75"
 style='width:431.25pt;height:258.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image069.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="575" height="345" src="./Diablo II v1_files/image070.jpg" v:shapes="_x0000_i1060"><!--[endif]--><span style="mso-spacerun:yes">&nbsp;</span></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We’ve now changed the conditional jump to an
unconditional jump, and now all items will use the Gamble Cost field just like
rings and amulets originally did.<span style="mso-spacerun:yes">&nbsp; </span>It was
as simple as that.<span style="mso-spacerun:yes">&nbsp; </span>Of course, this is
the most basic of assembly changes, and we did it more to introduce you to
OllyDbg than to learn complicated assembly.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<h1><b><font size="5" color="yellow" face="Times New Roman"><span style="font-size:
16.0pt;mso-bidi-font-size:12.0pt;color:yellow">The OllyDbg Debugger<o:p></o:p></span></font></b></h1>

<p class="MsoNormal"><font size="3" color="black" face="Times New Roman"><span style="font-size:12.0pt;color:windowtext"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Although we can use OllyDbg for assembly and
disassembly, we will use it a whole lot more for it’s debugging capabilities.<span style="mso-spacerun:yes">&nbsp; </span>The debugger potion of OllyDbg will allow us
to follow the lines of code in the Diablo II program as they are executed.<span style="mso-spacerun:yes">&nbsp; </span>It will show us the values in all of the
registers and stack as well.<span style="mso-spacerun:yes">&nbsp; </span>This is how
you can track down what locations of code do what.<span style="mso-spacerun:yes">&nbsp; </span>Before we can go code hunting, though, we
need to understand how the debugger works.<span style="mso-spacerun:yes">&nbsp;
</span>We start by opening up OllyDbg once again:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1061" type="#_x0000_t75"
 style='width:431.25pt;height:279.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image045.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="575" height="373" src="./Diablo II v1_files/image046.jpg" v:shapes="_x0000_i1061"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">In debugger mode, it is best to make OllyDbg run in
full screen.<span style="mso-spacerun:yes">&nbsp; </span>There is a lot to display,
and the full screen keeps the workspace from getting cramped.<span style="mso-spacerun:yes">&nbsp; </span>So click on the Maximize button and let’s get
to work.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Alt-Tab to Windows and start Diablo II.<span style="mso-spacerun:yes">&nbsp; </span>You should start Diablo II in windowed mode
because you’ll be switching between it and OllyDbg quite a bit.<span style="mso-spacerun:yes">&nbsp; </span>You can do this by adding “-w” to the command
line.<span style="mso-spacerun:yes">&nbsp; </span>When the game comes up in the
reduced window,<span style="mso-spacerun:yes">&nbsp; </span>start a single player
game and wait for the character to appear in the current town.<span style="mso-spacerun:yes">&nbsp; </span>This is necessary, because the three DLLs we
are most interested in do not load that the very beginning.<span style="mso-spacerun:yes">&nbsp; </span>They are loaded only when you first enter a
game.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Once Diablo II is running, we need to attach OllyDbg
to it.<span style="mso-spacerun:yes">&nbsp; </span>We do this using the “Attach”
option in the “File” menu.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1062" type="#_x0000_t75"
 style='width:431.25pt;height:258.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image071.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="575" height="345" src="./Diablo II v1_files/image072.jpg" v:shapes="_x0000_i1062"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This brings up a list of the currently running
processes on your computer.<span style="mso-spacerun:yes">&nbsp; </span>Depending on
how many Windows components and other programs you have running, this can be
quite a list, but the one we’re interested in is Diablo II.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1063" type="#_x0000_t75"
 style='width:431.25pt;height:258pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image073.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="575" height="344" src="./Diablo II v1_files/image074.jpg" v:shapes="_x0000_i1063"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">If you are running Diablo II v11.0 or later, you will
see a popup like the one below.<span style="mso-spacerun:yes">&nbsp; </span>Click OK
and ignore it.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1064" type="#_x0000_t75"
 style='width:6in;height:86.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image075.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="115" src="./Diablo II v1_files/image076.jpg" v:shapes="_x0000_i1064"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Next you should see a single window with many
different sections.<span style="mso-spacerun:yes">&nbsp; </span>We’ll start by
examining this window, then we’ll open a few others and look at those ones,
too.<span style="mso-spacerun:yes">&nbsp; </span>The window is called the CPU
Window, and you can see a big C in the upper left.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1065" type="#_x0000_t75"
 style='width:431.25pt;height:318.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image077.png" o:title="Image023"/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="575" height="425" src="./Diablo II v1_files/image078.jpg" v:shapes="_x0000_i1065"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">As you can see, this window displays almost everything
we talked about in the Basic Assembly section.<span style="mso-spacerun:yes">&nbsp;
</span>First, we have the program’s code.<span style="mso-spacerun:yes">&nbsp;
</span>We can follow this step by step as the program executes if we want.<span style="mso-spacerun:yes">&nbsp; </span>I’ll explain how later. <span style="mso-spacerun:yes">&nbsp;</span>We can also see the values of the program’s
registers.<span style="mso-spacerun:yes">&nbsp; </span>You should recognize each of
them from the Basic Assembly section.<span style="mso-spacerun:yes">&nbsp; </span>We
can also see the program’s stack.<span style="mso-spacerun:yes">&nbsp; </span>The
“top” of the stack is highlighted.<span style="mso-spacerun:yes">&nbsp; </span>I say
“top” because you may notice that there are certain pieces of code that can
change the location of the top of the stack.<span style="mso-spacerun:yes">&nbsp;
</span>Finally, we see a dump of some of the program’s memory.<span style="mso-spacerun:yes">&nbsp; </span>The first part is the address/location and
the second part is the value.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now let’s open up another important window, the executable
modules window.<span style="mso-spacerun:yes">&nbsp; </span>This window can be
opened by going to the “View” menu and choosing “Executable Modules”.<span style="mso-spacerun:yes">&nbsp; </span>But the easy way is to select the E button on
the toolbar:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1066" type="#_x0000_t75"
 style='width:411.75pt;height:51pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image079.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="549" height="68" src="./Diablo II v1_files/image080.jpg" v:shapes="_x0000_i1066"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">When you attach a debugger to a process, the debugger
will keep track of every program module that is required to maintain the
process.<span style="mso-spacerun:yes">&nbsp; </span>This will consist of the
program executable, its DLLs, active Windows components, and monitoring
components from guardian programs such as anti-virus and anti-spyware.<span style="mso-spacerun:yes">&nbsp; </span>You can sort this table by clicking on the
column header, so let’s group all Diablo II modules by clicking on the Path
column header.<span style="mso-spacerun:yes">&nbsp; </span>The example below is for
D2 v1.11b.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1067" type="#_x0000_t75"
 style='width:6in;height:171.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image081.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="229" src="./Diablo II v1_files/image082.jpg" v:shapes="_x0000_i1067"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You may remember at the beginning of this tutorial
there is a list of DLL versions.<span style="mso-spacerun:yes">&nbsp; </span>Here
you can find the three DLLs from that table: D2Client.dll, D2Common.dll and
D2Game.dll.<span style="mso-spacerun:yes">&nbsp; </span>The last column in that
table is labeled “Image Base” and has some hex numbers.<span style="mso-spacerun:yes">&nbsp; </span>Now look at the leftmost column on this
screen labeled “Base”.<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>Let’s compare
the numbers from this screen (middle column below) to the Image Base values
(right column below).</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">D2Client.dll<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>6FAB0000<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>6FAB0000<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">D2Common.dll<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>6FD50000<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>6FD50000<o:p></o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="2" color="white" face="Courier"><span style="font-size:10.0pt;font-family:Courier">D2Game.dll<span style="mso-tab-count:2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>04900000<span style="mso-tab-count:1">&nbsp;&nbsp;&nbsp; </span>6FC20000<o:p></o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">D2Client and D2Common match, but D2Game has a
different base than expected!<span style="mso-spacerun:yes">&nbsp; </span>This is known
as a relocation.<span style="mso-spacerun:yes">&nbsp; </span>Windows will move
around any module that is too big to fit in available space when attempting to
load at the image base.<span style="mso-spacerun:yes">&nbsp; </span>This is the
major reason why code you examine in the debugger may not quite match code you
may read about in the Code Editing Forum.<span style="mso-spacerun:yes">&nbsp;
</span>Relocated DLLs do not always end up in the same place!.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Next, we’re going to look at the breakpoints
window.<span style="mso-spacerun:yes">&nbsp; </span>This one is opened by going to
“View” and choosing “Breakpoints”, or by clicking on the B toolbar button.<span style="mso-spacerun:yes">&nbsp; </span>It looks like this:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1068" type="#_x0000_t75"
 style='width:6in;height:165.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image083.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="221" src="./Diablo II v1_files/image084.jpg" v:shapes="_x0000_i1068"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">It starts empty, but we’ll be using it a lot later, so
make sure you have it open.<span style="mso-spacerun:yes">&nbsp; </span>The
information is broken up into columns, but it doesn’t make much sense until we
have a breakpoint to use as an example.<span style="mso-spacerun:yes">&nbsp;
</span>So let’s just skip that for later.<span style="mso-spacerun:yes">&nbsp;
</span>The final window is the run trace window.<span style="mso-spacerun:yes">&nbsp; </span>Like the others, this is under “View” and the
menu choice is called “Run Trace”.<span style="mso-spacerun:yes">&nbsp; </span>Or
you can hit the ellipsis button (three periods) on the toolbar.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1069" type="#_x0000_t75"
 style='width:6in;height:221.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image085.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="295" src="./Diablo II v1_files/image086.jpg" v:shapes="_x0000_i1069"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Like the breakpoint window, this one doesn’t have
anything at the moment.<span style="mso-spacerun:yes">&nbsp; </span>We’ll be using
it a lot later, though, so we should have it open. </span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You may have noticed that the code in the window with
the assembly isn’t moving.<span style="mso-spacerun:yes">&nbsp; </span>You may also
have noticed that if you tried to click on Diablo II, it appears to be
frozen.<span style="mso-spacerun:yes">&nbsp; </span>This is because the program is
currently paused.<span style="mso-spacerun:yes">&nbsp; </span>You can tell if the
program is paused by looking at the status bar in the bottom right.<span style="mso-spacerun:yes">&nbsp; </span>You’ll notice it says “Paused” in nice red
letters, as shown below.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><b style="mso-bidi-font-weight:normal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-weight:
bold;mso-bidi-font-weight:normal"><!--[if gte vml 1]><v:shape id="_x0000_i1070"
 type="#_x0000_t75" style='width:135pt;height:45.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image087.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="180" height="61" src="./Diablo II v1_files/image088.jpg" v:shapes="_x0000_i1070"><!--[endif]--><o:p></o:p></span></font></b></p>

<b style="mso-bidi-font-weight:normal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;color:white;mso-ansi-language:EN-US;
mso-fareast-language:EN-US;mso-bidi-language:AR-SA;font-weight:bold;mso-bidi-font-weight:
normal"><br clear="all" style="page-break-before:always">
</span></font></b>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">To start the program we can use the “Debug” menu.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1071" type="#_x0000_t75"
 style='width:207.75pt;height:332.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image089.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="277" height="443" src="./Diablo II v1_files/image090.jpg" v:shapes="_x0000_i1071"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">As you can see, I’ve circled a number of options.<span style="mso-spacerun:yes">&nbsp; </span>This is because each of these options is a
way to run the program and they all run the program differently.<span style="mso-spacerun:yes">&nbsp; </span>Let’s go through them, starting with “Run”.<span style="mso-spacerun:yes">&nbsp; </span></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">If you choose “Run” the program will begin running
again and OllyDbg WON’T run along with it.<span style="mso-spacerun:yes">&nbsp;
</span>This means it won’t follow code in the assembly window or change the
registers in the register window or any of that.<span style="mso-spacerun:yes">&nbsp; </span>This is how you’ll usually be running Diablo
II because we don’t want to know each and everything that Diablo II does.<span style="mso-spacerun:yes">&nbsp; </span>Doing so slows the program down an
unbelievable amount and usually results in the program terminating
unexpectedly.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The next two options, “Step into” and “Step over” are
very similar.<span style="mso-spacerun:yes">&nbsp; </span>They both execute and
follow the current line of code and then pause again.<span style="mso-spacerun:yes">&nbsp; </span>They’re good if you want to examine the
changes in the stack or the registers very carefully.<span style="mso-spacerun:yes">&nbsp; </span>The difference is when it comes to CALL
statements.<span style="mso-spacerun:yes">&nbsp; </span>Remember that CALL
statements take you to another part of code and execute it.<span style="mso-spacerun:yes">&nbsp; </span>If you choose “Step into” you’ll go to the
first line of that new code and stop there.<span style="mso-spacerun:yes">&nbsp;
</span>This is why it is called “Step <b><span style="font-weight:bold">into</span></b>”,
because you go <b><span style="font-weight:bold">into</span></b> the call.<span style="mso-spacerun:yes">&nbsp; </span>“Step <b><span style="font-weight:bold">over</span></b>”
therefore steps <b><span style="font-weight:bold">over</span></b> the CALL.<span style="mso-spacerun:yes">&nbsp; </span>It doesn’t really go over it, but instead it
executes all of the statements in the CALL before stopping.<span style="mso-spacerun:yes">&nbsp; </span>Then it stops on the statement right after
the CALL.<span style="mso-spacerun:yes">&nbsp; </span>This is good if you want to
skip over a pointless or long CALL statement.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The two options after this are “Animate into” and
“Animate over”.<span style="mso-spacerun:yes">&nbsp; </span>The difference between
these two is the same as the difference between “Step into” and “Step
over”.<span style="mso-spacerun:yes">&nbsp; </span>One goes into the CALL and the
other goes over it.<span style="mso-spacerun:yes">&nbsp; </span>These both differ
from the step choices because they continue to execute and follow code non-stop
until they reach a breakpoint or the program closes.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The final choice is “Execute till return”.<span style="mso-spacerun:yes">&nbsp; </span>This is useful if you want to see into the
code of a CALL, but not follow it through for every step.<span style="mso-spacerun:yes">&nbsp; </span>This will execute and follow code until it
reaches a RETN instruction for the current procedure.<span style="mso-spacerun:yes">&nbsp; </span>It will also stop when the program closes or
it reaches a breakpoint.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Of all the options, you’ll be using “Run”, “Animate
into”, and “Animate over” the most often.<span style="mso-spacerun:yes">&nbsp;
</span>Your question now is probably, “If ‘Run’ doesn’t follow the code, then
how do I get OllyDbg to stop at a particular spot?”.<span style="mso-spacerun:yes">&nbsp; </span>Remember that you’ll be using “Run” to run
Diablo II most of the time otherwise it will go to slow for you to do anything
and it will probably crash.<span style="mso-spacerun:yes">&nbsp; </span>The answer
to the question is to use breakpoints.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">As the name implies, breakpoints cause the program to
pause (break) when it comes across the breakpoint code.<span style="mso-spacerun:yes">&nbsp; </span>There are several types of breakpoints in
Ollydbg.<span style="mso-spacerun:yes">&nbsp; </span>The three we will use the most
are unconditional breakpoints, conditional breakpoints, and memory breakpoints.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<ol style="margin-top:0in" start="1" type="1">
 <li class="MsoNormal" style="mso-list:l2 level1 lfo3;tab-stops:list .5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">An
     unconditional breakpoint will stop the program in its tracks whenever the
     breakpoint is encountered.<span style="mso-spacerun:yes">&nbsp; </span>This is
     the simplest and most frequently used of the three.<span style="mso-spacerun:yes">&nbsp; </span>Pick an instruction in the disassembly
     pane and add a breakpoint.</span></font></li>
</ol>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<ol style="margin-top:0in" start="2" type="1">
 <li class="MsoNormal" style="mso-list:l2 level1 lfo3;tab-stops:list .5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">A
     conditional breakpoint is much like an unconditional breakpoint.<span style="mso-spacerun:yes">&nbsp; </span>But you can also specify what condition
     must be satisfied before the debugger will stop the program when this
     breakpoint is encountered.</span></font></li>
</ol>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<ol style="margin-top:0in" start="3" type="1">
 <li class="MsoNormal" style="mso-list:l2 level1 lfo3;tab-stops:list .5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">A
     memory breakpoint is a different breed altogether.<span style="mso-spacerun:yes">&nbsp; </span>This is used to find out whether a
     particular location is accessed, or written to.<span style="mso-spacerun:yes">&nbsp; </span>While the other breakpoints are applied to
     code in the disassembly pane, the memory breakpoint is applied to data in
     the dump pane at lower left.<span style="mso-spacerun:yes">&nbsp; </span>It is
     used to see what code accesses, or writes to, a memory location—very
     useful if you know the data but don’t know what function may reference it.</span></font></li>
</ol>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We will return to the other types of breakpoints
later.<span style="mso-spacerun:yes">&nbsp; </span>But for now we will work with
unconditional breakpoints.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s begin by setting a breakpoint at the same spot
we changed when we forced all items to use the Gamble Cost field in the txt
files.<span style="mso-spacerun:yes">&nbsp; </span>Your first impulse might be to try
to go to offset 72E74 like we did before.<span style="mso-spacerun:yes">&nbsp;
</span>If you try to, though, it won’t work.<span style="mso-spacerun:yes">&nbsp;
</span>This is because the offsets are different when the program is running.<span style="mso-spacerun:yes">&nbsp; </span>When the program is running there are a lot
of files that need to be loaded and a lot of them are going to have the same
offsets.<span style="mso-spacerun:yes">&nbsp; </span>Also, depending on how the
module is developed, you may start actual code in the file at offset 1000h or
at offset 0400h.<span style="mso-spacerun:yes">&nbsp; </span>(Remember the first part
of any module is the PE Header we mentioned earlier.)<span style="mso-spacerun:yes">&nbsp; </span>Regardless of which file offset is the start
of code, once the module is loaded into memory the memory offset to start of
code is always 1000h.<span style="mso-spacerun:yes">&nbsp; </span>So that file
offset of 72E74 will become memory address 6FDC3A74.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Look at the code at that memory address.<span style="mso-spacerun:yes">&nbsp; </span>Since we want to look at code in
D2Common.dll, we first select that module from the Executables table (E button
on the toolbar).<span style="mso-spacerun:yes">&nbsp; </span>You will see the first
line of executable code at the top, as shown below.<span style="mso-spacerun:yes">&nbsp; </span>Note we are at address 6FD51000, which is the
base address plus 1000h as said before.<span style="mso-spacerun:yes">&nbsp;
</span>Right-click somewhere on the code panel and choose the option Go To and
then Expression:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1072" type="#_x0000_t75"
 style='width:379.5pt;height:309pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image091.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="506" height="412" src="./Diablo II v1_files/image092.jpg" v:shapes="_x0000_i1072"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You will see the dialog box below.<span style="mso-spacerun:yes">&nbsp; </span>Enter the target address and click OK.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1073" type="#_x0000_t75"
 style='width:246.75pt;height:84pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image093.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="329" height="112" src="./Diablo II v1_files/image094.jpg" v:shapes="_x0000_i1073"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now you should see the code below.<span style="mso-spacerun:yes">&nbsp; </span>Let’s scroll up a few lines so we can see the
test for rings.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1074" type="#_x0000_t75"
 style='width:360.75pt;height:75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image095.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="481" height="100" src="./Diablo II v1_files/image096.jpg" v:shapes="_x0000_i1074"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The code may look familiar from before.<span style="mso-spacerun:yes">&nbsp; </span>It should, it’s the same code.<span style="mso-spacerun:yes">&nbsp; </span>But now notice the jump instruction itself
looks different.<span style="mso-spacerun:yes">&nbsp; </span>Instead of
JE&nbsp;00072FF0 you now have JE&nbsp;6FDC3BF0.<span style="mso-spacerun:yes">&nbsp;
</span>OllyDbg automatically fills in the target memory address when in debug
mode, rather than using the file offset address as when in file assembly
mode.<span style="mso-spacerun:yes">&nbsp; </span>This is a very powerful aid, as
now you see how you move around in a program exactly as the program itself does
when running.<span style="mso-spacerun:yes">&nbsp; </span>Now let’s make the change
we made before, so we choose the assembly command and see</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1075" type="#_x0000_t75"
 style='width:246.75pt;height:84pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image097.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="329" height="112" src="./Diablo II v1_files/image098.jpg" v:shapes="_x0000_i1075"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Note the target memory address is carried into the
dialog box.<span style="mso-spacerun:yes">&nbsp; </span>But all we want to do is, as
before, change the JE to JMP:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1076" type="#_x0000_t75"
 style='width:246.75pt;height:84pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image099.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="329" height="112" src="./Diablo II v1_files/image100.jpg" v:shapes="_x0000_i1076"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now click the Assemble button, and you will see your
change in the code window.<span style="mso-spacerun:yes">&nbsp; </span>The code you
changed appears in red:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1077" type="#_x0000_t75"
 style='width:369pt;height:109.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image101.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="492" height="146" src="./Diablo II v1_files/image102.jpg" v:shapes="_x0000_i1077"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Unlike with file assembly, you have changed the
program in memory, and as soon as you check in with your gambling vendor you
will see new prices which are not calculated from your character level.<span style="mso-spacerun:yes">&nbsp; </span>Changing code in debug mode is interactive
and immediately effective!<span style="mso-spacerun:yes">&nbsp; </span>Go ahead and
run the game (F9 key, or Debug menu Run option).<span style="mso-spacerun:yes">&nbsp; </span>Check out the gamble prices and you should
see the same values for the same base items, regardless of what your character
level is.<span style="mso-spacerun:yes">&nbsp; </span>For example, ring mail has
20177 in Armor.txt Gamble Cost, so the vendor better be offering it for 20177.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Enough of that, though.<span style="mso-spacerun:yes">&nbsp; </span>We want to place a breakpoint and see how
they work.<span style="mso-spacerun:yes">&nbsp; </span>You can do this by
highlighting a line of code and either right clicking and selecting
“Breakpoint” and then “Toggle” or you can just press F2.<span style="mso-spacerun:yes">&nbsp; </span>This is the same as using the menu.<span style="mso-spacerun:yes">&nbsp; </span>I recommend you get used to pressing F2
because you’ll use a lot of breakpoints.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1078" type="#_x0000_t75"
 style='width:6in;height:337.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image103.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="450" src="./Diablo II v1_files/image104.jpg" v:shapes="_x0000_i1078"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now that our breakpoint is set, we have two
indications of this.<span style="mso-spacerun:yes">&nbsp; </span>Our line of code
has a red mark to the very left and the breakpoint has appeared in the
breakpoints window.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1079" type="#_x0000_t75"
 style='width:358.5pt;height:80.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image105.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="478" height="107" src="./Diablo II v1_files/image106.jpg" v:shapes="_x0000_i1079"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1080" type="#_x0000_t75"
 style='width:6in;height:66pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image107.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="88" src="./Diablo II v1_files/image108.jpg" v:shapes="_x0000_i1080"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now we can take a better look at the breakpoints
window, since we have a breakpoint in it.<span style="mso-spacerun:yes">&nbsp;
</span>You can see that it shows the location of the breakpoint and also what
executable module it is in.<span style="mso-spacerun:yes">&nbsp; </span>Next you see
the column called “Active”.<span style="mso-spacerun:yes">&nbsp; </span>This says
“Always” because our breakpoint will always stop the program.<span style="mso-spacerun:yes">&nbsp; </span>Finally, it shows the code where we set the
breakpoint:<span style="mso-spacerun:yes">&nbsp; </span>JE&nbsp;6FDC3BF0.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">So let’s see how the breakpoint works.<span style="mso-spacerun:yes">&nbsp; </span>Go to your gambling vendor and choose the
Gamble task.<span style="mso-spacerun:yes">&nbsp; </span>The second you do, it seems
like Diablo II has frozen.<span style="mso-spacerun:yes">&nbsp; </span>Well, that
isn’t altogether incorrect.<span style="mso-spacerun:yes">&nbsp; </span>It has
paused because game execution hit the breakpoint we set.<span style="mso-spacerun:yes">&nbsp; </span>In fact, you will probably be kicked directly
into the OllyDbg screen with the instruction pointer resting on your
breakpoint.<span style="mso-spacerun:yes">&nbsp; </span>The red bar over the address
has changed to a black bar with red letters and the complete line will be
highlighted.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1081" type="#_x0000_t75"
 style='width:356.25pt;height:81.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image109.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="475" height="109" src="./Diablo II v1_files/image110.jpg" v:shapes="_x0000_i1081"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s take a close look at this line.<span style="mso-spacerun:yes">&nbsp; </span>Since it is a jump instruction, there will be
a line drawn between the jump itself and the target address.<span style="mso-spacerun:yes">&nbsp; </span>If the line is red, the jump will occur and
the next instruction executed will be the one at that target.<span style="mso-spacerun:yes">&nbsp; </span>If the line is gray, the jump will not occur,
and the next line down will be the next line executed.<span style="mso-spacerun:yes">&nbsp; </span>JMP instructions are unconditional, so they
will always show up as red lines.<span style="mso-spacerun:yes">&nbsp; </span>But if
we had left the original instruction alone, and we looked at anything other
than a ring, this line would be gray.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You will now be able to look at the stack and the
registers and see what their values are.<span style="mso-spacerun:yes">&nbsp;
</span>If you want, you can use the “Step into” and “Step over” choices a few
times just to get the hang of how it works.<span style="mso-spacerun:yes">&nbsp;
</span>You’ll notice that each time a register changes it becomes red.<span style="mso-spacerun:yes">&nbsp; </span>This makes it fairly easy to identify which
registers are probably being used for whatever function we’re doing.<span style="mso-spacerun:yes">&nbsp; </span>Some will change permanently while others
will end up back like they were at the start of the function because they’re
PUSHed onto the stack at the beginning and POPped from the stack at the
end.<span style="mso-spacerun:yes">&nbsp; </span>When you’re sick of playing around
with the “Step into” and “Step over” stuff, choose the “Run” option again and
go back to Diablo II.<span style="mso-spacerun:yes">&nbsp; </span>The game is now
running like normal again and the gamble price appears for the item.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s not worry about saving this change yet.<span style="mso-spacerun:yes">&nbsp; </span>For our next topic, we want to change the
code back to a conditional jump, so repeat the previous steps and edit JMP to
JE in the Assembly dialog.<span style="mso-spacerun:yes">&nbsp; </span>You will see
the NOP disappear, as we have gone from five bytes to six bytes needed for the
jump instruction.</span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now we’re going to look at using run traces, so set a
breakpoint at address 6FDC3A67.<span style="mso-spacerun:yes">&nbsp; </span>This is
where the item is checked to see if it is a ring.<span style="mso-spacerun:yes">&nbsp; </span>Once more the program freezes and we can go
to OllyDbg to see it at our breakpoint.<span style="mso-spacerun:yes">&nbsp;
</span>Before you do anything, though, go to the “Debug” menu and choose “Open or
clear run trace”.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1082" type="#_x0000_t75"
 style='width:204pt;height:328.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image111.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="272" height="438" src="./Diablo II v1_files/image112.jpg" v:shapes="_x0000_i1082"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You’ll notice that something has appeared in the run trace
window.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1083" type="#_x0000_t75"
 style='width:431.25pt;height:182.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image113.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="575" height="243" src="./Diablo II v1_files/image114.jpg" v:shapes="_x0000_i1083"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This is the line of code we’re currently stopped
at.<span style="mso-spacerun:yes">&nbsp; </span>With run trace, each time a line of
code is executed it will be added to the run trace window.<span style="mso-spacerun:yes">&nbsp; </span>This will let us go back and look at all the
code executed between two breakpoints or in some function.<span style="mso-spacerun:yes">&nbsp; </span>If you like, you use “Step into” and “Step
over” to see what happens.<span style="mso-spacerun:yes">&nbsp; </span>When you get
sick of that, you can choose the “Execute till return” option.<span style="mso-spacerun:yes">&nbsp; </span>Once you do, you’ll notice that the run trace
window fills up with lines of code and that you’re stopped at a RETN statement.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1084" type="#_x0000_t75"
 style='width:6in;height:182.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image115.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="576" height="243" src="./Diablo II v1_files/image116.jpg" v:shapes="_x0000_i1084"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Here we are testing an item with a certain three
letter code against a ring.<span style="mso-spacerun:yes">&nbsp; </span>The zero
flag is not set in line 6FDC3A67, so when we get to the JE 6FDC3BF0 at 6FDC3A74
we ignore the jump and continue to the next compare.<span style="mso-spacerun:yes">&nbsp; </span>This time the item is compared to an amulet
code, and the zero flag is set, so the item is an amulet.<span style="mso-spacerun:yes">&nbsp; </span>The JE 6FDC3BF0 at 6FDC3A7F is executed, and
the next line in the trace is the instruction at 6FDC3BF0.<span style="mso-spacerun:yes">&nbsp; </span>There EAX is loaded with a value (F618h =
63000), we restore a bunch of registers that were previously saved, and we RETN
to the code which called this procedure.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">What about that ADD ESP,14?<span style="mso-spacerun:yes">&nbsp; </span>Didn’t we say we should not mess with the
stack pointer directly earlier?<span style="mso-spacerun:yes">&nbsp; </span>When
starting and closing a procedure, we often want to declare local
variables.<span style="mso-spacerun:yes">&nbsp; </span>In assembly language this is
done on the stack.<span style="mso-spacerun:yes">&nbsp; </span>We figure out how
much space we need for all variables (including structures and arrays), then
manipulate the stack pointer to make and clear the space.<span style="mso-spacerun:yes">&nbsp; </span>If you scroll up above the breakpoint, you
would see the first line of the procedure is SUB ESP,14.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1085" type="#_x0000_t75"
 style='width:354pt;height:60.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image117.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="472" height="81" src="./Diablo II v1_files/image118.jpg" v:shapes="_x0000_i1085"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The SUB ESP,14 instruction allocates local variable
space, the ADD ESP,14 instruction clears it.<span style="mso-spacerun:yes">&nbsp;
</span>If you use this convention, you must balance the stack arithmetic from
beginning to end, or you will foul up your return address.<span style="mso-spacerun:yes">&nbsp; </span>It would be similar to what happens if you
push parameters ahead of a CALL without using the RETN # form.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The advantage of using “Execute till return” is that
it’s fast and we don’t have to have a second breakpoint.<span style="mso-spacerun:yes">&nbsp; </span>The run trace window now has a list of
instructions from our breakpoint to the RETN instruction.<span style="mso-spacerun:yes">&nbsp; </span>Just as an important note, the most recent
instruction is actually at the very bottom and the first instruction traced is
at the very top.<span style="mso-spacerun:yes">&nbsp; </span>You can also use
“Animate into” and “Animate over” to do a run trace.<span style="mso-spacerun:yes">&nbsp; </span>Just make sure that you have two breakpoints,
one to start at and one to end at.<span style="mso-spacerun:yes">&nbsp; </span>If
you don’t, those will both go on indefinitely and probably result in a crash.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s look at some more game code.<span style="mso-spacerun:yes">&nbsp; </span>Earlier, we discussed using PUSH and the
stack to pass parameters to a procedure.<span style="mso-spacerun:yes">&nbsp;
</span>This is sometimes known as the STDCALL convention.<span style="mso-spacerun:yes">&nbsp; </span>There is another convention, FASTCALL, which
also uses two registers to pass the first two parameters, with all others
PUSHed as before.<span style="mso-spacerun:yes">&nbsp; </span>ECX gets the first
parameter and EDX gets the second parameter.<span style="mso-spacerun:yes">&nbsp;
</span>Here is an example:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1086" type="#_x0000_t75"
 style='width:352.5pt;height:35.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image119.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="470" height="47" src="./Diablo II v1_files/image120.jpg" v:shapes="_x0000_i1086"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This CALL in d2game.dll has three parameters.<span style="mso-spacerun:yes">&nbsp; </span>But since it is a FASTCALL procedure, only
the third parameter is PUSHed.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">To navigate through a CALL when you are just browsing
code, you can highlight the CALL line and hit the Enter key.<span style="mso-spacerun:yes">&nbsp; </span>To back up when browsing, hit the subtract
key and the previous line you highlighted will be restored.<span style="mso-spacerun:yes">&nbsp; </span>Let’s drop into the procedure called in the
previous example.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1087" type="#_x0000_t75"
 style='width:353.25pt;height:68.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image121.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="471" height="91" src="./Diablo II v1_files/image122.jpg" v:shapes="_x0000_i1087"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Since this is the start of a procedure, note that ECX
provides information without itself being defined in the procedure.<span style="mso-spacerun:yes">&nbsp; </span>If this was a pushed parameter, it should
look like the Inner_procedure example presented when we first discussed the
CALL instruction.<span style="mso-spacerun:yes">&nbsp; </span>Often these uses of
ECX and EDX in the beginning of a procedure are our only clue that this
procedure uses the FASTCALL convention.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">There is something else odd in this code sample.<span style="mso-spacerun:yes">&nbsp; </span>We discussed the CALL instruction as using a
register or address to get the first instruction of an inner procedure.<span style="mso-spacerun:yes">&nbsp; </span>So what is this &lt;JMP.&amp;D2Common.#10800&gt;
about?<span style="mso-spacerun:yes">&nbsp; </span>While many CALLs are used to jump
around in a module, they can also be used to jump between modules.<span style="mso-spacerun:yes">&nbsp; </span>Here we are in D2Game.dll, and the procedure
we want to use is in D2Common.dll.<span style="mso-spacerun:yes">&nbsp; </span>When
the game was developed, Blizzard declared some procedures in each module as
exports, that is, they could be readily used by another module’s code.<span style="mso-spacerun:yes">&nbsp; </span>Exports are referred to by function name, or
by ordinal number if no export name has been defined.<span style="mso-spacerun:yes">&nbsp; </span>The using module is said to import the
function from the other module.<span style="mso-spacerun:yes">&nbsp; </span>When the
game is loaded, Windows handles the work required to marry such calls in an
importing module to those procedures exported by the other module.<span style="mso-spacerun:yes">&nbsp; </span>As far as we are concerned, there is no
difference in how OllyDbg steps into or traces through an imported procedure or
a local procedure. <br clear="all" style="page-break-before:always">
The last feature I will discuss is code analysis.<span style="mso-spacerun:yes">&nbsp; </span>OllyDbg can make some very educated guesses
about program structure from its disassembly.<span style="mso-spacerun:yes">&nbsp;
</span>The tool we use to display them is the Analysis option in the context
menu.<span style="mso-spacerun:yes">&nbsp; </span>Right-click in the code window,
and near the bottom you will find the Analysis commands:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1088" type="#_x0000_t75"
 style='width:357.75pt;height:102pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image123.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="477" height="136" src="./Diablo II v1_files/image124.jpg" v:shapes="_x0000_i1088"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Previously we have looked at raw debugger code.<span style="mso-spacerun:yes">&nbsp; </span>Here is what analyzed code looks like:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1089" type="#_x0000_t75"
 style='width:353.25pt;height:246pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image125.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="471" height="328" src="./Diablo II v1_files/image126.jpg" v:shapes="_x0000_i1089"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now you can see the procedure itself is bracketed at
left, and an inner loop has been identified between 049A4CA0 and 049A4CAD.<span style="mso-spacerun:yes">&nbsp; </span>Jump directions are indicated at left with
upward and downward carets, and jump targets are shown with the &gt;
symbol.<span style="mso-spacerun:yes">&nbsp; </span>This is just the beginning of
the information OllyDbg’s analysis feature can produce! </span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Our goal for this next discussion is to find the section
of code that displays </span></font><font size="2" face="Exocet"><span style="font-size:11.0pt;font-family:Exocet">DIFFICULTY: HELL</span></font> and <font size="2" face="Exocet"><span style="font-size:11.0pt;font-family:Exocet">DIFFICULTY:
NIGHTMARE</span></font> when you have the upper right text activated in the
main game window.<span style="mso-spacerun:yes">&nbsp; </span>Blizzard left out the <font size="2" face="Exocet"><span style="font-size:11.0pt;font-family:Exocet">DIFFICULTY:
<st1:city w:st="on"><st1:place w:st="on">NORMAL</st1:place></st1:city></span></font>
and we aim to put it in the game.</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We mentioned other types of breakpoints earlier.<span style="mso-spacerun:yes">&nbsp; </span>Let’s look at a conditional breakpoint.<span style="mso-spacerun:yes">&nbsp; </span>There is a procedure for retrieving strings
that are loaded from tbl files when passed an index number in ECX.<span style="mso-spacerun:yes">&nbsp; </span>This procedure is D2Lang.#10000; it is used
in many places in D2Client.dll to build user interface elements.<span style="mso-spacerun:yes">&nbsp; </span>But first we need to calculate the index
number we want to locate.<span style="mso-spacerun:yes">&nbsp; </span>For this we
will use AFJ’s Tbl Edit and look at String.tbl.<span style="mso-spacerun:yes">&nbsp;
</span>We find the three strings starting with Hell:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1090" type="#_x0000_t75"
 style='width:375pt;height:186.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image127.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="500" height="249" src="./Diablo II v1_files/image128.jpg" v:shapes="_x0000_i1090"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">When loaded in the game, these three files are
assigned base index values.<span style="mso-spacerun:yes">&nbsp; </span>String.tbl
has a base index of 0, PatchString.tbl has a base index of 10,000 and
ExpansionString.tbl has a base index of 20,000.<span style="mso-spacerun:yes">&nbsp;
</span>These are decimal numbers, so their hex equivalents are 0x0000, 0x2710
and 0x4E20 respectively.<span style="mso-spacerun:yes">&nbsp; </span>Every string
loaded in the game is identified by the index number shown in Tbl Edit added to
the base index, either hex or decimal form but hex is what the code shows.<span style="mso-spacerun:yes">&nbsp; </span>Here we see the first difficulty string is
0x1422 and with no adjustment that is what we will use.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now let’s see how this index is used.<span style="mso-spacerun:yes">&nbsp; </span>We will start by identifying the line that
actually switches program execution from D2Client.dll to D2Lang.dll.<span style="mso-spacerun:yes">&nbsp; </span>We right-click on the disassembler pane
background and select Search for | All intermodular calls.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1091" type="#_x0000_t75"
 style='width:332.25pt;height:129.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image129.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="443" height="173" src="./Diablo II v1_files/image130.jpg" v:shapes="_x0000_i1091"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This brings up the Found Intermodular Calls
window.<span style="mso-spacerun:yes">&nbsp; </span>Click on the Destination field
header, and all the imported functions will be sorted, including those
referenced by ordinal only.<span style="mso-spacerun:yes">&nbsp; </span>Scroll down
until you find any reference to D2Lang.#10000.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1092" type="#_x0000_t75"
 style='width:370.5pt;height:128.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image131.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="494" height="171" src="./Diablo II v1_files/image132.jpg" v:shapes="_x0000_i1092"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Once you find a reference, highlight it and hit the
Enter key.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1093" type="#_x0000_t75"
 style='width:378.75pt;height:57.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image133.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="505" height="77" src="./Diablo II v1_files/image134.jpg" v:shapes="_x0000_i1093"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This jumps you to one call, but it is not likely to be
the right one.<span style="mso-spacerun:yes">&nbsp; </span>So we will hit enter
again and be directed to a very special line in a block of similar lines.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1094" type="#_x0000_t75"
 style='width:451.5pt;height:67.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image135.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="602" height="90" src="./Diablo II v1_files/image136.jpg" v:shapes="_x0000_i1094"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This is the jump table entry for D2Lang.#10000.<span style="mso-spacerun:yes">&nbsp; </span>Wherever the function is called as we found
above, when executed the game will step through the jump table entry.<span style="mso-spacerun:yes">&nbsp; </span>So we will put a breakpoint here.<span style="mso-spacerun:yes">&nbsp; </span>But if we put an unconditional breakpoint
here we will be stopped all the time before we can even think of finding the
right reference.<span style="mso-spacerun:yes">&nbsp; </span>So we will use the
index number of our desired string and set a conditional breakpoint.<span style="mso-spacerun:yes">&nbsp; </span>Right-click and find the conditional
breakpoint command:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1095" type="#_x0000_t75"
 style='width:309pt;height:116.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image137.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="412" height="155" src="./Diablo II v1_files/image138.jpg" v:shapes="_x0000_i1095"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Then set the condition.<span style="mso-spacerun:yes">&nbsp; </span>The dialog box (see next page) takes a
C-style condition, so we will enter ECX==1422 into it.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1096" type="#_x0000_t75"
 style='width:421.5pt;height:126.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image139.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="562" height="169" src="./Diablo II v1_files/image140.jpg" v:shapes="_x0000_i1096"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1097" type="#_x0000_t75"
 style='width:428.25pt;height:62.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image141.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="571" height="83" src="./Diablo II v1_files/image142.jpg" v:shapes="_x0000_i1097"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Note this breakpoint shows as a light purple instead
of red when set.<span style="mso-spacerun:yes">&nbsp; </span>Now we run the program
and wait for the breakpoint to be triggered.<span style="mso-spacerun:yes">&nbsp;
</span>You need a character that can play a game higher than Normal in order to
trigger the string reference.<span style="mso-spacerun:yes">&nbsp; </span>This
happens very quickly, but when you look at the disassembly pane the difference
is very subtle.<span style="mso-spacerun:yes">&nbsp; </span>Instead of black on
light purple, you see red on light purple when the breakpoint is actually
encountered with the right condition.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1098" type="#_x0000_t75"
 style='width:444.75pt;height:58.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image143.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="593" height="78" src="./Diablo II v1_files/image144.jpg" v:shapes="_x0000_i1098"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Well, this doesn’t tell us much about the code that
called the imported function.<span style="mso-spacerun:yes">&nbsp; </span>So we will
look at the stack pane because that is where we will find the return from this
special call.<span style="mso-spacerun:yes">&nbsp; </span>Click on the highlighted
line and it will turn red:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1099" type="#_x0000_t75"
 style='width:339.75pt;height:52.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image145.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="453" height="70" src="./Diablo II v1_files/image146.jpg" v:shapes="_x0000_i1099"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This says we should look at D2Client.6FAFFF25.<span style="mso-spacerun:yes">&nbsp; </span>Hit the Enter key and you will go there in
the disassembly pane.<span style="mso-spacerun:yes">&nbsp; </span>It will be the
first line after the CALL you just executed when the breakpoint triggered.<span style="mso-spacerun:yes">&nbsp; </span>So scroll up a bit and you will see the
actual call:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1100" type="#_x0000_t75"
 style='width:461.25pt;height:45.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image147.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="615" height="61" src="./Diablo II v1_files/image148.jpg" v:shapes="_x0000_i1100"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">That is all fine and well, but we aren’t really
interested in the call itself.<span style="mso-spacerun:yes">&nbsp; </span>What we
want to see is the logic that set ECX to 0x1422 so it would display </span></font><font size="2" face="Exocet"><span style="font-size:11.0pt;font-family:Exocet">difficulty:
hell</span></font>.<span style="mso-spacerun:yes">&nbsp; </span>So scroll up some more.</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1101" type="#_x0000_t75"
 style='width:464.25pt;height:200.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image149.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="619" height="267" src="./Diablo II v1_files/image150.jpg" v:shapes="_x0000_i1101"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Here we see the whole front end of this display
procedure.<span style="mso-spacerun:yes">&nbsp; </span>Right above the call to the
string retrieval function we see</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV ECX,EBX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Above that we see two lines of interest:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EBX, 1422</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EBX, 1423</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We know from AFJ Tbl Edit that the first reference is
Hell and the second Nightmare.<span style="mso-spacerun:yes">&nbsp; </span>String
1424 happens to be <st1:city w:st="on"><st1:place w:st="on">Normal</st1:place></st1:city>.<span style="mso-spacerun:yes">&nbsp; </span>But there is no equivalent line for
referencing the normal string in this section of code.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Examine the code logic.<span style="mso-spacerun:yes">&nbsp; </span>The procedure starts by retrieving a byte
from a data location in D2Client.dll and expanding it to fill EAX with a MOVZX
instruction.<span style="mso-spacerun:yes">&nbsp; </span>This happens to be the game
difficulty.<span style="mso-spacerun:yes">&nbsp; </span>Then if the difficulty is 1
or 2 (Nightmare or Hell) the corresponding string is loaded.<span style="mso-spacerun:yes">&nbsp; </span>But if the difficulty is 0 (<st1:city w:st="on"><st1:place w:st="on">Normal</st1:place></st1:city>), we would jump to 6FAFFFC0, which is
at the end of this procedure.<span style="mso-spacerun:yes">&nbsp; </span>We want to
change the logic so we load a string for any difficulty.<span style="mso-spacerun:yes">&nbsp; </span>Note that the difficulty is decremented a
couple of times and used only for testing.<span style="mso-spacerun:yes">&nbsp;
</span>If we let it be decremented only once, and then negated, we could add
the difficulty to the middle string and get the correct string as a result:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EBX,1423</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">NEG EAX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">ADD EBX,EAX</span></font></p>

<p class="MsoNormal" style="margin-left:.5in"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JMP SHORT 6FAFFF04</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now let’s edit the code in Ollydbg, as shown on the
next page.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1102" type="#_x0000_t75"
 style='width:465.75pt;height:220.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image151.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="621" height="294" src="./Diablo II v1_files/image152.jpg" v:shapes="_x0000_i1102"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Switching back to the game, we see it still works for
the higher difficulty.<span style="mso-spacerun:yes">&nbsp; </span>Now let’s load a <st1:place w:st="on">Normal</st1:place> game and look.<span style="mso-spacerun:yes">&nbsp;
</span>It is successful!</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1103" type="#_x0000_t75"
 style='width:131.25pt;height:57.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image153.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="175" height="77" src="./Diablo II v1_files/image154.jpg" v:shapes="_x0000_i1103"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We talked about code replacement and how to navigate
through it.<span style="mso-spacerun:yes">&nbsp; </span>But what about new code, or code
that is just a bit larger than what we might have room for?<span style="mso-spacerun:yes">&nbsp; </span>New code is beyond the scope of this
tutorial.<span style="mso-spacerun:yes">&nbsp; </span>But there are times when we
need a little more room for something simple.<span style="mso-spacerun:yes">&nbsp;
</span>One important case is the most requested code edit in the entire game:
changing the number of skill points your character receives with each level
gained.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s look at the existing code:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1104" type="#_x0000_t75"
 style='width:421.5pt;height:110.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image155.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="562" height="147" src="./Diablo II v1_files/image156.jpg" v:shapes="_x0000_i1104"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This section generates the 5 stat points and 1 skill
point in unmodded Diablo II.<span style="mso-spacerun:yes">&nbsp; </span>I have commented
each line so you can see what is happening.<span style="mso-spacerun:yes">&nbsp;
</span>Here we have an imported function, D2Common.#10627, whose purpose we
know: add to stat.<span style="mso-spacerun:yes">&nbsp; </span>The parameters are
the four PUSHes ahead of the CALL:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Arg4: Param (for stats that have parameters of their
own, like oskills)</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Arg3: value to increase the stat by</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Arg2: the ID of the stat from ItemStatCost.txt</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Arg1: handle for a character’s essential data
structure, called ptUnit</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The first call gives you the stat points when you
level up.<span style="mso-spacerun:yes">&nbsp; </span>Since there is a field in
Charstats.txt that allows you to determine stat points per level, so no code
editing is required here.<span style="mso-spacerun:yes">&nbsp; </span>(Unless you
are modding v1.09x and earlier, the field was added with v1.10.)<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>The second call gives the skill points, but
there is no field lookup here, so we have to roll our own solution.<span style="mso-spacerun:yes">&nbsp; </span>The required code in ASM is</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,{number} </span></font><font face="Wingdings"><span style="font-family:Wingdings;mso-ascii-font-family:&quot;Times New Roman&quot;;
mso-hansi-font-family:&quot;Times New Roman&quot;;mso-char-type:symbol;mso-symbol-font-family:
Wingdings"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings">ß</span></span></font>
amount to gain per level</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">IMUL EAX,EBX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">And we need to feed the second push our skills/lvl *
levels gained product.<span style="mso-spacerun:yes">&nbsp; </span>But all four
arguments use only 6 bytes and the new instructions need another 8 bytes.<span style="mso-spacerun:yes">&nbsp; </span>There is no room for all of that!<span style="mso-spacerun:yes">&nbsp; </span>You cannot insert extra bytes here, you have
to find some room and jump to it.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">In every DLL there is a little unused space at the end
of the code segment.<span style="mso-spacerun:yes">&nbsp; </span>To find it, go to
the code window and scroll all the way to the bottom of the disassembly.<span style="mso-spacerun:yes">&nbsp; </span>You will see a bunch of lines that will read
ADD BYTE PTR [EAX],<st1:place w:st="on"><st1:state w:st="on">AL</st1:state></st1:place>
(analysis off) or DB 00 (analysis on); both forms are a 00 coding.<span style="mso-spacerun:yes">&nbsp; </span>Highlight the last line, then hit the Page Up
key several times until you see some other instructions.<span style="mso-spacerun:yes">&nbsp; </span>The space below these other instructions is
called slack space, and we can use it.<span style="mso-spacerun:yes">&nbsp;
</span>Make note of the first address which has the 00 coding.<span style="mso-spacerun:yes">&nbsp; </span>In the example below, that is 04A67044.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1105" type="#_x0000_t75"
 style='width:345pt;height:108pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image157.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="460" height="144" src="./Diablo II v1_files/image158.jpg" v:shapes="_x0000_i1105"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now return to the skill points code.<span style="mso-spacerun:yes">&nbsp; </span>We need five bytes to form a JMP that reaches
slack space.<span style="mso-spacerun:yes">&nbsp; </span>So we will overwrite the
first three PUSH instructions with a JMP:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1106" type="#_x0000_t75"
 style='width:359.25pt;height:131.25pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image159.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="479" height="175" src="./Diablo II v1_files/image160.jpg" v:shapes="_x0000_i1106"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Which gives us</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1107" type="#_x0000_t75"
 style='width:358.5pt;height:36.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image161.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="478" height="49" src="./Diablo II v1_files/image162.jpg" v:shapes="_x0000_i1107"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You can see I left the fourth PUSH alone.<span style="mso-spacerun:yes">&nbsp; </span>We didn’t need its byte.<span style="mso-spacerun:yes">&nbsp; </span>Now we need to go to the target of the jump,
so highlight the new line and hit the Enter Key.<span style="mso-spacerun:yes">&nbsp; </span>But before we go, let’s make note of the next
line’s address, which here is 049E9693.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We will overwrite the slack space bytes we need with
the new code for multiple skill points per level.<span style="mso-spacerun:yes">&nbsp; </span>First, let’s figure out how many points we
want per level, say, 3.<span style="mso-spacerun:yes">&nbsp; </span>Then we will
multiply that with EBX, the number of levels gained.<span style="mso-spacerun:yes">&nbsp; </span>Finally we put the three PUSHes in that we
overwrote, and jump back to the following line’s address.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">MOV EAX,3</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">IMUL EAX,EBX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH 0</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH EAX</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PUSH 5</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">JMP 049E9693</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Use the Assemble feature and enter the lines just as I
wrote them above.<span style="mso-spacerun:yes">&nbsp; </span>You should now have:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1108" type="#_x0000_t75"
 style='width:277.5pt;height:70.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image163.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="370" height="94" src="./Diablo II v1_files/image164.jpg" v:shapes="_x0000_i1108"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Let’s put a breakpoint on line 049E967C and watch what
happens on the stack.<span style="mso-spacerun:yes">&nbsp; </span>We will use the
Step Over feature (key F8) as we don’t want to go into the add_stat
function.<span style="mso-spacerun:yes">&nbsp; </span>Now go out and gain a
level.<span style="mso-spacerun:yes">&nbsp; </span>(It is best to use a very low
level character for this test.)<span style="mso-spacerun:yes">&nbsp; </span>Once we
come up against the breakpoint, step down to the IMUL EAX,EBX line.<span style="mso-spacerun:yes">&nbsp; </span>Look below the disassembly window and you
will see the contents of both registers there:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1109" type="#_x0000_t75"
 style='width:282.75pt;height:54.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image165.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="377" height="73" src="./Diablo II v1_files/image166.jpg" v:shapes="_x0000_i1109"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">We confirm that EBX contains 1, since we gained only
one level.<span style="mso-spacerun:yes">&nbsp; </span>Now continue down to the CALL
line.<span style="mso-spacerun:yes">&nbsp; </span>In the Stack window, you will see
the four parameters set up on the stack and listed in reverse order.<span style="mso-spacerun:yes">&nbsp; </span>Each PUSH has a similar effect to SUB ESP,4
so the stack grows upward:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1110" type="#_x0000_t75"
 style='width:125.25pt;height:37.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image167.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="167" height="50" src="./Diablo II v1_files/image168.jpg" v:shapes="_x0000_i1110"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Step over the CALL and follow the skill points
assignment.<span style="mso-spacerun:yes">&nbsp; </span>When you walk onto your new
jump, a red line appears at left to show that you will take the jump when you
step to the next instruction.<span style="mso-spacerun:yes">&nbsp; </span>We load
EAX with our new skill points per level quantity and come to the new IMUL
instruction.<span style="mso-spacerun:yes">&nbsp; </span>The inspection window
shows:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1111" type="#_x0000_t75"
 style='width:289.5pt;height:49.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image169.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="386" height="66" src="./Diablo II v1_files/image170.jpg" v:shapes="_x0000_i1111"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">just like we want it to be.<span style="mso-spacerun:yes">&nbsp; </span>Continue on to the jump back to original code
and then the next CALL.<span style="mso-spacerun:yes">&nbsp; </span>The stack now
has</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1112" type="#_x0000_t75"
 style='width:98.25pt;height:37.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image171.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="131" height="50" src="./Diablo II v1_files/image172.jpg" v:shapes="_x0000_i1112"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">A quick comparison of the two stack excerpts shows us
we had similar looking parameters ahead of the add_stat function.<span style="mso-spacerun:yes">&nbsp; </span>So we will step over this call, and with no
unexpected event hit F9 to run the game.<span style="mso-spacerun:yes">&nbsp;
</span>Then go to the stat and skill panes and you should see:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1113" type="#_x0000_t75"
 style='width:107.25pt;height:30.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image173.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="143" height="41" src="./Diablo II v1_files/image174.jpg" v:shapes="_x0000_i1113"><!--[endif]--><!--[if gte vml 1]><v:shape
 id="_x0000_i1114" type="#_x0000_t75" style='width:77.25pt;height:84.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image175.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="103" height="113" src="./Diablo II v1_files/image176.jpg" v:shapes="_x0000_i1114"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Which is what we wanted to see.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">This is good stuff, but how do we save it?<span style="mso-spacerun:yes">&nbsp; </span>If you exit OllyDbg now, you will close the
game without saving your character, similar to a crash.<span style="mso-spacerun:yes">&nbsp; </span>And you will lose all your changes in
memory!<span style="mso-spacerun:yes">&nbsp; </span>Unfortunately, saving code edits
in debugger mode is definitely not as straightforward as a File Save
command.<span style="mso-spacerun:yes">&nbsp; </span>First, you need to identify all
your changes, which you do by right clicking and selecting Copy, then Select
All:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1115" type="#_x0000_t75"
 style='width:369.75pt;height:133.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image177.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="493" height="178" src="./Diablo II v1_files/image178.jpg" v:shapes="_x0000_i1115"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Next, right-click again and choose Copy to Executable,
then All Modifications:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1116" type="#_x0000_t75"
 style='width:249pt;height:117.75pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image179.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="332" height="157" src="./Diablo II v1_files/image180.jpg" v:shapes="_x0000_i1116"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You will get a popup dialog with four buttons, choose
Copy All.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1117" type="#_x0000_t75"
 style='width:199.5pt;height:70.5pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image181.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="266" height="94" src="./Diablo II v1_files/image182.jpg" v:shapes="_x0000_i1117"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">You will get a new window which resembles a DLL opened
in File Assembly mode.<span style="mso-spacerun:yes">&nbsp; </span>Right-click one
more time and choose Save File.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><!--[if gte vml 1]><v:shape id="_x0000_i1118" type="#_x0000_t75"
 style='width:321pt;height:339pt'>
 <v:imagedata src="diablo_ii_code_editing%20v2.01_files/image183.png" o:title=""/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="428" height="452" src="./Diablo II v1_files/image184.jpg" v:shapes="_x0000_i1118"><!--[endif]--></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Now you will get a standard Windows file save dialog,
and you are home free.<span style="mso-spacerun:yes">&nbsp; </span>Save the file as
D2Game.dll (in this case) and accept the overwrite.<span style="mso-spacerun:yes">&nbsp; </span>From now on, whenever you play the game with
your customized module, you will gain 3 points per level (or whatever number
you wish to choose).</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">There are many other features in OllyDbg, but these
are the main ones and the ones you’ll probably use most often.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<h1><b><font size="5" color="yellow" face="Times New Roman"><span style="font-size:
16.0pt;mso-bidi-font-size:12.0pt;color:yellow">Conclusion<o:p></o:p></span></font></b></h1>

<p class="MsoNormal"><font size="3" color="black" face="Times New Roman"><span style="font-size:12.0pt;color:windowtext"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">By this point you should understand hexadecimal, some
basic assembly, and how to use XVI32, OllyDbg, and the Windows Calculator for
you code editing purposes.<span style="mso-spacerun:yes">&nbsp; </span>If you’re
looking for more information or for things that can be changed, go to the
Phrozen Keep’s code editing forum.<span style="mso-spacerun:yes">&nbsp; </span>Just
scroll down a little ways and you’ll find it.<span style="mso-spacerun:yes">&nbsp;
</span>Or use the Keep’s search feature to locate a specific change.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">All in all, I think you’ll find that the most
important thing to getting anywhere is to practice.<span style="mso-spacerun:yes">&nbsp; </span>After a little while you’ll begin to know
exactly what instructions do what and how all the instructions work together to
form a function.<span style="mso-spacerun:yes">&nbsp; </span>You’ll begin to know
what to look for when you want to change things and how to find it.<span style="mso-spacerun:yes">&nbsp; </span>All you need to do is practice.<span style="mso-spacerun:yes">&nbsp; </span>The best place to start is by going to the
Phrozen Keep’s code editing forum and finding a few examples that list the ASM
code.<span style="mso-spacerun:yes">&nbsp; </span>Then look at it and try and follow
along with what they changed.<span style="mso-spacerun:yes">&nbsp; </span>It
probably won’t be as hard as you expect it to be.<span style="mso-spacerun:yes">&nbsp; </span>And it will help you to see how things are
usually changed.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;
font-family:&quot;Times New Roman&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
color:white;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA"><br clear="all" style="page-break-before:always">
</span></font>

<h1><b><font size="5" color="yellow" face="Times New Roman"><span style="font-size:
16.0pt;mso-bidi-font-size:12.0pt;color:yellow">Credits<o:p></o:p></span></font></b></h1>

<p class="MsoNormal"><font size="3" color="black" face="Times New Roman"><span style="font-size:12.0pt;color:windowtext"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><i style="mso-bidi-font-style:normal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-style:
italic;mso-bidi-font-style:normal">Myhrginoc thanks:<o:p></o:p></span></font></i></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Sir_General, who wrote the original tutorial I
expanded and updated.</span></font></p>

<p class="MsoNormal"><span class="GramE"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Nefarius, for reviewing
this version of the tutorial and many suggestions.</span></font></span></p>

<p class="MsoNormal"><span class="GramE"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Blizzard Entertainment,
for the Diablo Universe and two-and-a-half great games in it.</span></font></span></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><i style="mso-bidi-font-style:normal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt;font-style:
italic;mso-bidi-font-style:normal">Sir_General’s original list from v1.00 of
this tutorial</span></font></i>:</p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">I’m sure I can’t think of everyone who deserves a spot
in the credits, but I’ll certainly try.<span style="mso-spacerun:yes">&nbsp;
</span>If I left you out, please e-mail me at <a href="mailto:sir_general@planetdiablo.com">sir_general@planetdiablo.com</a> and
I’ll make sure to add you in.</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Special thanks to:</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Jarulf</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">FoxBat</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Apocalypse Demon</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">RicFaith</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Myhrginoc</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Alkalund</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Maxbogus</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">Thunder</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">And last of all…</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt"><o:p>&nbsp;</o:p></span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">The Phrozen Keep and their host</span></font></p>

<p class="MsoNormal"><font size="3" color="white" face="Times New Roman"><span style="font-size:12.0pt">PlanetDiablo at the GameSpy Network</span></font></p>

</div>




</o:smarttagtype></o:smarttagtype></o:smarttagtype></o:smarttagtype></body><div style="all: initial;"><div id="__hcfy__" style="all: initial;"><template shadowrootmode="open"><style>#root{-webkit-text-size-adjust:100%;box-sizing:border-box;font-size:14px;font-weight:400;letter-spacing:0;line-height:1.28581;text-transform:none;color:#182026;font-family:-apple-system,"BlinkMacSystemFont","Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Open Sans","Helvetica Neue","Icons16",sans-serif}#root{touch-action:manipulation}#root>.bp5-portal{z-index:9999999999}</style><link rel="stylesheet" href="chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/normalize.css"><link rel="stylesheet" href="chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/blueprint.css"><link rel="stylesheet" href="chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/blueprint-select.css"><link rel="stylesheet" href="chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/cropper.css"><style>#translate-panel{background-color:#f6f7f9;display:flex;flex-direction:column;padding-bottom:8px}.bp5-dark #translate-panel{background-color:#252a31}#translate-panel .fixed{flex-shrink:0;margin-bottom:10px}#translate-panel .body{flex-grow:1;overflow:auto;overscroll-behavior:contain}#translate-panel .body::-webkit-scrollbar{width:8px;background-color:rgba(0,0,0,0);-webkit-border-radius:100px}#translate-panel .body::-webkit-scrollbar:hover{background-color:rgba(0,0,0,.09)}#translate-panel .body::-webkit-scrollbar-thumb:vertical{background:rgba(0,0,0,.5);-webkit-border-radius:100px}#translate-panel .body::-webkit-scrollbar-thumb:vertical:active{background:rgba(0,0,0,.61);-webkit-border-radius:100px}#translate-panel.size-small,#translate-panel.size-small h6.bp5-heading,#translate-panel.size-small .bp5-control.bp5-large,#translate-panel.size-small textarea.bp5-input.bp5-small{font-size:14px}#translate-panel.size-small .phonetic-item,#translate-panel.size-small .quick-settings a{font-size:12px}#translate-panel.size-middle,#translate-panel.size-middle h6.bp5-heading,#translate-panel.size-middle .bp5-control.bp5-large,#translate-panel.size-middle textarea.bp5-input{font-size:18px}#translate-panel.size-middle .phonetic-item,#translate-panel.size-middle .quick-settings a{font-size:14px}#translate-panel.size-large,#translate-panel.size-large h6.bp5-heading,#translate-panel.size-large .bp5-control.bp5-large,#translate-panel.size-large textarea.bp5-input.bp5-large{font-size:22px}#translate-panel.size-large .source,#translate-panel.size-large .phonetic-item,#translate-panel.size-large .quick-settings a{font-size:18px}#translate-panel .bp5-button.bp5-small,#translate-panel .bp5-small .bp5-button{min-height:20px;min-width:20px}#translate-panel .header{display:flex;align-items:center;padding:4px 6px 4px 10px;border-bottom:1px solid #d1d1d1}.bp5-dark #translate-panel .header{border-bottom-color:rgba(17,20,24,.4)}#translate-panel .header .drag-block{min-width:5px;flex-shrink:0;flex-grow:1;align-self:stretch}#translate-panel .header .left{flex-shrink:0;display:flex}#translate-panel .header .right{flex-shrink:0;display:flex;align-items:center}#translate-panel .header .right .bp5-icon-arrow-right{flex-shrink:0;margin:0 5px}#translate-panel .header .right>.bp5-button{flex-shrink:0;margin:0 1px}#translate-panel .header .right>.bp5-button:last-child{margin-right:0}#translate-panel .quick-settings{padding:4px 9px;margin:0 1px}#translate-panel .quick-settings>div{margin-bottom:5px}#translate-panel .quick-settings .bp5-control{margin-bottom:0}#translate-panel .query-text{position:relative;padding:10px 10px 2px 10px}#translate-panel .query-text textarea.bp5-input{min-height:44px;font-family:system-ui,-apple-system,"Segoe UI","Roboto","Ubuntu","Cantarell","Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";overscroll-behavior:contain}#translate-panel .query-text .translate-btn{position:absolute;opacity:.6}#translate-panel .query-text .translate-btn:hover{opacity:1}#translate-panel .body{padding:0 10px}#translate-panel .body .bp5-card:first-child{margin-top:1px}#translate-panel .body .bp5-card:last-child{margin-bottom:1px}#translate-panel .body .no-api{margin:20px 0}.result-block{margin:8px 0;padding:2px 5px}.result-block .bp5-button{visibility:hidden}.result-block .error .bp5-button,.result-block:hover .bp5-button{visibility:visible}.result-block .legend{display:flex;align-items:center;justify-content:space-between}.result-block .legend .legend-left{display:flex;align-items:center}.result-block .legend .api-ico,.result-block .legend .bp5-heading{flex-shrink:0;white-space:nowrap}.result-block .legend .api-ico{display:inline-block;width:14px;height:14px;background-size:contain;margin-right:3px}.result-block .legend .bp5-heading{margin-bottom:0;margin-right:10px}.result-block .legend .source{cursor:pointer;font-size:12px;display:inline-flex;align-items:center}.result-block .legend .source .source-text{overflow:hidden}.result-block .legend .source .bp5-icon{position:relative;top:-1px;margin-left:1px}.result-block .phonetic{display:flex;flex-wrap:wrap}.result-block .phonetic .phonetic-item{display:flex;align-items:center;font-size:12px}.result-block .phonetic .phonetic-item:not(:last-child){margin-right:12px}.result-block .common-result p{line-height:1.3;margin:2px 0;overflow-wrap:break-word}.result-block .common-result .dict a{text-decoration:underline}.result-block .error{font-size:12px;padding:5px 10px}.result-block .dict-pos{margin-right:5px}.external-translators{margin-bottom:3px;padding:0;display:flex;flex-wrap:wrap}.external-translators>div{margin:0 5px 5px 0}.quick-links a{margin:0 5px 5px 0}#popper-container{width:250px;max-width:100%;position:absolute;left:0;top:0;z-index:9999999998;touch-action:none;transition:opacity .2s;background-color:#f6f7f9}.bp5-dark #popper-container{background-color:#252a31}#popper-container.show{opacity:1;pointer-events:auto;user-select:auto}#popper-container,#popper-container[data-popper-reference-hidden=true]{opacity:0;pointer-events:none;user-select:none}#popper-container .drag-block{cursor:grab}#popper-container.pin{position:fixed}#popper-container.pin .arrow{display:none}#popper-container .arrow,#popper-container .arrow::before{position:absolute;width:8px;height:8px;z-index:-1}#popper-container .arrow::before{content:"";transform:rotate(45deg);background:#f6f7f9}.bp5-dark #popper-container .arrow::before{background-color:#252a31}#popper-container .arrow{display:none}#popper-container.show[data-popper-placement]:not([data-popper-reference-hidden=true]) .arrow{display:block}#popper-container[data-popper-placement^=top] .arrow{bottom:-5px}#popper-container[data-popper-placement^=top] .arrow::before{border-right:1px solid #d1d1d1;border-bottom:1px solid #d1d1d1}#popper-container[data-popper-placement^=bottom] .arrow{top:-5px}#popper-container[data-popper-placement^=bottom] .arrow::before{border-left:1px solid #d1d1d1;border-top:1px solid #d1d1d1}#popper-container[data-popper-placement^=left] .arrow{right:-5px}#popper-container[data-popper-placement^=left] .arrow::before{border-right:1px solid #d1d1d1;border-top:1px solid #d1d1d1}#popper-container[data-popper-placement^=right] .arrow{left:-5px}#popper-container[data-popper-placement^=right] .arrow::before{border-left:1px solid #d1d1d1;border-bottom:1px solid #d1d1d1}#translate-btn{display:none;position:absolute;z-index:9999999999;left:0;top:0}#translate-btn .bp5-button{padding:2px;min-width:0;min-height:0}#translate-btn .btn-icon{width:18px;height:18px;background-image:url(chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/logo.png);background-size:contain}.bp5-dark #translate-btn .btn-icon{background-image:url(chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/logowhite36.png)}#translate-btn.show{display:block}.translate-type-selector .bp5-label{display:inline}.translate-type-selector .bp5-radio{margin-bottom:0}#ocr-container{position:fixed;z-index:99999999999999;left:0;top:0;right:0;bottom:0}#ocr-container .toolbar{display:none;position:absolute;z-index:1}#ocr-container img{max-width:100%}#app{cursor:default}.switch-pin{flex-shrink:0;cursor:pointer}.switch-pin .bp5-icon-pin{transition:transform .2s,color .2s;transform:rotate(-45deg)}.pin .switch-pin .bp5-icon-pin{transform:rotate(-70deg)}.cut-btn{margin-left:2px}.app-toaster-container{position:fixed !important;z-index:9999999999 !important}.app-toaster-container .bp5-toast{min-width:auto}#web-trs-panel .app-toaster-container{padding-right:0;padding-left:0}#web-trs-panel .page-trs-form-group{margin:0 0 0 0;align-items:center}#web-trs-panel .page-trs-form-group>label{width:70px}</style><div id="root" dir="ltr"><div id="app"><div id="translate-btn"><button type="button" class="bp5-button"><span class="btn-icon"></span></button></div><div id="popper-container" class="bp5-elevation-4" style="width: 250px; transform: translate(0px, 0px);"><div id="translate-panel" class="size-small"><div class="fixed"><div class="header"><div class="left"><div class="switch-pin"><button type="button" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-pin"><svg data-icon="pin" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M9.41.92c-.51.51-.41 1.5.15 2.56L4.34 7.54C2.8 6.48 1.45 6.05.92 6.58l3.54 3.54-3.54 4.95 4.95-3.54 3.54 3.54c.53-.53.1-1.88-.96-3.42l4.06-5.22c1.06.56 2.04.66 2.55.15L9.41.92z" fill-rule="evenodd"></path></svg></span></button></div><button type="button" title="&#22270;&#29255;&#32763;&#35793;" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-media"><svg data-icon="media" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M11.99 6.99c.55 0 1-.45 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm3-5h-14c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-10c0-.55-.45-1-1-1zm-1 9l-5-3-1 2-3-4-3 5v-7h12v7z" fill-rule="evenodd"></path></svg></span></button><button type="button" title="&#35821;&#38899;&#32763;&#35793;" class="bp5-button bp5-minimal bp5-small"><span class="bp5-icon"><svg version="1.1" id="Capa_1" width="14" height="14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 490.9 490.9" xml:space="preserve"><g><g><path d="M245.5,322.9c53,0,96.2-43.2,96.2-96.2V96.2c0-53-43.2-96.2-96.2-96.2s-96.2,43.2-96.2,96.2v130.5 C149.3,279.8,192.5,322.9,245.5,322.9z M173.8,96.2c0-39.5,32.2-71.7,71.7-71.7s71.7,32.2,71.7,71.7v130.5 c0,39.5-32.2,71.7-71.7,71.7s-71.7-32.2-71.7-71.7V96.2z"></path><path d="M94.4,214.5c-6.8,0-12.3,5.5-12.3,12.3c0,85.9,66.7,156.6,151.1,162.8v76.7h-63.9c-6.8,0-12.3,5.5-12.3,12.3 s5.5,12.3,12.3,12.3h152.3c6.8,0,12.3-5.5,12.3-12.3s-5.5-12.3-12.3-12.3h-63.9v-76.7c84.4-6.3,151.1-76.9,151.1-162.8 c0-6.8-5.5-12.3-12.3-12.3s-12.3,5.5-12.3,12.3c0,76.6-62.3,138.9-138.9,138.9s-138.9-62.3-138.9-138.9 C106.6,220,101.2,214.5,94.4,214.5z"></path></g></g></svg></span></button></div><div class="drag-block" title="&#25353;&#20303;&#19981;&#25918;&#21487;&#20197;&#25302;&#21160;"></div><div class="right"><div style="font-size: 0px; position: relative;"><button type="button" title="&#20320;&#26377; 2 &#26465;&#26410;&#35835;&#28040;&#24687;" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-notifications"><svg data-icon="notifications" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M8 16c1.1 0 2-.9 2-2H6c0 1.1.9 2 2 2zm6-5c-.55 0-1-.45-1-1V6c0-2.43-1.73-4.45-4.02-4.9 0-.04.02-.06.02-.1 0-.55-.45-1-1-1S7 .45 7 1c0 .04.02.06.02.1A4.992 4.992 0 003 6v4c0 .55-.45 1-1 1s-1 .45-1 1 .45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1z" fill-rule="evenodd"></path></svg></span></button><div style="position: absolute; background: rgb(243, 1, 1); width: 6px; height: 6px; border-radius: 3px; right: 3px; top: 1px;"></div></div><button type="button" disabled="" title="&#28155;&#21152;&#21040;&#25910;&#34255;&#22841;" class="bp5-button bp5-disabled bp5-minimal bp5-small" tabindex="-1"><span aria-hidden="true" class="bp5-icon bp5-icon-star-empty"><svg data-icon="star-empty" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M16 6.11l-5.53-.84L8 0 5.53 5.27 0 6.11l4 4.1L3.06 16 8 13.27 12.94 16 12 10.21l4-4.1zM4.91 13.2l.59-3.62L3 7.02l3.45-.53L8 3.2l1.55 3.29 3.45.53-2.5 2.56.59 3.62L8 11.49 4.91 13.2z" fill-rule="evenodd"></path></svg></span></button><button type="button" class="bp5-button bp5-minimal bp5-small settings" title="&#24555;&#25463;&#35774;&#32622;"><span aria-hidden="true" class="bp5-icon bp5-icon-cog"><svg data-icon="cog" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M15.19 6.39h-1.85c-.11-.37-.27-.71-.45-1.04l1.36-1.36c.31-.31.31-.82 0-1.13l-1.13-1.13a.803.803 0 00-1.13 0l-1.36 1.36c-.33-.17-.67-.33-1.04-.44V.79c0-.44-.36-.8-.8-.8h-1.6c-.44 0-.8.36-.8.8v1.86c-.39.12-.75.28-1.1.47l-1.3-1.3c-.3-.3-.79-.3-1.09 0L1.82 2.91c-.3.3-.3.79 0 1.09l1.3 1.3c-.2.34-.36.7-.48 1.09H.79c-.44 0-.8.36-.8.8v1.6c0 .44.36.8.8.8h1.85c.11.37.27.71.45 1.04l-1.36 1.36c-.31.31-.31.82 0 1.13l1.13 1.13c.31.31.82.31 1.13 0l1.36-1.36c.33.18.67.33 1.04.44v1.86c0 .44.36.8.8.8h1.6c.44 0 .8-.36.8-.8v-1.86c.39-.12.75-.28 1.1-.47l1.3 1.3c.3.3.79.3 1.09 0l1.09-1.09c.3-.3.3-.79 0-1.09l-1.3-1.3c.19-.35.36-.71.48-1.1h1.85c.44 0 .8-.36.8-.8v-1.6a.816.816 0 00-.81-.79zm-7.2 4.6c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z" fill-rule="evenodd"></path></svg></span></button><button type="button" title="&#20851;&#38381;(Esc)" class="bp5-button bp5-minimal bp5-small"><span aria-hidden="true" class="bp5-icon bp5-icon-cross"><svg data-icon="cross" height="18" role="img" viewBox="0 0 16 16" width="18"><path d="M9.41 8l3.29-3.29c.19-.18.3-.43.3-.71a1.003 1.003 0 00-1.71-.71L8 6.59l-3.29-3.3a1.003 1.003 0 00-1.42 1.42L6.59 8 3.3 11.29c-.19.18-.3.43-.3.71a1.003 1.003 0 001.71.71L8 9.41l3.29 3.29c.18.19.43.3.71.3a1.003 1.003 0 00.71-1.71L9.41 8z" fill-rule="evenodd"></path></svg></span></button></div></div><div class="bp5-collapse"><div class="bp5-collapse-body" aria-hidden="true"><div class="quick-settings bp5-card bp5-elevation-0"><div><span aria-controls="listbox-0" aria-haspopup="listbox" class="lang-select bp5-popover-target" aria-expanded="false" role="combobox"><button type="button" class="bp5-button bp5-small"><span class="bp5-button-text">&#33258;&#21160;&#26816;&#27979;</span><span aria-hidden="true" class="bp5-icon bp5-icon-caret-down"><svg data-icon="caret-down" height="16" role="img" viewBox="0 0 16 16" width="16"><path d="M12 6.5c0-.28-.22-.5-.5-.5h-7a.495.495 0 00-.37.83l3.5 4c.09.1.22.17.37.17s.28-.07.37-.17l3.5-4c.08-.09.13-.2.13-.33z" fill-rule="evenodd"></path></svg></span></button></span><span aria-hidden="true" class="bp5-icon bp5-icon-arrow-right" style="margin: 0px 10px;"><svg data-icon="arrow-right" height="12" role="img" viewBox="0 0 16 16" width="12"><path d="M14.7 7.29l-5-5a.965.965 0 00-.71-.3 1.003 1.003 0 00-.71 1.71l3.29 3.29H1.99c-.55 0-1 .45-1 1s.45 1 1 1h9.59l-3.29 3.29a1.003 1.003 0 001.42 1.42l5-5c.18-.18.29-.43.29-.71s-.12-.52-.3-.7z" fill-rule="evenodd"></path></svg></span><span aria-controls="listbox-1" aria-haspopup="listbox" class="lang-select bp5-popover-target" aria-expanded="false" role="combobox"><button type="button" class="bp5-button bp5-small"><span class="bp5-button-text">&#20013;&#25991;(&#31616;&#20307;)</span><span aria-hidden="true" class="bp5-icon bp5-icon-caret-down"><svg data-icon="caret-down" height="16" role="img" viewBox="0 0 16 16" width="16"><path d="M12 6.5c0-.28-.22-.5-.5-.5h-7a.495.495 0 00-.37.83l3.5 4c.09.1.22.17.37.17s.28-.07.37-.17l3.5-4c.08-.09.13-.2.13-.33z" fill-rule="evenodd"></path></svg></span></button></span></div><div><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox" checked=""><span class="bp5-control-indicator"></span>&#35895;&#27468;</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox" checked=""><span class="bp5-control-indicator"></span>DeepL</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>ChatGPT</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>Yandex</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#30334;&#24230;</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#30334;&#24230;(&#19987;&#19994;&#29256;)</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#33150;&#35759;</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#24425;&#20113;</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#38463;&#37324;</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#38463;&#37324;(&#19987;&#19994;&#29256;)</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#26377;&#36947;</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#28779;&#23665;</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox" checked=""><span class="bp5-control-indicator"></span>&#24517;&#24212;&#35789;&#20856;</label><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#25628;&#29399;</label></div><div><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#33258;&#21160;&#26391;&#35835;</label><span aria-haspopup="true" class="bp5-popover-target"><label class="bp5-control bp5-checkbox bp5-disabled bp5-inline"><input disabled="" tabindex="0" type="checkbox"><span class="bp5-control-indicator"></span>&#33258;&#21160;&#22797;&#21046;</label></span></div><div><label class="bp5-control bp5-radio bp5-inline"><input name="Blueprint5.RadioGroup-0" type="radio" value="small" checked=""><span class="bp5-control-indicator"></span>&#23567;</label><label class="bp5-control bp5-radio bp5-inline"><input name="Blueprint5.RadioGroup-0" type="radio" value="middle"><span class="bp5-control-indicator"></span>&#20013;</label><label class="bp5-control bp5-radio bp5-inline"><input name="Blueprint5.RadioGroup-0" type="radio" value="large"><span class="bp5-control-indicator"></span>&#22823;</label></div><div><label class="bp5-control bp5-checkbox bp5-inline"><input type="checkbox"><span class="bp5-control-indicator"></span>&#26174;&#31034;&#25991;&#26412;&#26694;</label><label class="bp5-control bp5-checkbox bp5-inline" style="margin-right: 0px;"><input type="checkbox"><span class="bp5-control-indicator"></span>&#40736;&#26631;&#24748;&#28014;&#21462;&#35789;</label></div><a class="bp5-text-small">&#25171;&#24320;&#23436;&#25972;&#35774;&#32622;</a><a class="bp5-text-small" style="margin-left: 15px;"><span aria-hidden="true" class="bp5-icon bp5-icon-crown" style="position: relative; top: -1px;"><svg data-icon="crown" height="14" role="img" viewBox="0 0 16 16" width="14"><path d="M2 6l3 2 3-4 3 4 3-2-1 6H3L2 6zm6-5a1 1 0 110 2 1 1 0 010-2zM1 3a1 1 0 110 2 1 1 0 010-2zm14 0a1 1 0 110 2 1 1 0 010-2zM3 13h10v2H3v-2z" fill-rule="evenodd"></path></svg></span> &#24320;&#36890;&#20250;&#21592;</a></div></div></div></div><div class="body"><p>&#35831;&#36755;&#20837;&#38656;&#35201;&#32763;&#35793;&#30340;&#25991;&#26412;&#12290;</p></div></div><div class="arrow"></div></div><div id="web-trs-panel"></div></div></div></template></div></div></html>