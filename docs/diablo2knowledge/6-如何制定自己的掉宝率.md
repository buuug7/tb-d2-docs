# 如何制定自己的掉宝率

所需要的文件:

- Treasureclassex.txt
- Superuniques.txt
- 相关物品 TXT 文件（由掉落物品的类型决定，如：武器就是 Weapon.txt 等等，指导用）及 Monstats.txt。

以 The Cow King 掉出可使用的“技能之书”和“属性药水”为例子。

1. 用 D2excel 等工具打开 Treasureclassex.txt，拷贝任意一行到文件的末尾，将其 Treasureclass 列改名为超级怪物的名称，如：The
   Cow King；这样，我们就拥有了一个新的掉宝率参数。
2. 打开 Superuniques.txt，找到 The Cow King（hcidx=39），修改其 TC 率（TC、TC(N)、TC(H)列）为我们刚才在 Treasureclassex.txt 中定义的名称（The
   Cow King）；这一步使得牛王能够采用 The Cow King 这个掉宝率参数，进而可以掉出我们需要的物品。
3. 回到第 1 步，继续修改我们新建的掉宝参数（The Cow King）。找到 picks 列，定义我们想要掉出物品的数量，这里用负数来表示，比如说：我想掉出两个物品，就填-2，同时还应确保 Unique、Set、Rare、Magic 和 NoDrop 列为空（这里我们想掉出技能之书和属性药水，它们不属于以上 4 种物品，如果想掉出以上 4 种物品，只要在对应列填入 1024 即可）。
4. 来进行关键一步，制定此掉宝参数要掉出的物品，在 item1 和 item2 中输入物品的 3 位代码（物品代码可参考“文件引导”栏目中的“暗黑破坏神内部代码全分析”，如果掉落的是 4 种类型的物品，就输入物品的名称），这里我们要输入“技能之书”的代码——SBK 和“属性药水”的代码——SP0（有关这两种物品的代码定义请参见“教程”栏目中“如何反复使用‘技能之书’和‘属性药水’”）；然后在相对应的 Prob1、Prob2 列中输入掉落这两种物品的数量（我填入的数值都为 1）；之后除最后一列不改动外，其余各列均清空。
5. 打开 Monstats.txt 文件，对比定义物品的 TXT 文件（这里就是 misc.txt）中物品级别的描述，确保物品的级别不高于掉落此物品怪物的级别，否则无法掉出；
6. 将所有文件放到暗黑破坏神安装目录\data\global\excel\目录下, 用“-direct -txt”参数启动游戏，杀死 TheCow King，就会掉出我们之前定义的物品了。

其他注意事项

- 每个怪物最多只能掉六样物品。
- ”picks“一列的数值是很讲究的，你会发现那里既有正数，也有负数，那么差别在哪里？如果你指定一个 tc 掉落多个不同物品，那么，”picks“一列应该填负值，如果填的是正值，那么会掉多个"item1",掉完"item1"，才会掉"item2"（如果"item1"不是一个具体的物品，而是一个 tc，那么掉该 tc 里面的几样物品）。如果"itemx"列里面是单一的物品，那么 probX 字段填入 1 会使掉出该物品或同类物品的几率为 100%，如果是其他值则不一定掉。
- tc 值可以嵌套，类似函数的嵌套。这样使掉出的物品更加多样性，但是也更加不确定，如果怪物的 tc 等级不够，掉不出指定的物品，那么掉出同类型的其他物品，比方说你让它掉暗金 charm,掉不出来的话就只好掉 magic
  charm 了
